<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>codegen_lab.promptlib API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../codegen_lab.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;codegen_lab</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#CURSOR_RULES_DIR">CURSOR_RULES_DIR</a>
            </li>
            <li>
                    <a class="variable" href="#mcp">mcp</a>
            </li>
            <li>
                    <a class="class" href="#CursorRuleMetadata">CursorRuleMetadata</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CursorRuleMetadata.priority">priority</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRuleMetadata.version">version</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRuleMetadata.tags">tags</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CursorRuleExample">CursorRuleExample</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CursorRuleExample.input">input</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRuleExample.output">output</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CursorRuleFilter">CursorRuleFilter</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CursorRuleFilter.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRuleFilter.pattern">pattern</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CursorRuleAction">CursorRuleAction</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CursorRuleAction.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRuleAction.message">message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CursorRule">CursorRule</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CursorRule.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRule.description">description</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRule.filters">filters</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRule.actions">actions</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRule.examples">examples</a>
                        </li>
                        <li>
                                <a class="variable" href="#CursorRule.metadata">metadata</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#get_cursor_rule_files">get_cursor_rule_files</a>
            </li>
            <li>
                    <a class="function" href="#get_cursor_rule_names">get_cursor_rule_names</a>
            </li>
            <li>
                    <a class="function" href="#read_cursor_rule">read_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#parse_cursor_rule">parse_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#generate_cursor_rule">generate_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#list_cursor_rules">list_cursor_rules</a>
            </li>
            <li>
                    <a class="function" href="#get_cursor_rule">get_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#get_cursor_rule_raw">get_cursor_rule_raw</a>
            </li>
            <li>
                    <a class="function" href="#instruct_repo_analysis">instruct_repo_analysis</a>
            </li>
            <li>
                    <a class="function" href="#instruct_custom_repo_rules_generation">instruct_custom_repo_rules_generation</a>
            </li>
            <li>
                    <a class="function" href="#get_static_cursor_rule">get_static_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#get_static_cursor_rules">get_static_cursor_rules</a>
            </li>
            <li>
                    <a class="function" href="#save_cursor_rule">save_cursor_rule</a>
            </li>
            <li>
                    <a class="function" href="#recommend_cursor_rules">recommend_cursor_rules</a>
            </li>
            <li>
                    <a class="function" href="#prep_workspace">prep_workspace</a>
            </li>
            <li>
                    <a class="function" href="#create_cursor_rule_files">create_cursor_rule_files</a>
            </li>
            <li>
                    <a class="function" href="#ensure_makefile_task">ensure_makefile_task</a>
            </li>
            <li>
                    <a class="function" href="#ensure_ai_report">ensure_ai_report</a>
            </li>
            <li>
                    <a class="function" href="#run_update_cursor_rules">run_update_cursor_rules</a>
            </li>
            <li>
                    <a class="function" href="#update_dockerignore">update_dockerignore</a>
            </li>
            <li>
                    <a class="function" href="#cursor_rules_workflow">cursor_rules_workflow</a>
            </li>
            <li>
                    <a class="function" href="#repo_analysis_prompt">repo_analysis_prompt</a>
            </li>
            <li>
                    <a class="function" href="#generate_cursor_rule_prompt">generate_cursor_rule_prompt</a>
            </li>
            <li>
                    <a class="function" href="#plan_and_execute_prompt_library_workflow">plan_and_execute_prompt_library_workflow</a>
            </li>
            <li>
                    <a class="function" href="#execute_phase_1">execute_phase_1</a>
            </li>
            <li>
                    <a class="function" href="#execute_phase_2">execute_phase_2</a>
            </li>
            <li>
                    <a class="function" href="#execute_phase_3">execute_phase_3</a>
            </li>
            <li>
                    <a class="function" href="#execute_phase_4">execute_phase_4</a>
            </li>
            <li>
                    <a class="function" href="#execute_phase_5">execute_phase_5</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../codegen_lab.html">codegen_lab</a><wbr>.promptlib    </h1>

                        <div class="docstring"><p>Prompt Library Module for Cursor Rules</p>

<p>This module provides functionality for managing cursor rules, including:</p>

<ul>
<li>Data models for cursor rule components</li>
<li>Utility functions for working with cursor rules</li>
<li>MCP resources for exposing cursor rules</li>
<li>MCP tools for cursor rule operations</li>
<li>MCP prompts for cursor rule generation</li>
<li>Workflow functions for executing cursor rule tasks</li>
</ul>

<p>This is a re-export module that maintains backward compatibility with the original
prompt_library.py module while providing a more modular structure.</p>
</div>

                        <input id="mod-promptlib-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-promptlib-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;Prompt Library Module for Cursor Rules</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">This module provides functionality for managing cursor rules, including:</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">- Data models for cursor rule components</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">- Utility functions for working with cursor rules</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">- MCP resources for exposing cursor rules</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">- MCP tools for cursor rule operations</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">- MCP prompts for cursor rule generation</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">- Workflow functions for executing cursor rule tasks</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">This is a re-export module that maintains backward compatibility with the original</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">prompt_library.py module while providing a more modular structure.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="c1"># Import constants directly from the original module</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="c1"># Re-export everything from the original module for backward compatibility</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="c1"># These imports will be gradually replaced with imports from the new modules</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="c1"># as the refactoring progresses.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">codegen_lab.prompt_library</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="n">CURSOR_RULES_DIR</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="c1"># Data models</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="n">CursorRule</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="n">CursorRuleAction</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="n">CursorRuleExample</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="n">CursorRuleFilter</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">CursorRuleMetadata</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">create_cursor_rule_files</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">cursor_rules_workflow</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">ensure_ai_report</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">ensure_makefile_task</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="n">execute_phase_1</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="n">execute_phase_2</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="n">execute_phase_3</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="n">execute_phase_4</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">execute_phase_5</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">generate_cursor_rule</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="n">generate_cursor_rule_prompt</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="c1"># Utility functions</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">get_cursor_rule_files</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="n">get_cursor_rule_names</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">get_static_cursor_rule</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="n">get_static_cursor_rules</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">instruct_custom_repo_rules_generation</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="c1"># Tool functions</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">mcp</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">parse_cursor_rule</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="c1"># Workflow functions</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">plan_and_execute_prompt_library_workflow</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="n">prep_workspace</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="n">read_cursor_rule</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>    <span class="c1"># Prompt functions</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="n">repo_analysis_prompt</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="n">run_update_cursor_rules</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">save_cursor_rule</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">update_dockerignore</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="c1"># Import from refactored modules</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="c1"># Phase 3: Resources</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">codegen_lab.promptlib.resources</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="n">get_cursor_rule</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">get_cursor_rule_raw</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="n">list_cursor_rules</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="c1"># Phase 3: Tools - Analysis</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">codegen_lab.promptlib.tools</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">instruct_repo_analysis</span><span class="p">,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="n">recommend_cursor_rules</span><span class="p">,</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="c1"># Define what should be exported when using &#39;from prompt_library import *&#39;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="c1"># Constants</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="s2">&quot;CURSOR_RULES_DIR&quot;</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="s2">&quot;mcp&quot;</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="c1"># Data models</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="s2">&quot;CursorRuleMetadata&quot;</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="s2">&quot;CursorRuleExample&quot;</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="s2">&quot;CursorRuleFilter&quot;</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="s2">&quot;CursorRuleAction&quot;</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="s2">&quot;CursorRule&quot;</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="c1"># Utility functions</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="s2">&quot;get_cursor_rule_files&quot;</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="s2">&quot;get_cursor_rule_names&quot;</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="s2">&quot;read_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="s2">&quot;parse_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="s2">&quot;generate_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="c1"># Resource endpoints</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="s2">&quot;list_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="s2">&quot;get_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="s2">&quot;get_cursor_rule_raw&quot;</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="c1"># Tool functions</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="s2">&quot;instruct_repo_analysis&quot;</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="s2">&quot;instruct_custom_repo_rules_generation&quot;</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="s2">&quot;get_static_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="s2">&quot;get_static_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="s2">&quot;save_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="s2">&quot;recommend_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="s2">&quot;prep_workspace&quot;</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="s2">&quot;create_cursor_rule_files&quot;</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    <span class="s2">&quot;ensure_makefile_task&quot;</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="s2">&quot;ensure_ai_report&quot;</span><span class="p">,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="s2">&quot;run_update_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="s2">&quot;update_dockerignore&quot;</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="s2">&quot;cursor_rules_workflow&quot;</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="c1"># Prompt functions</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="s2">&quot;repo_analysis_prompt&quot;</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="s2">&quot;generate_cursor_rule_prompt&quot;</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="c1"># Workflow functions</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="s2">&quot;plan_and_execute_prompt_library_workflow&quot;</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="s2">&quot;execute_phase_1&quot;</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="s2">&quot;execute_phase_2&quot;</span><span class="p">,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="s2">&quot;execute_phase_3&quot;</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="s2">&quot;execute_phase_4&quot;</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="s2">&quot;execute_phase_5&quot;</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="CURSOR_RULES_DIR">
                    <div class="attr variable">
            <span class="name">CURSOR_RULES_DIR</span>        =
<span class="default_value">PosixPath(&#39;/home/runner/work/codegen-lab/codegen-lab/hack/drafts/cursor_rules&#39;)</span>

        
    </div>
    <a class="headerlink" href="#CURSOR_RULES_DIR"></a>
    
    

                </section>
                <section id="mcp">
                    <div class="attr variable">
            <span class="name">mcp</span>        =
<span class="default_value">&lt;mcp.server.fastmcp.server.FastMCP object&gt;</span>

        
    </div>
    <a class="headerlink" href="#mcp"></a>
    
    

                </section>
                <section id="CursorRuleMetadata">
                            <input id="CursorRuleMetadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CursorRuleMetadata</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="CursorRuleMetadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CursorRuleMetadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CursorRuleMetadata-65"><a href="#CursorRuleMetadata-65"><span class="linenos">65</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CursorRuleMetadata</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="CursorRuleMetadata-66"><a href="#CursorRuleMetadata-66"><span class="linenos">66</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Metadata for a cursor rule.</span>
</span><span id="CursorRuleMetadata-67"><a href="#CursorRuleMetadata-67"><span class="linenos">67</span></a>
</span><span id="CursorRuleMetadata-68"><a href="#CursorRuleMetadata-68"><span class="linenos">68</span></a><span class="sd">    Attributes:</span>
</span><span id="CursorRuleMetadata-69"><a href="#CursorRuleMetadata-69"><span class="linenos">69</span></a><span class="sd">        priority: The priority of the rule (high, medium, low)</span>
</span><span id="CursorRuleMetadata-70"><a href="#CursorRuleMetadata-70"><span class="linenos">70</span></a><span class="sd">        version: The version of the rule</span>
</span><span id="CursorRuleMetadata-71"><a href="#CursorRuleMetadata-71"><span class="linenos">71</span></a><span class="sd">        tags: List of tags associated with the rule</span>
</span><span id="CursorRuleMetadata-72"><a href="#CursorRuleMetadata-72"><span class="linenos">72</span></a>
</span><span id="CursorRuleMetadata-73"><a href="#CursorRuleMetadata-73"><span class="linenos">73</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CursorRuleMetadata-74"><a href="#CursorRuleMetadata-74"><span class="linenos">74</span></a>
</span><span id="CursorRuleMetadata-75"><a href="#CursorRuleMetadata-75"><span class="linenos">75</span></a>    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRuleMetadata-76"><a href="#CursorRuleMetadata-76"><span class="linenos">76</span></a>    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRuleMetadata-77"><a href="#CursorRuleMetadata-77"><span class="linenos">77</span></a>    <span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Metadata for a cursor rule.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>priority:</strong>  The priority of the rule (high, medium, low)</li>
<li><strong>version:</strong>  The version of the rule</li>
<li><strong>tags:</strong>  List of tags associated with the rule</li>
</ul>
</div>


                            <div id="CursorRuleMetadata.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleMetadata.priority"></a>
    
    

                            </div>
                            <div id="CursorRuleMetadata.version" class="classattr">
                                <div class="attr variable">
            <span class="name">version</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleMetadata.version"></a>
    
    

                            </div>
                            <div id="CursorRuleMetadata.tags" class="classattr">
                                <div class="attr variable">
            <span class="name">tags</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleMetadata.tags"></a>
    
    

                            </div>
                </section>
                <section id="CursorRuleExample">
                            <input id="CursorRuleExample-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CursorRuleExample</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="CursorRuleExample-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CursorRuleExample"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CursorRuleExample-80"><a href="#CursorRuleExample-80"><span class="linenos">80</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CursorRuleExample</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="CursorRuleExample-81"><a href="#CursorRuleExample-81"><span class="linenos">81</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Example for a cursor rule.</span>
</span><span id="CursorRuleExample-82"><a href="#CursorRuleExample-82"><span class="linenos">82</span></a>
</span><span id="CursorRuleExample-83"><a href="#CursorRuleExample-83"><span class="linenos">83</span></a><span class="sd">    Attributes:</span>
</span><span id="CursorRuleExample-84"><a href="#CursorRuleExample-84"><span class="linenos">84</span></a><span class="sd">        input: The input example</span>
</span><span id="CursorRuleExample-85"><a href="#CursorRuleExample-85"><span class="linenos">85</span></a><span class="sd">        output: The expected output</span>
</span><span id="CursorRuleExample-86"><a href="#CursorRuleExample-86"><span class="linenos">86</span></a>
</span><span id="CursorRuleExample-87"><a href="#CursorRuleExample-87"><span class="linenos">87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CursorRuleExample-88"><a href="#CursorRuleExample-88"><span class="linenos">88</span></a>
</span><span id="CursorRuleExample-89"><a href="#CursorRuleExample-89"><span class="linenos">89</span></a>    <span class="nb">input</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRuleExample-90"><a href="#CursorRuleExample-90"><span class="linenos">90</span></a>    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span>
</span></pre></div>


            <div class="docstring"><p>Example for a cursor rule.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>input:</strong>  The input example</li>
<li><strong>output:</strong>  The expected output</li>
</ul>
</div>


                            <div id="CursorRuleExample.input" class="classattr">
                                <div class="attr variable">
            <span class="name">input</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleExample.input"></a>
    
    

                            </div>
                            <div id="CursorRuleExample.output" class="classattr">
                                <div class="attr variable">
            <span class="name">output</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleExample.output"></a>
    
    

                            </div>
                </section>
                <section id="CursorRuleFilter">
                            <input id="CursorRuleFilter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CursorRuleFilter</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="CursorRuleFilter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CursorRuleFilter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CursorRuleFilter-93"><a href="#CursorRuleFilter-93"><span class="linenos"> 93</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CursorRuleFilter</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="CursorRuleFilter-94"><a href="#CursorRuleFilter-94"><span class="linenos"> 94</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter for a cursor rule.</span>
</span><span id="CursorRuleFilter-95"><a href="#CursorRuleFilter-95"><span class="linenos"> 95</span></a>
</span><span id="CursorRuleFilter-96"><a href="#CursorRuleFilter-96"><span class="linenos"> 96</span></a><span class="sd">    Attributes:</span>
</span><span id="CursorRuleFilter-97"><a href="#CursorRuleFilter-97"><span class="linenos"> 97</span></a><span class="sd">        type: The type of filter (file_extension, content, etc.)</span>
</span><span id="CursorRuleFilter-98"><a href="#CursorRuleFilter-98"><span class="linenos"> 98</span></a><span class="sd">        pattern: The pattern to match</span>
</span><span id="CursorRuleFilter-99"><a href="#CursorRuleFilter-99"><span class="linenos"> 99</span></a>
</span><span id="CursorRuleFilter-100"><a href="#CursorRuleFilter-100"><span class="linenos">100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CursorRuleFilter-101"><a href="#CursorRuleFilter-101"><span class="linenos">101</span></a>
</span><span id="CursorRuleFilter-102"><a href="#CursorRuleFilter-102"><span class="linenos">102</span></a>    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRuleFilter-103"><a href="#CursorRuleFilter-103"><span class="linenos">103</span></a>    <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span>
</span></pre></div>


            <div class="docstring"><p>Filter for a cursor rule.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>type:</strong>  The type of filter (file_extension, content, etc.)</li>
<li><strong>pattern:</strong>  The pattern to match</li>
</ul>
</div>


                            <div id="CursorRuleFilter.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleFilter.type"></a>
    
    

                            </div>
                            <div id="CursorRuleFilter.pattern" class="classattr">
                                <div class="attr variable">
            <span class="name">pattern</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleFilter.pattern"></a>
    
    

                            </div>
                </section>
                <section id="CursorRuleAction">
                            <input id="CursorRuleAction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CursorRuleAction</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="CursorRuleAction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CursorRuleAction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CursorRuleAction-106"><a href="#CursorRuleAction-106"><span class="linenos">106</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CursorRuleAction</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="CursorRuleAction-107"><a href="#CursorRuleAction-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Action for a cursor rule.</span>
</span><span id="CursorRuleAction-108"><a href="#CursorRuleAction-108"><span class="linenos">108</span></a>
</span><span id="CursorRuleAction-109"><a href="#CursorRuleAction-109"><span class="linenos">109</span></a><span class="sd">    Attributes:</span>
</span><span id="CursorRuleAction-110"><a href="#CursorRuleAction-110"><span class="linenos">110</span></a><span class="sd">        type: The type of action (suggest, etc.)</span>
</span><span id="CursorRuleAction-111"><a href="#CursorRuleAction-111"><span class="linenos">111</span></a><span class="sd">        message: The message to display</span>
</span><span id="CursorRuleAction-112"><a href="#CursorRuleAction-112"><span class="linenos">112</span></a>
</span><span id="CursorRuleAction-113"><a href="#CursorRuleAction-113"><span class="linenos">113</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CursorRuleAction-114"><a href="#CursorRuleAction-114"><span class="linenos">114</span></a>
</span><span id="CursorRuleAction-115"><a href="#CursorRuleAction-115"><span class="linenos">115</span></a>    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRuleAction-116"><a href="#CursorRuleAction-116"><span class="linenos">116</span></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
</span></pre></div>


            <div class="docstring"><p>Action for a cursor rule.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>type:</strong>  The type of action (suggest, etc.)</li>
<li><strong>message:</strong>  The message to display</li>
</ul>
</div>


                            <div id="CursorRuleAction.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleAction.type"></a>
    
    

                            </div>
                            <div id="CursorRuleAction.message" class="classattr">
                                <div class="attr variable">
            <span class="name">message</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRuleAction.message"></a>
    
    

                            </div>
                </section>
                <section id="CursorRule">
                            <input id="CursorRule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CursorRule</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="CursorRule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CursorRule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CursorRule-119"><a href="#CursorRule-119"><span class="linenos">119</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CursorRule</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="CursorRule-120"><a href="#CursorRule-120"><span class="linenos">120</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete cursor rule structure.</span>
</span><span id="CursorRule-121"><a href="#CursorRule-121"><span class="linenos">121</span></a>
</span><span id="CursorRule-122"><a href="#CursorRule-122"><span class="linenos">122</span></a><span class="sd">    Attributes:</span>
</span><span id="CursorRule-123"><a href="#CursorRule-123"><span class="linenos">123</span></a><span class="sd">        name: The name of the rule</span>
</span><span id="CursorRule-124"><a href="#CursorRule-124"><span class="linenos">124</span></a><span class="sd">        description: The description of the rule</span>
</span><span id="CursorRule-125"><a href="#CursorRule-125"><span class="linenos">125</span></a><span class="sd">        filters: List of filters for the rule</span>
</span><span id="CursorRule-126"><a href="#CursorRule-126"><span class="linenos">126</span></a><span class="sd">        actions: List of actions for the rule</span>
</span><span id="CursorRule-127"><a href="#CursorRule-127"><span class="linenos">127</span></a><span class="sd">        examples: List of examples for the rule</span>
</span><span id="CursorRule-128"><a href="#CursorRule-128"><span class="linenos">128</span></a><span class="sd">        metadata: Metadata for the rule</span>
</span><span id="CursorRule-129"><a href="#CursorRule-129"><span class="linenos">129</span></a>
</span><span id="CursorRule-130"><a href="#CursorRule-130"><span class="linenos">130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CursorRule-131"><a href="#CursorRule-131"><span class="linenos">131</span></a>
</span><span id="CursorRule-132"><a href="#CursorRule-132"><span class="linenos">132</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRule-133"><a href="#CursorRule-133"><span class="linenos">133</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="CursorRule-134"><a href="#CursorRule-134"><span class="linenos">134</span></a>    <span class="n">filters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CursorRuleFilter</span><span class="p">]</span>
</span><span id="CursorRule-135"><a href="#CursorRule-135"><span class="linenos">135</span></a>    <span class="n">actions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CursorRuleAction</span><span class="p">]</span>
</span><span id="CursorRule-136"><a href="#CursorRule-136"><span class="linenos">136</span></a>    <span class="n">examples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CursorRuleExample</span><span class="p">]</span>
</span><span id="CursorRule-137"><a href="#CursorRule-137"><span class="linenos">137</span></a>    <span class="n">metadata</span><span class="p">:</span> <span class="n">CursorRuleMetadata</span>
</span></pre></div>


            <div class="docstring"><p>Complete cursor rule structure.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>name:</strong>  The name of the rule</li>
<li><strong>description:</strong>  The description of the rule</li>
<li><strong>filters:</strong>  List of filters for the rule</li>
<li><strong>actions:</strong>  List of actions for the rule</li>
<li><strong>examples:</strong>  List of examples for the rule</li>
<li><strong>metadata:</strong>  Metadata for the rule</li>
</ul>
</div>


                            <div id="CursorRule.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRule.name"></a>
    
    

                            </div>
                            <div id="CursorRule.description" class="classattr">
                                <div class="attr variable">
            <span class="name">description</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CursorRule.description"></a>
    
    

                            </div>
                            <div id="CursorRule.filters" class="classattr">
                                <div class="attr variable">
            <span class="name">filters</span><span class="annotation">: list[<a href="#CursorRuleFilter">CursorRuleFilter</a>]</span>

        
    </div>
    <a class="headerlink" href="#CursorRule.filters"></a>
    
    

                            </div>
                            <div id="CursorRule.actions" class="classattr">
                                <div class="attr variable">
            <span class="name">actions</span><span class="annotation">: list[<a href="#CursorRuleAction">CursorRuleAction</a>]</span>

        
    </div>
    <a class="headerlink" href="#CursorRule.actions"></a>
    
    

                            </div>
                            <div id="CursorRule.examples" class="classattr">
                                <div class="attr variable">
            <span class="name">examples</span><span class="annotation">: list[<a href="#CursorRuleExample">CursorRuleExample</a>]</span>

        
    </div>
    <a class="headerlink" href="#CursorRule.examples"></a>
    
    

                            </div>
                            <div id="CursorRule.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span><span class="annotation">: <a href="#CursorRuleMetadata">CursorRuleMetadata</a></span>

        
    </div>
    <a class="headerlink" href="#CursorRule.metadata"></a>
    
    

                            </div>
                </section>
                <section id="get_cursor_rule_files">
                            <input id="get_cursor_rule_files-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_cursor_rule_files</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_cursor_rule_files-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_cursor_rule_files"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_cursor_rule_files-147"><a href="#get_cursor_rule_files-147"><span class="linenos">147</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cursor_rule_files</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
</span><span id="get_cursor_rule_files-148"><a href="#get_cursor_rule_files-148"><span class="linenos">148</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all cursor rule files from the cursor rules directory.</span>
</span><span id="get_cursor_rule_files-149"><a href="#get_cursor_rule_files-149"><span class="linenos">149</span></a>
</span><span id="get_cursor_rule_files-150"><a href="#get_cursor_rule_files-150"><span class="linenos">150</span></a><span class="sd">    Returns:</span>
</span><span id="get_cursor_rule_files-151"><a href="#get_cursor_rule_files-151"><span class="linenos">151</span></a><span class="sd">        List[Path]: List of paths to cursor rule files</span>
</span><span id="get_cursor_rule_files-152"><a href="#get_cursor_rule_files-152"><span class="linenos">152</span></a>
</span><span id="get_cursor_rule_files-153"><a href="#get_cursor_rule_files-153"><span class="linenos">153</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_cursor_rule_files-154"><a href="#get_cursor_rule_files-154"><span class="linenos">154</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">CURSOR_RULES_DIR</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.mdc.md&quot;</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get all cursor rule files from the cursor rules directory.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List[Path]: List of paths to cursor rule files</p>
</blockquote>
</div>


                </section>
                <section id="get_cursor_rule_names">
                            <input id="get_cursor_rule_names-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_cursor_rule_names</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_cursor_rule_names-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_cursor_rule_names"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_cursor_rule_names-157"><a href="#get_cursor_rule_names-157"><span class="linenos">157</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cursor_rule_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_cursor_rule_names-158"><a href="#get_cursor_rule_names-158"><span class="linenos">158</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all cursor rule names from the cursor rules directory.</span>
</span><span id="get_cursor_rule_names-159"><a href="#get_cursor_rule_names-159"><span class="linenos">159</span></a>
</span><span id="get_cursor_rule_names-160"><a href="#get_cursor_rule_names-160"><span class="linenos">160</span></a><span class="sd">    Returns:</span>
</span><span id="get_cursor_rule_names-161"><a href="#get_cursor_rule_names-161"><span class="linenos">161</span></a><span class="sd">        List[str]: List of cursor rule names (without extension)</span>
</span><span id="get_cursor_rule_names-162"><a href="#get_cursor_rule_names-162"><span class="linenos">162</span></a>
</span><span id="get_cursor_rule_names-163"><a href="#get_cursor_rule_names-163"><span class="linenos">163</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_cursor_rule_names-164"><a href="#get_cursor_rule_names-164"><span class="linenos">164</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.mdc&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">get_cursor_rule_files</span><span class="p">()]</span>
</span></pre></div>


            <div class="docstring"><p>Get all cursor rule names from the cursor rules directory.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List[str]: List of cursor rule names (without extension)</p>
</blockquote>
</div>


                </section>
                <section id="read_cursor_rule">
                            <input id="read_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_cursor_rule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="read_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_cursor_rule-167"><a href="#read_cursor_rule-167"><span class="linenos">167</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_cursor_rule</span><span class="p">(</span><span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="read_cursor_rule-168"><a href="#read_cursor_rule-168"><span class="linenos">168</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a cursor rule file by name.</span>
</span><span id="read_cursor_rule-169"><a href="#read_cursor_rule-169"><span class="linenos">169</span></a>
</span><span id="read_cursor_rule-170"><a href="#read_cursor_rule-170"><span class="linenos">170</span></a><span class="sd">    Args:</span>
</span><span id="read_cursor_rule-171"><a href="#read_cursor_rule-171"><span class="linenos">171</span></a><span class="sd">        rule_name: The name of the cursor rule (without extension)</span>
</span><span id="read_cursor_rule-172"><a href="#read_cursor_rule-172"><span class="linenos">172</span></a>
</span><span id="read_cursor_rule-173"><a href="#read_cursor_rule-173"><span class="linenos">173</span></a><span class="sd">    Returns:</span>
</span><span id="read_cursor_rule-174"><a href="#read_cursor_rule-174"><span class="linenos">174</span></a><span class="sd">        Optional[str]: The content of the cursor rule file, or None if not found</span>
</span><span id="read_cursor_rule-175"><a href="#read_cursor_rule-175"><span class="linenos">175</span></a>
</span><span id="read_cursor_rule-176"><a href="#read_cursor_rule-176"><span class="linenos">176</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="read_cursor_rule-177"><a href="#read_cursor_rule-177"><span class="linenos">177</span></a>    <span class="n">rule_path</span> <span class="o">=</span> <span class="n">CURSOR_RULES_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md&quot;</span>
</span><span id="read_cursor_rule-178"><a href="#read_cursor_rule-178"><span class="linenos">178</span></a>    <span class="k">if</span> <span class="n">rule_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="read_cursor_rule-179"><a href="#read_cursor_rule-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="n">rule_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
</span><span id="read_cursor_rule-180"><a href="#read_cursor_rule-180"><span class="linenos">180</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Read a cursor rule file by name.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_name:</strong>  The name of the cursor rule (without extension)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Optional[str]: The content of the cursor rule file, or None if not found</p>
</blockquote>
</div>


                </section>
                <section id="parse_cursor_rule">
                            <input id="parse_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_cursor_rule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">content</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="parse_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_cursor_rule-183"><a href="#parse_cursor_rule-183"><span class="linenos">183</span></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_cursor_rule</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="parse_cursor_rule-184"><a href="#parse_cursor_rule-184"><span class="linenos">184</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse cursor rule content into a structured format.</span>
</span><span id="parse_cursor_rule-185"><a href="#parse_cursor_rule-185"><span class="linenos">185</span></a>
</span><span id="parse_cursor_rule-186"><a href="#parse_cursor_rule-186"><span class="linenos">186</span></a><span class="sd">    Args:</span>
</span><span id="parse_cursor_rule-187"><a href="#parse_cursor_rule-187"><span class="linenos">187</span></a><span class="sd">        content: The content of the cursor rule file</span>
</span><span id="parse_cursor_rule-188"><a href="#parse_cursor_rule-188"><span class="linenos">188</span></a>
</span><span id="parse_cursor_rule-189"><a href="#parse_cursor_rule-189"><span class="linenos">189</span></a><span class="sd">    Returns:</span>
</span><span id="parse_cursor_rule-190"><a href="#parse_cursor_rule-190"><span class="linenos">190</span></a><span class="sd">        Dict[str, Any]: Structured representation of the cursor rule</span>
</span><span id="parse_cursor_rule-191"><a href="#parse_cursor_rule-191"><span class="linenos">191</span></a>
</span><span id="parse_cursor_rule-192"><a href="#parse_cursor_rule-192"><span class="linenos">192</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse_cursor_rule-193"><a href="#parse_cursor_rule-193"><span class="linenos">193</span></a>    <span class="c1"># Extract frontmatter</span>
</span><span id="parse_cursor_rule-194"><a href="#parse_cursor_rule-194"><span class="linenos">194</span></a>    <span class="n">frontmatter</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_cursor_rule-195"><a href="#parse_cursor_rule-195"><span class="linenos">195</span></a>    <span class="n">frontmatter_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^---\n(.*?)\n---&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-196"><a href="#parse_cursor_rule-196"><span class="linenos">196</span></a>    <span class="k">if</span> <span class="n">frontmatter_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-197"><a href="#parse_cursor_rule-197"><span class="linenos">197</span></a>        <span class="n">frontmatter_text</span> <span class="o">=</span> <span class="n">frontmatter_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="parse_cursor_rule-198"><a href="#parse_cursor_rule-198"><span class="linenos">198</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">frontmatter_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
</span><span id="parse_cursor_rule-199"><a href="#parse_cursor_rule-199"><span class="linenos">199</span></a>            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="parse_cursor_rule-200"><a href="#parse_cursor_rule-200"><span class="linenos">200</span></a>                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="parse_cursor_rule-201"><a href="#parse_cursor_rule-201"><span class="linenos">201</span></a>                <span class="n">frontmatter</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-202"><a href="#parse_cursor_rule-202"><span class="linenos">202</span></a>
</span><span id="parse_cursor_rule-203"><a href="#parse_cursor_rule-203"><span class="linenos">203</span></a>    <span class="c1"># Extract title and description</span>
</span><span id="parse_cursor_rule-204"><a href="#parse_cursor_rule-204"><span class="linenos">204</span></a>    <span class="n">title_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;# (.*?)\n&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
</span><span id="parse_cursor_rule-205"><a href="#parse_cursor_rule-205"><span class="linenos">205</span></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">title_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">title_match</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="parse_cursor_rule-206"><a href="#parse_cursor_rule-206"><span class="linenos">206</span></a>
</span><span id="parse_cursor_rule-207"><a href="#parse_cursor_rule-207"><span class="linenos">207</span></a>    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="parse_cursor_rule-208"><a href="#parse_cursor_rule-208"><span class="linenos">208</span></a>    <span class="n">description_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;# .*?\n\n(.*?)\n\n&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-209"><a href="#parse_cursor_rule-209"><span class="linenos">209</span></a>    <span class="k">if</span> <span class="n">description_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-210"><a href="#parse_cursor_rule-210"><span class="linenos">210</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="n">description_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-211"><a href="#parse_cursor_rule-211"><span class="linenos">211</span></a>
</span><span id="parse_cursor_rule-212"><a href="#parse_cursor_rule-212"><span class="linenos">212</span></a>    <span class="c1"># Extract rule content</span>
</span><span id="parse_cursor_rule-213"><a href="#parse_cursor_rule-213"><span class="linenos">213</span></a>    <span class="n">rule_content</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_cursor_rule-214"><a href="#parse_cursor_rule-214"><span class="linenos">214</span></a>    <span class="n">rule_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;rule&gt;(.*?)&lt;/rule&gt;&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-215"><a href="#parse_cursor_rule-215"><span class="linenos">215</span></a>    <span class="k">if</span> <span class="n">rule_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-216"><a href="#parse_cursor_rule-216"><span class="linenos">216</span></a>        <span class="n">rule_text</span> <span class="o">=</span> <span class="n">rule_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="parse_cursor_rule-217"><a href="#parse_cursor_rule-217"><span class="linenos">217</span></a>
</span><span id="parse_cursor_rule-218"><a href="#parse_cursor_rule-218"><span class="linenos">218</span></a>        <span class="c1"># Extract name</span>
</span><span id="parse_cursor_rule-219"><a href="#parse_cursor_rule-219"><span class="linenos">219</span></a>        <span class="n">name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;name: (.*?)$&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span><span id="parse_cursor_rule-220"><a href="#parse_cursor_rule-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">name_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-221"><a href="#parse_cursor_rule-221"><span class="linenos">221</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-222"><a href="#parse_cursor_rule-222"><span class="linenos">222</span></a>
</span><span id="parse_cursor_rule-223"><a href="#parse_cursor_rule-223"><span class="linenos">223</span></a>        <span class="c1"># Extract description</span>
</span><span id="parse_cursor_rule-224"><a href="#parse_cursor_rule-224"><span class="linenos">224</span></a>        <span class="n">desc_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;description: (.*?)$&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span><span id="parse_cursor_rule-225"><a href="#parse_cursor_rule-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="n">desc_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-226"><a href="#parse_cursor_rule-226"><span class="linenos">226</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-227"><a href="#parse_cursor_rule-227"><span class="linenos">227</span></a>
</span><span id="parse_cursor_rule-228"><a href="#parse_cursor_rule-228"><span class="linenos">228</span></a>        <span class="c1"># Extract filters section</span>
</span><span id="parse_cursor_rule-229"><a href="#parse_cursor_rule-229"><span class="linenos">229</span></a>        <span class="n">filters_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;filters:(.*?)(?:actions:|examples:|metadata:)&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-230"><a href="#parse_cursor_rule-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">filters_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-231"><a href="#parse_cursor_rule-231"><span class="linenos">231</span></a>            <span class="n">filters_text</span> <span class="o">=</span> <span class="n">filters_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-232"><a href="#parse_cursor_rule-232"><span class="linenos">232</span></a>            <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_cursor_rule-233"><a href="#parse_cursor_rule-233"><span class="linenos">233</span></a>            <span class="k">for</span> <span class="n">filter_match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;- type: (.*?)\n\s+pattern: </span><span class="se">\&quot;</span><span class="s2">(.*?)</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filters_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">):</span>
</span><span id="parse_cursor_rule-234"><a href="#parse_cursor_rule-234"><span class="linenos">234</span></a>                <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">filter_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">filter_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()})</span>
</span><span id="parse_cursor_rule-235"><a href="#parse_cursor_rule-235"><span class="linenos">235</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;filters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span>
</span><span id="parse_cursor_rule-236"><a href="#parse_cursor_rule-236"><span class="linenos">236</span></a>
</span><span id="parse_cursor_rule-237"><a href="#parse_cursor_rule-237"><span class="linenos">237</span></a>        <span class="c1"># Extract actions section</span>
</span><span id="parse_cursor_rule-238"><a href="#parse_cursor_rule-238"><span class="linenos">238</span></a>        <span class="n">actions_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;actions:(.*?)(?:examples:|metadata:|$)&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-239"><a href="#parse_cursor_rule-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="n">actions_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-240"><a href="#parse_cursor_rule-240"><span class="linenos">240</span></a>            <span class="n">actions_text</span> <span class="o">=</span> <span class="n">actions_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-241"><a href="#parse_cursor_rule-241"><span class="linenos">241</span></a>            <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_cursor_rule-242"><a href="#parse_cursor_rule-242"><span class="linenos">242</span></a>            <span class="k">for</span> <span class="n">action_match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span>
</span><span id="parse_cursor_rule-243"><a href="#parse_cursor_rule-243"><span class="linenos">243</span></a>                <span class="sa">r</span><span class="s2">&quot;- type: (.*?)\n\s+message: \|(.*?)(?:\n\s+-|\n\nexamples|\n\nmetadata|$)&quot;</span><span class="p">,</span> <span class="n">actions_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span>
</span><span id="parse_cursor_rule-244"><a href="#parse_cursor_rule-244"><span class="linenos">244</span></a>            <span class="p">):</span>
</span><span id="parse_cursor_rule-245"><a href="#parse_cursor_rule-245"><span class="linenos">245</span></a>                <span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">action_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">action_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()})</span>
</span><span id="parse_cursor_rule-246"><a href="#parse_cursor_rule-246"><span class="linenos">246</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">actions</span>
</span><span id="parse_cursor_rule-247"><a href="#parse_cursor_rule-247"><span class="linenos">247</span></a>
</span><span id="parse_cursor_rule-248"><a href="#parse_cursor_rule-248"><span class="linenos">248</span></a>        <span class="c1"># Extract examples section</span>
</span><span id="parse_cursor_rule-249"><a href="#parse_cursor_rule-249"><span class="linenos">249</span></a>        <span class="n">examples_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;examples:(.*?)(?:metadata:|$)&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-250"><a href="#parse_cursor_rule-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="n">examples_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-251"><a href="#parse_cursor_rule-251"><span class="linenos">251</span></a>            <span class="n">examples_text</span> <span class="o">=</span> <span class="n">examples_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-252"><a href="#parse_cursor_rule-252"><span class="linenos">252</span></a>            <span class="n">examples</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_cursor_rule-253"><a href="#parse_cursor_rule-253"><span class="linenos">253</span></a>            <span class="k">for</span> <span class="n">example_match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;- input: \|(.*?)\n\s+output: </span><span class="se">\&quot;</span><span class="s2">(.*?)</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">examples_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">):</span>
</span><span id="parse_cursor_rule-254"><a href="#parse_cursor_rule-254"><span class="linenos">254</span></a>                <span class="n">examples</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">example_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">example_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()})</span>
</span><span id="parse_cursor_rule-255"><a href="#parse_cursor_rule-255"><span class="linenos">255</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;examples&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">examples</span>
</span><span id="parse_cursor_rule-256"><a href="#parse_cursor_rule-256"><span class="linenos">256</span></a>
</span><span id="parse_cursor_rule-257"><a href="#parse_cursor_rule-257"><span class="linenos">257</span></a>        <span class="c1"># Extract metadata section</span>
</span><span id="parse_cursor_rule-258"><a href="#parse_cursor_rule-258"><span class="linenos">258</span></a>        <span class="n">metadata_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;metadata:(.*?)(?:$)&quot;</span><span class="p">,</span> <span class="n">rule_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-259"><a href="#parse_cursor_rule-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="n">metadata_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-260"><a href="#parse_cursor_rule-260"><span class="linenos">260</span></a>            <span class="n">metadata_text</span> <span class="o">=</span> <span class="n">metadata_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-261"><a href="#parse_cursor_rule-261"><span class="linenos">261</span></a>            <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_cursor_rule-262"><a href="#parse_cursor_rule-262"><span class="linenos">262</span></a>
</span><span id="parse_cursor_rule-263"><a href="#parse_cursor_rule-263"><span class="linenos">263</span></a>            <span class="n">priority_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;priority: (.*?)$&quot;</span><span class="p">,</span> <span class="n">metadata_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span><span id="parse_cursor_rule-264"><a href="#parse_cursor_rule-264"><span class="linenos">264</span></a>            <span class="k">if</span> <span class="n">priority_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-265"><a href="#parse_cursor_rule-265"><span class="linenos">265</span></a>                <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">priority_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-266"><a href="#parse_cursor_rule-266"><span class="linenos">266</span></a>
</span><span id="parse_cursor_rule-267"><a href="#parse_cursor_rule-267"><span class="linenos">267</span></a>            <span class="n">version_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;version: (.*?)$&quot;</span><span class="p">,</span> <span class="n">metadata_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span><span id="parse_cursor_rule-268"><a href="#parse_cursor_rule-268"><span class="linenos">268</span></a>            <span class="k">if</span> <span class="n">version_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-269"><a href="#parse_cursor_rule-269"><span class="linenos">269</span></a>                <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-270"><a href="#parse_cursor_rule-270"><span class="linenos">270</span></a>
</span><span id="parse_cursor_rule-271"><a href="#parse_cursor_rule-271"><span class="linenos">271</span></a>            <span class="n">tags_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;tags:(.*?)(?:\n\s+[a-z]+:|\n\n|$)&quot;</span><span class="p">,</span> <span class="n">metadata_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="parse_cursor_rule-272"><a href="#parse_cursor_rule-272"><span class="linenos">272</span></a>            <span class="k">if</span> <span class="n">tags_match</span><span class="p">:</span>
</span><span id="parse_cursor_rule-273"><a href="#parse_cursor_rule-273"><span class="linenos">273</span></a>                <span class="n">tags_text</span> <span class="o">=</span> <span class="n">tags_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="parse_cursor_rule-274"><a href="#parse_cursor_rule-274"><span class="linenos">274</span></a>                <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_cursor_rule-275"><a href="#parse_cursor_rule-275"><span class="linenos">275</span></a>                <span class="k">for</span> <span class="n">tag_match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;- (.*?)$&quot;</span><span class="p">,</span> <span class="n">tags_text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">):</span>
</span><span id="parse_cursor_rule-276"><a href="#parse_cursor_rule-276"><span class="linenos">276</span></a>                    <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="parse_cursor_rule-277"><a href="#parse_cursor_rule-277"><span class="linenos">277</span></a>                <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>
</span><span id="parse_cursor_rule-278"><a href="#parse_cursor_rule-278"><span class="linenos">278</span></a>
</span><span id="parse_cursor_rule-279"><a href="#parse_cursor_rule-279"><span class="linenos">279</span></a>            <span class="n">rule_content</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>
</span><span id="parse_cursor_rule-280"><a href="#parse_cursor_rule-280"><span class="linenos">280</span></a>
</span><span id="parse_cursor_rule-281"><a href="#parse_cursor_rule-281"><span class="linenos">281</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;frontmatter&quot;</span><span class="p">:</span> <span class="n">frontmatter</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">rule_content</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Parse cursor rule content into a structured format.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>content:</strong>  The content of the cursor rule file</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dict[str, Any]: Structured representation of the cursor rule</p>
</blockquote>
</div>


                </section>
                <section id="generate_cursor_rule">
                            <input id="generate_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_cursor_rule</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">content_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">action_message</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">examples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="generate_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_cursor_rule-284"><a href="#generate_cursor_rule-284"><span class="linenos">284</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_cursor_rule</span><span class="p">(</span>
</span><span id="generate_cursor_rule-285"><a href="#generate_cursor_rule-285"><span class="linenos">285</span></a>    <span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule-286"><a href="#generate_cursor_rule-286"><span class="linenos">286</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule-287"><a href="#generate_cursor_rule-287"><span class="linenos">287</span></a>    <span class="n">file_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="generate_cursor_rule-288"><a href="#generate_cursor_rule-288"><span class="linenos">288</span></a>    <span class="n">content_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="generate_cursor_rule-289"><a href="#generate_cursor_rule-289"><span class="linenos">289</span></a>    <span class="n">action_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule-290"><a href="#generate_cursor_rule-290"><span class="linenos">290</span></a>    <span class="n">examples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
</span><span id="generate_cursor_rule-291"><a href="#generate_cursor_rule-291"><span class="linenos">291</span></a>    <span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="generate_cursor_rule-292"><a href="#generate_cursor_rule-292"><span class="linenos">292</span></a>    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="generate_cursor_rule-293"><a href="#generate_cursor_rule-293"><span class="linenos">293</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="generate_cursor_rule-294"><a href="#generate_cursor_rule-294"><span class="linenos">294</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a cursor rule based on the provided parameters.</span>
</span><span id="generate_cursor_rule-295"><a href="#generate_cursor_rule-295"><span class="linenos">295</span></a>
</span><span id="generate_cursor_rule-296"><a href="#generate_cursor_rule-296"><span class="linenos">296</span></a><span class="sd">    Args:</span>
</span><span id="generate_cursor_rule-297"><a href="#generate_cursor_rule-297"><span class="linenos">297</span></a><span class="sd">        rule_name: The name of the rule</span>
</span><span id="generate_cursor_rule-298"><a href="#generate_cursor_rule-298"><span class="linenos">298</span></a><span class="sd">        description: The description of the rule</span>
</span><span id="generate_cursor_rule-299"><a href="#generate_cursor_rule-299"><span class="linenos">299</span></a><span class="sd">        file_patterns: List of file patterns to match</span>
</span><span id="generate_cursor_rule-300"><a href="#generate_cursor_rule-300"><span class="linenos">300</span></a><span class="sd">        content_patterns: List of content patterns to match</span>
</span><span id="generate_cursor_rule-301"><a href="#generate_cursor_rule-301"><span class="linenos">301</span></a><span class="sd">        action_message: The message to display when the rule is triggered</span>
</span><span id="generate_cursor_rule-302"><a href="#generate_cursor_rule-302"><span class="linenos">302</span></a><span class="sd">        examples: List of examples for the rule</span>
</span><span id="generate_cursor_rule-303"><a href="#generate_cursor_rule-303"><span class="linenos">303</span></a><span class="sd">        tags: List of tags for the rule</span>
</span><span id="generate_cursor_rule-304"><a href="#generate_cursor_rule-304"><span class="linenos">304</span></a><span class="sd">        priority: The priority of the rule (high, medium, low)</span>
</span><span id="generate_cursor_rule-305"><a href="#generate_cursor_rule-305"><span class="linenos">305</span></a>
</span><span id="generate_cursor_rule-306"><a href="#generate_cursor_rule-306"><span class="linenos">306</span></a><span class="sd">    Returns:</span>
</span><span id="generate_cursor_rule-307"><a href="#generate_cursor_rule-307"><span class="linenos">307</span></a><span class="sd">        str: The generated cursor rule content</span>
</span><span id="generate_cursor_rule-308"><a href="#generate_cursor_rule-308"><span class="linenos">308</span></a>
</span><span id="generate_cursor_rule-309"><a href="#generate_cursor_rule-309"><span class="linenos">309</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule-310"><a href="#generate_cursor_rule-310"><span class="linenos">310</span></a>    <span class="c1"># Create frontmatter</span>
</span><span id="generate_cursor_rule-311"><a href="#generate_cursor_rule-311"><span class="linenos">311</span></a>    <span class="n">frontmatter</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;---</span>
</span><span id="generate_cursor_rule-312"><a href="#generate_cursor_rule-312"><span class="linenos">312</span></a><span class="s2">description: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span>
</span><span id="generate_cursor_rule-313"><a href="#generate_cursor_rule-313"><span class="linenos">313</span></a><span class="s2">globs: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_cursor_rule-314"><a href="#generate_cursor_rule-314"><span class="linenos">314</span></a><span class="s2">alwaysApply: false</span>
</span><span id="generate_cursor_rule-315"><a href="#generate_cursor_rule-315"><span class="linenos">315</span></a><span class="s2">---&quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule-316"><a href="#generate_cursor_rule-316"><span class="linenos">316</span></a>
</span><span id="generate_cursor_rule-317"><a href="#generate_cursor_rule-317"><span class="linenos">317</span></a>    <span class="c1"># Create title and description</span>
</span><span id="generate_cursor_rule-318"><a href="#generate_cursor_rule-318"><span class="linenos">318</span></a>    <span class="n">title_section</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;# </span><span class="si">{</span><span class="n">rule_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="generate_cursor_rule-319"><a href="#generate_cursor_rule-319"><span class="linenos">319</span></a>
</span><span id="generate_cursor_rule-320"><a href="#generate_cursor_rule-320"><span class="linenos">320</span></a>    <span class="c1"># Create rule section</span>
</span><span id="generate_cursor_rule-321"><a href="#generate_cursor_rule-321"><span class="linenos">321</span></a>    <span class="n">rule_section</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;rule&gt;</span>
</span><span id="generate_cursor_rule-322"><a href="#generate_cursor_rule-322"><span class="linenos">322</span></a><span class="s2">name: </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span>
</span><span id="generate_cursor_rule-323"><a href="#generate_cursor_rule-323"><span class="linenos">323</span></a><span class="s2">description: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span>
</span><span id="generate_cursor_rule-324"><a href="#generate_cursor_rule-324"><span class="linenos">324</span></a><span class="s2">filters:</span>
</span><span id="generate_cursor_rule-325"><a href="#generate_cursor_rule-325"><span class="linenos">325</span></a><span class="s2">  # Match file patterns</span>
</span><span id="generate_cursor_rule-326"><a href="#generate_cursor_rule-326"><span class="linenos">326</span></a><span class="s2">  - type: file_extension</span>
</span><span id="generate_cursor_rule-327"><a href="#generate_cursor_rule-327"><span class="linenos">327</span></a><span class="s2">    pattern: &quot;</span><span class="si">{</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="generate_cursor_rule-328"><a href="#generate_cursor_rule-328"><span class="linenos">328</span></a><span class="s2">  # Match content patterns</span>
</span><span id="generate_cursor_rule-329"><a href="#generate_cursor_rule-329"><span class="linenos">329</span></a><span class="s2">  - type: content</span>
</span><span id="generate_cursor_rule-330"><a href="#generate_cursor_rule-330"><span class="linenos">330</span></a><span class="s2">    pattern: &quot;(?s)(</span><span class="si">{</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content_patterns</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="generate_cursor_rule-331"><a href="#generate_cursor_rule-331"><span class="linenos">331</span></a>
</span><span id="generate_cursor_rule-332"><a href="#generate_cursor_rule-332"><span class="linenos">332</span></a><span class="s2">actions:</span>
</span><span id="generate_cursor_rule-333"><a href="#generate_cursor_rule-333"><span class="linenos">333</span></a><span class="s2">  - type: suggest</span>
</span><span id="generate_cursor_rule-334"><a href="#generate_cursor_rule-334"><span class="linenos">334</span></a><span class="s2">    message: |</span>
</span><span id="generate_cursor_rule-335"><a href="#generate_cursor_rule-335"><span class="linenos">335</span></a><span class="si">{</span><span class="n">action_message</span><span class="si">}</span>
</span><span id="generate_cursor_rule-336"><a href="#generate_cursor_rule-336"><span class="linenos">336</span></a>
</span><span id="generate_cursor_rule-337"><a href="#generate_cursor_rule-337"><span class="linenos">337</span></a><span class="s2">examples:</span>
</span><span id="generate_cursor_rule-338"><a href="#generate_cursor_rule-338"><span class="linenos">338</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule-339"><a href="#generate_cursor_rule-339"><span class="linenos">339</span></a>
</span><span id="generate_cursor_rule-340"><a href="#generate_cursor_rule-340"><span class="linenos">340</span></a>    <span class="c1"># Add examples</span>
</span><span id="generate_cursor_rule-341"><a href="#generate_cursor_rule-341"><span class="linenos">341</span></a>    <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
</span><span id="generate_cursor_rule-342"><a href="#generate_cursor_rule-342"><span class="linenos">342</span></a>        <span class="c1"># Use string concatenation instead of f-string with replace to avoid backslash issues</span>
</span><span id="generate_cursor_rule-343"><a href="#generate_cursor_rule-343"><span class="linenos">343</span></a>        <span class="n">input_text</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">      &quot;</span><span class="p">)</span>
</span><span id="generate_cursor_rule-344"><a href="#generate_cursor_rule-344"><span class="linenos">344</span></a>        <span class="n">rule_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;  - input: |</span>
</span><span id="generate_cursor_rule-345"><a href="#generate_cursor_rule-345"><span class="linenos">345</span></a><span class="s2">      </span><span class="si">{</span><span class="n">input_text</span><span class="si">}</span>
</span><span id="generate_cursor_rule-346"><a href="#generate_cursor_rule-346"><span class="linenos">346</span></a><span class="s2">    output: &quot;</span><span class="si">{</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="generate_cursor_rule-347"><a href="#generate_cursor_rule-347"><span class="linenos">347</span></a>
</span><span id="generate_cursor_rule-348"><a href="#generate_cursor_rule-348"><span class="linenos">348</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule-349"><a href="#generate_cursor_rule-349"><span class="linenos">349</span></a>
</span><span id="generate_cursor_rule-350"><a href="#generate_cursor_rule-350"><span class="linenos">350</span></a>    <span class="c1"># Add metadata</span>
</span><span id="generate_cursor_rule-351"><a href="#generate_cursor_rule-351"><span class="linenos">351</span></a>    <span class="n">rule_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;metadata:</span>
</span><span id="generate_cursor_rule-352"><a href="#generate_cursor_rule-352"><span class="linenos">352</span></a><span class="s2">  priority: </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span>
</span><span id="generate_cursor_rule-353"><a href="#generate_cursor_rule-353"><span class="linenos">353</span></a><span class="s2">  version: 1.0</span>
</span><span id="generate_cursor_rule-354"><a href="#generate_cursor_rule-354"><span class="linenos">354</span></a><span class="s2">  tags:</span>
</span><span id="generate_cursor_rule-355"><a href="#generate_cursor_rule-355"><span class="linenos">355</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule-356"><a href="#generate_cursor_rule-356"><span class="linenos">356</span></a>    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
</span><span id="generate_cursor_rule-357"><a href="#generate_cursor_rule-357"><span class="linenos">357</span></a>        <span class="n">rule_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="generate_cursor_rule-358"><a href="#generate_cursor_rule-358"><span class="linenos">358</span></a>
</span><span id="generate_cursor_rule-359"><a href="#generate_cursor_rule-359"><span class="linenos">359</span></a>    <span class="n">rule_section</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/rule&gt;&quot;</span>
</span><span id="generate_cursor_rule-360"><a href="#generate_cursor_rule-360"><span class="linenos">360</span></a>
</span><span id="generate_cursor_rule-361"><a href="#generate_cursor_rule-361"><span class="linenos">361</span></a>    <span class="c1"># Combine all sections</span>
</span><span id="generate_cursor_rule-362"><a href="#generate_cursor_rule-362"><span class="linenos">362</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">frontmatter</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">title_section</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">rule_section</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Generate a cursor rule based on the provided parameters.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_name:</strong>  The name of the rule</li>
<li><strong>description:</strong>  The description of the rule</li>
<li><strong>file_patterns:</strong>  List of file patterns to match</li>
<li><strong>content_patterns:</strong>  List of content patterns to match</li>
<li><strong>action_message:</strong>  The message to display when the rule is triggered</li>
<li><strong>examples:</strong>  List of examples for the rule</li>
<li><strong>tags:</strong>  List of tags for the rule</li>
<li><strong>priority:</strong>  The priority of the rule (high, medium, low)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>str: The generated cursor rule content</p>
</blockquote>
</div>


                </section>
                <section id="list_cursor_rules">
                            <input id="list_cursor_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.resource">@mcp.resource(&#39;cursor-rules://list&#39;, name=&#39;list_cursor_rules&#39;, description=&#39;List all available cursor rules with their names and descriptions&#39;)</div>

        <span class="def">def</span>
        <span class="name">list_cursor_rules</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="list_cursor_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#list_cursor_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="list_cursor_rules-48"><a href="#list_cursor_rules-48"><span class="linenos">48</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
</span><span id="list_cursor_rules-49"><a href="#list_cursor_rules-49"><span class="linenos">49</span></a>    <span class="s2">&quot;cursor-rules://list&quot;</span><span class="p">,</span>
</span><span id="list_cursor_rules-50"><a href="#list_cursor_rules-50"><span class="linenos">50</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;list_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="list_cursor_rules-51"><a href="#list_cursor_rules-51"><span class="linenos">51</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List all available cursor rules with their names and descriptions&quot;</span><span class="p">,</span>
</span><span id="list_cursor_rules-52"><a href="#list_cursor_rules-52"><span class="linenos">52</span></a><span class="p">)</span>
</span><span id="list_cursor_rules-53"><a href="#list_cursor_rules-53"><span class="linenos">53</span></a><span class="k">def</span><span class="w"> </span><span class="nf">list_cursor_rules</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="list_cursor_rules-54"><a href="#list_cursor_rules-54"><span class="linenos">54</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List all available cursor rules with their names and descriptions.</span>
</span><span id="list_cursor_rules-55"><a href="#list_cursor_rules-55"><span class="linenos">55</span></a>
</span><span id="list_cursor_rules-56"><a href="#list_cursor_rules-56"><span class="linenos">56</span></a><span class="sd">    Returns:</span>
</span><span id="list_cursor_rules-57"><a href="#list_cursor_rules-57"><span class="linenos">57</span></a><span class="sd">        Union[List[Dict[str, str]], Dict[str, Any]]: List of cursor rules with names and descriptions,</span>
</span><span id="list_cursor_rules-58"><a href="#list_cursor_rules-58"><span class="linenos">58</span></a><span class="sd">            or an error message if the operation fails.</span>
</span><span id="list_cursor_rules-59"><a href="#list_cursor_rules-59"><span class="linenos">59</span></a>
</span><span id="list_cursor_rules-60"><a href="#list_cursor_rules-60"><span class="linenos">60</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="list_cursor_rules-61"><a href="#list_cursor_rules-61"><span class="linenos">61</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="list_cursor_rules-62"><a href="#list_cursor_rules-62"><span class="linenos">62</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Listing all cursor rules&quot;</span><span class="p">)</span>
</span><span id="list_cursor_rules-63"><a href="#list_cursor_rules-63"><span class="linenos">63</span></a>        <span class="n">rule_names</span> <span class="o">=</span> <span class="n">get_cursor_rule_names</span><span class="p">()</span>
</span><span id="list_cursor_rules-64"><a href="#list_cursor_rules-64"><span class="linenos">64</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="list_cursor_rules-65"><a href="#list_cursor_rules-65"><span class="linenos">65</span></a>
</span><span id="list_cursor_rules-66"><a href="#list_cursor_rules-66"><span class="linenos">66</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">rule_names</span><span class="p">:</span>
</span><span id="list_cursor_rules-67"><a href="#list_cursor_rules-67"><span class="linenos">67</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="list_cursor_rules-68"><a href="#list_cursor_rules-68"><span class="linenos">68</span></a>            <span class="n">rule_content</span> <span class="o">=</span> <span class="n">read_cursor_rule</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="list_cursor_rules-69"><a href="#list_cursor_rules-69"><span class="linenos">69</span></a>            <span class="k">if</span> <span class="n">rule_content</span><span class="p">:</span>
</span><span id="list_cursor_rules-70"><a href="#list_cursor_rules-70"><span class="linenos">70</span></a>                <span class="n">rule_data</span> <span class="o">=</span> <span class="n">parse_cursor_rule</span><span class="p">(</span><span class="n">rule_content</span><span class="p">)</span>
</span><span id="list_cursor_rules-71"><a href="#list_cursor_rules-71"><span class="linenos">71</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">rule_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;No description available&quot;</span><span class="p">)})</span>
</span><span id="list_cursor_rules-72"><a href="#list_cursor_rules-72"><span class="linenos">72</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="list_cursor_rules-73"><a href="#list_cursor_rules-73"><span class="linenos">73</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not read content for rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="list_cursor_rules-74"><a href="#list_cursor_rules-74"><span class="linenos">74</span></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Description unavailable&quot;</span><span class="p">})</span>
</span><span id="list_cursor_rules-75"><a href="#list_cursor_rules-75"><span class="linenos">75</span></a>
</span><span id="list_cursor_rules-76"><a href="#list_cursor_rules-76"><span class="linenos">76</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2"> cursor rules&quot;</span><span class="p">)</span>
</span><span id="list_cursor_rules-77"><a href="#list_cursor_rules-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="list_cursor_rules-78"><a href="#list_cursor_rules-78"><span class="linenos">78</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="list_cursor_rules-79"><a href="#list_cursor_rules-79"><span class="linenos">79</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error listing cursor rules: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="list_cursor_rules-80"><a href="#list_cursor_rules-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to list cursor rules&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span></pre></div>


            <div class="docstring"><p>List all available cursor rules with their names and descriptions.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Union[List[Dict[str, str]], Dict[str, Any]]: List of cursor rules with names and descriptions,
      or an error message if the operation fails.</p>
</blockquote>
</div>


                </section>
                <section id="get_cursor_rule">
                            <input id="get_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.resource">@mcp.resource(&#39;cursor-rule://{name}&#39;, name=&#39;get_cursor_rule&#39;, description=&#39;Get a parsed cursor rule by name with structured content&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_cursor_rule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_cursor_rule-83"><a href="#get_cursor_rule-83"><span class="linenos"> 83</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
</span><span id="get_cursor_rule-84"><a href="#get_cursor_rule-84"><span class="linenos"> 84</span></a>    <span class="s2">&quot;cursor-rule://</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule-85"><a href="#get_cursor_rule-85"><span class="linenos"> 85</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;get_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule-86"><a href="#get_cursor_rule-86"><span class="linenos"> 86</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get a parsed cursor rule by name with structured content&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule-87"><a href="#get_cursor_rule-87"><span class="linenos"> 87</span></a><span class="p">)</span>
</span><span id="get_cursor_rule-88"><a href="#get_cursor_rule-88"><span class="linenos"> 88</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cursor_rule</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="get_cursor_rule-89"><a href="#get_cursor_rule-89"><span class="linenos"> 89</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a parsed cursor rule by name with structured content.</span>
</span><span id="get_cursor_rule-90"><a href="#get_cursor_rule-90"><span class="linenos"> 90</span></a>
</span><span id="get_cursor_rule-91"><a href="#get_cursor_rule-91"><span class="linenos"> 91</span></a><span class="sd">    Args:</span>
</span><span id="get_cursor_rule-92"><a href="#get_cursor_rule-92"><span class="linenos"> 92</span></a><span class="sd">        name: The name of the cursor rule</span>
</span><span id="get_cursor_rule-93"><a href="#get_cursor_rule-93"><span class="linenos"> 93</span></a>
</span><span id="get_cursor_rule-94"><a href="#get_cursor_rule-94"><span class="linenos"> 94</span></a><span class="sd">    Returns:</span>
</span><span id="get_cursor_rule-95"><a href="#get_cursor_rule-95"><span class="linenos"> 95</span></a><span class="sd">        Dict[str, Any]: Structured representation of the cursor rule,</span>
</span><span id="get_cursor_rule-96"><a href="#get_cursor_rule-96"><span class="linenos"> 96</span></a><span class="sd">            or an error message if the rule doesn&#39;t exist or can&#39;t be parsed.</span>
</span><span id="get_cursor_rule-97"><a href="#get_cursor_rule-97"><span class="linenos"> 97</span></a>
</span><span id="get_cursor_rule-98"><a href="#get_cursor_rule-98"><span class="linenos"> 98</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_cursor_rule-99"><a href="#get_cursor_rule-99"><span class="linenos"> 99</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_cursor_rule-100"><a href="#get_cursor_rule-100"><span class="linenos">100</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting cursor rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule-101"><a href="#get_cursor_rule-101"><span class="linenos">101</span></a>        <span class="n">rule_content</span> <span class="o">=</span> <span class="n">read_cursor_rule</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="get_cursor_rule-102"><a href="#get_cursor_rule-102"><span class="linenos">102</span></a>
</span><span id="get_cursor_rule-103"><a href="#get_cursor_rule-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_content</span><span class="p">:</span>
</span><span id="get_cursor_rule-104"><a href="#get_cursor_rule-104"><span class="linenos">104</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cursor rule not found: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule-105"><a href="#get_cursor_rule-105"><span class="linenos">105</span></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Rule not found&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Cursor rule &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist or could not be read.&quot;</span><span class="p">}</span>
</span><span id="get_cursor_rule-106"><a href="#get_cursor_rule-106"><span class="linenos">106</span></a>
</span><span id="get_cursor_rule-107"><a href="#get_cursor_rule-107"><span class="linenos">107</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsing cursor rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule-108"><a href="#get_cursor_rule-108"><span class="linenos">108</span></a>        <span class="n">rule_data</span> <span class="o">=</span> <span class="n">parse_cursor_rule</span><span class="p">(</span><span class="n">rule_content</span><span class="p">)</span>
</span><span id="get_cursor_rule-109"><a href="#get_cursor_rule-109"><span class="linenos">109</span></a>
</span><span id="get_cursor_rule-110"><a href="#get_cursor_rule-110"><span class="linenos">110</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_data</span><span class="p">:</span>
</span><span id="get_cursor_rule-111"><a href="#get_cursor_rule-111"><span class="linenos">111</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to parse cursor rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule-112"><a href="#get_cursor_rule-112"><span class="linenos">112</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="get_cursor_rule-113"><a href="#get_cursor_rule-113"><span class="linenos">113</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Parsing failure&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule-114"><a href="#get_cursor_rule-114"><span class="linenos">114</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Failed to parse cursor rule &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. The file may be malformed.&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule-115"><a href="#get_cursor_rule-115"><span class="linenos">115</span></a>            <span class="p">}</span>
</span><span id="get_cursor_rule-116"><a href="#get_cursor_rule-116"><span class="linenos">116</span></a>
</span><span id="get_cursor_rule-117"><a href="#get_cursor_rule-117"><span class="linenos">117</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully retrieved cursor rule: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule-118"><a href="#get_cursor_rule-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="n">rule_data</span>
</span><span id="get_cursor_rule-119"><a href="#get_cursor_rule-119"><span class="linenos">119</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="get_cursor_rule-120"><a href="#get_cursor_rule-120"><span class="linenos">120</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting cursor rule &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="get_cursor_rule-121"><a href="#get_cursor_rule-121"><span class="linenos">121</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to get cursor rule&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span></pre></div>


            <div class="docstring"><p>Get a parsed cursor rule by name with structured content.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  The name of the cursor rule</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dict[str, Any]: Structured representation of the cursor rule,
      or an error message if the rule doesn't exist or can't be parsed.</p>
</blockquote>
</div>


                </section>
                <section id="get_cursor_rule_raw">
                            <input id="get_cursor_rule_raw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.resource">@mcp.resource(&#39;cursor-rule-raw://{name}&#39;, name=&#39;get_cursor_rule_raw&#39;, description=&#39;Get the raw markdown content of a cursor rule by name&#39;)</div>

        <span class="def">def</span>
        <span class="name">get_cursor_rule_raw</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_cursor_rule_raw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_cursor_rule_raw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_cursor_rule_raw-124"><a href="#get_cursor_rule_raw-124"><span class="linenos">124</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
</span><span id="get_cursor_rule_raw-125"><a href="#get_cursor_rule_raw-125"><span class="linenos">125</span></a>    <span class="s2">&quot;cursor-rule-raw://</span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule_raw-126"><a href="#get_cursor_rule_raw-126"><span class="linenos">126</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;get_cursor_rule_raw&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule_raw-127"><a href="#get_cursor_rule_raw-127"><span class="linenos">127</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get the raw markdown content of a cursor rule by name&quot;</span><span class="p">,</span>
</span><span id="get_cursor_rule_raw-128"><a href="#get_cursor_rule_raw-128"><span class="linenos">128</span></a><span class="p">)</span>
</span><span id="get_cursor_rule_raw-129"><a href="#get_cursor_rule_raw-129"><span class="linenos">129</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cursor_rule_raw</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="get_cursor_rule_raw-130"><a href="#get_cursor_rule_raw-130"><span class="linenos">130</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the raw markdown content of a cursor rule by name.</span>
</span><span id="get_cursor_rule_raw-131"><a href="#get_cursor_rule_raw-131"><span class="linenos">131</span></a>
</span><span id="get_cursor_rule_raw-132"><a href="#get_cursor_rule_raw-132"><span class="linenos">132</span></a><span class="sd">    Args:</span>
</span><span id="get_cursor_rule_raw-133"><a href="#get_cursor_rule_raw-133"><span class="linenos">133</span></a><span class="sd">        name: The name of the cursor rule</span>
</span><span id="get_cursor_rule_raw-134"><a href="#get_cursor_rule_raw-134"><span class="linenos">134</span></a>
</span><span id="get_cursor_rule_raw-135"><a href="#get_cursor_rule_raw-135"><span class="linenos">135</span></a><span class="sd">    Returns:</span>
</span><span id="get_cursor_rule_raw-136"><a href="#get_cursor_rule_raw-136"><span class="linenos">136</span></a><span class="sd">        Union[str, Dict[str, str]]: The raw markdown content of the cursor rule,</span>
</span><span id="get_cursor_rule_raw-137"><a href="#get_cursor_rule_raw-137"><span class="linenos">137</span></a><span class="sd">            or an error message if the rule doesn&#39;t exist.</span>
</span><span id="get_cursor_rule_raw-138"><a href="#get_cursor_rule_raw-138"><span class="linenos">138</span></a>
</span><span id="get_cursor_rule_raw-139"><a href="#get_cursor_rule_raw-139"><span class="linenos">139</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_cursor_rule_raw-140"><a href="#get_cursor_rule_raw-140"><span class="linenos">140</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_cursor_rule_raw-141"><a href="#get_cursor_rule_raw-141"><span class="linenos">141</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting raw cursor rule content: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule_raw-142"><a href="#get_cursor_rule_raw-142"><span class="linenos">142</span></a>        <span class="n">rule_content</span> <span class="o">=</span> <span class="n">read_cursor_rule</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="get_cursor_rule_raw-143"><a href="#get_cursor_rule_raw-143"><span class="linenos">143</span></a>
</span><span id="get_cursor_rule_raw-144"><a href="#get_cursor_rule_raw-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_content</span><span class="p">:</span>
</span><span id="get_cursor_rule_raw-145"><a href="#get_cursor_rule_raw-145"><span class="linenos">145</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cursor rule not found: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule_raw-146"><a href="#get_cursor_rule_raw-146"><span class="linenos">146</span></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Rule not found&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Cursor rule &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist or could not be read.&quot;</span><span class="p">}</span>
</span><span id="get_cursor_rule_raw-147"><a href="#get_cursor_rule_raw-147"><span class="linenos">147</span></a>
</span><span id="get_cursor_rule_raw-148"><a href="#get_cursor_rule_raw-148"><span class="linenos">148</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully retrieved raw cursor rule content: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_cursor_rule_raw-149"><a href="#get_cursor_rule_raw-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="n">rule_content</span>
</span><span id="get_cursor_rule_raw-150"><a href="#get_cursor_rule_raw-150"><span class="linenos">150</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="get_cursor_rule_raw-151"><a href="#get_cursor_rule_raw-151"><span class="linenos">151</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting raw cursor rule &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="get_cursor_rule_raw-152"><a href="#get_cursor_rule_raw-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to get cursor rule content&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span></pre></div>


            <div class="docstring"><p>Get the raw markdown content of a cursor rule by name.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  The name of the cursor rule</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Union[str, Dict[str, str]]: The raw markdown content of the cursor rule,
      or an error message if the rule doesn't exist.</p>
</blockquote>
</div>


                </section>
                <section id="instruct_repo_analysis">
                            <input id="instruct_repo_analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;instruct_repo_analysis&#39;, description=&#39;Run a repository analysis to gather information for cursor rule creation&#39;)</div>

        <span class="def">def</span>
        <span class="name">instruct_repo_analysis</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="instruct_repo_analysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#instruct_repo_analysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="instruct_repo_analysis-72"><a href="#instruct_repo_analysis-72"><span class="linenos"> 72</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="instruct_repo_analysis-73"><a href="#instruct_repo_analysis-73"><span class="linenos"> 73</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;instruct_repo_analysis&quot;</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-74"><a href="#instruct_repo_analysis-74"><span class="linenos"> 74</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run a repository analysis to gather information for cursor rule creation&quot;</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-75"><a href="#instruct_repo_analysis-75"><span class="linenos"> 75</span></a><span class="p">)</span>
</span><span id="instruct_repo_analysis-76"><a href="#instruct_repo_analysis-76"><span class="linenos"> 76</span></a><span class="k">def</span><span class="w"> </span><span class="nf">instruct_repo_analysis</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="instruct_repo_analysis-77"><a href="#instruct_repo_analysis-77"><span class="linenos"> 77</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a repository analysis to gather information for cursor rule creation.</span>
</span><span id="instruct_repo_analysis-78"><a href="#instruct_repo_analysis-78"><span class="linenos"> 78</span></a>
</span><span id="instruct_repo_analysis-79"><a href="#instruct_repo_analysis-79"><span class="linenos"> 79</span></a><span class="sd">    This tool executes a script that analyzes the repository structure and</span>
</span><span id="instruct_repo_analysis-80"><a href="#instruct_repo_analysis-80"><span class="linenos"> 80</span></a><span class="sd">    generates a report with information that can be used to create cursor rules.</span>
</span><span id="instruct_repo_analysis-81"><a href="#instruct_repo_analysis-81"><span class="linenos"> 81</span></a>
</span><span id="instruct_repo_analysis-82"><a href="#instruct_repo_analysis-82"><span class="linenos"> 82</span></a><span class="sd">    Returns:</span>
</span><span id="instruct_repo_analysis-83"><a href="#instruct_repo_analysis-83"><span class="linenos"> 83</span></a><span class="sd">        Dict[str, Any]: Repository analysis results, or an error message if the analysis fails.</span>
</span><span id="instruct_repo_analysis-84"><a href="#instruct_repo_analysis-84"><span class="linenos"> 84</span></a>
</span><span id="instruct_repo_analysis-85"><a href="#instruct_repo_analysis-85"><span class="linenos"> 85</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="instruct_repo_analysis-86"><a href="#instruct_repo_analysis-86"><span class="linenos"> 86</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-87"><a href="#instruct_repo_analysis-87"><span class="linenos"> 87</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting repository analysis&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-88"><a href="#instruct_repo_analysis-88"><span class="linenos"> 88</span></a>
</span><span id="instruct_repo_analysis-89"><a href="#instruct_repo_analysis-89"><span class="linenos"> 89</span></a>        <span class="c1"># Get current working directory</span>
</span><span id="instruct_repo_analysis-90"><a href="#instruct_repo_analysis-90"><span class="linenos"> 90</span></a>        <span class="n">repo_root</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
</span><span id="instruct_repo_analysis-91"><a href="#instruct_repo_analysis-91"><span class="linenos"> 91</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Repository root: </span><span class="si">{</span><span class="n">repo_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-92"><a href="#instruct_repo_analysis-92"><span class="linenos"> 92</span></a>
</span><span id="instruct_repo_analysis-93"><a href="#instruct_repo_analysis-93"><span class="linenos"> 93</span></a>        <span class="c1"># Analyze repository structure</span>
</span><span id="instruct_repo_analysis-94"><a href="#instruct_repo_analysis-94"><span class="linenos"> 94</span></a>        <span class="n">repo_structure</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="instruct_repo_analysis-95"><a href="#instruct_repo_analysis-95"><span class="linenos"> 95</span></a>
</span><span id="instruct_repo_analysis-96"><a href="#instruct_repo_analysis-96"><span class="linenos"> 96</span></a>        <span class="c1"># Get Python files</span>
</span><span id="instruct_repo_analysis-97"><a href="#instruct_repo_analysis-97"><span class="linenos"> 97</span></a>        <span class="n">python_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repo_root</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*.py&quot;</span><span class="p">))</span>
</span><span id="instruct_repo_analysis-98"><a href="#instruct_repo_analysis-98"><span class="linenos"> 98</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;python_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">repo_root</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">python_files</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-99"><a href="#instruct_repo_analysis-99"><span class="linenos"> 99</span></a>
</span><span id="instruct_repo_analysis-100"><a href="#instruct_repo_analysis-100"><span class="linenos">100</span></a>        <span class="c1"># Get test files</span>
</span><span id="instruct_repo_analysis-101"><a href="#instruct_repo_analysis-101"><span class="linenos">101</span></a>        <span class="n">test_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repo_root</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/test_*.py&quot;</span><span class="p">))</span>
</span><span id="instruct_repo_analysis-102"><a href="#instruct_repo_analysis-102"><span class="linenos">102</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;test_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">repo_root</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">test_files</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-103"><a href="#instruct_repo_analysis-103"><span class="linenos">103</span></a>
</span><span id="instruct_repo_analysis-104"><a href="#instruct_repo_analysis-104"><span class="linenos">104</span></a>        <span class="c1"># Get configuration files</span>
</span><span id="instruct_repo_analysis-105"><a href="#instruct_repo_analysis-105"><span class="linenos">105</span></a>        <span class="n">config_files</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="instruct_repo_analysis-106"><a href="#instruct_repo_analysis-106"><span class="linenos">106</span></a>        <span class="n">config_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.json&quot;</span><span class="p">,</span> <span class="s2">&quot;*.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;*.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;*.toml&quot;</span><span class="p">,</span> <span class="s2">&quot;*.ini&quot;</span><span class="p">,</span> <span class="s2">&quot;*.cfg&quot;</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-107"><a href="#instruct_repo_analysis-107"><span class="linenos">107</span></a>        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">config_patterns</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-108"><a href="#instruct_repo_analysis-108"><span class="linenos">108</span></a>            <span class="n">config_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">repo_root</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</span><span id="instruct_repo_analysis-109"><a href="#instruct_repo_analysis-109"><span class="linenos">109</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;config_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">repo_root</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">config_files</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-110"><a href="#instruct_repo_analysis-110"><span class="linenos">110</span></a>
</span><span id="instruct_repo_analysis-111"><a href="#instruct_repo_analysis-111"><span class="linenos">111</span></a>        <span class="c1"># Get documentation files</span>
</span><span id="instruct_repo_analysis-112"><a href="#instruct_repo_analysis-112"><span class="linenos">112</span></a>        <span class="n">doc_files</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="instruct_repo_analysis-113"><a href="#instruct_repo_analysis-113"><span class="linenos">113</span></a>        <span class="n">doc_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;*.rst&quot;</span><span class="p">,</span> <span class="s2">&quot;*.txt&quot;</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-114"><a href="#instruct_repo_analysis-114"><span class="linenos">114</span></a>        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">doc_patterns</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-115"><a href="#instruct_repo_analysis-115"><span class="linenos">115</span></a>            <span class="n">doc_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">repo_root</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</span><span id="instruct_repo_analysis-116"><a href="#instruct_repo_analysis-116"><span class="linenos">116</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;doc_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">repo_root</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">doc_files</span><span class="p">]</span>
</span><span id="instruct_repo_analysis-117"><a href="#instruct_repo_analysis-117"><span class="linenos">117</span></a>
</span><span id="instruct_repo_analysis-118"><a href="#instruct_repo_analysis-118"><span class="linenos">118</span></a>        <span class="c1"># Get directory structure</span>
</span><span id="instruct_repo_analysis-119"><a href="#instruct_repo_analysis-119"><span class="linenos">119</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_dir_structure</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="instruct_repo_analysis-120"><a href="#instruct_repo_analysis-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="n">max_depth</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-121"><a href="#instruct_repo_analysis-121"><span class="linenos">121</span></a>                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span> <span class="s2">&quot;truncated&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="instruct_repo_analysis-122"><a href="#instruct_repo_analysis-122"><span class="linenos">122</span></a>
</span><span id="instruct_repo_analysis-123"><a href="#instruct_repo_analysis-123"><span class="linenos">123</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="p">:</span> <span class="p">{}}</span>
</span><span id="instruct_repo_analysis-124"><a href="#instruct_repo_analysis-124"><span class="linenos">124</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-125"><a href="#instruct_repo_analysis-125"><span class="linenos">125</span></a>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
</span><span id="instruct_repo_analysis-126"><a href="#instruct_repo_analysis-126"><span class="linenos">126</span></a>                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;__pycache__&quot;</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-127"><a href="#instruct_repo_analysis-127"><span class="linenos">127</span></a>                        <span class="k">continue</span>
</span><span id="instruct_repo_analysis-128"><a href="#instruct_repo_analysis-128"><span class="linenos">128</span></a>                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="instruct_repo_analysis-129"><a href="#instruct_repo_analysis-129"><span class="linenos">129</span></a>                        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;contents&quot;</span><span class="p">][</span><span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_dir_structure</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-130"><a href="#instruct_repo_analysis-130"><span class="linenos">130</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-131"><a href="#instruct_repo_analysis-131"><span class="linenos">131</span></a>                        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;contents&quot;</span><span class="p">][</span><span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">}</span>
</span><span id="instruct_repo_analysis-132"><a href="#instruct_repo_analysis-132"><span class="linenos">132</span></a>            <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-133"><a href="#instruct_repo_analysis-133"><span class="linenos">133</span></a>                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Permission denied&quot;</span>
</span><span id="instruct_repo_analysis-134"><a href="#instruct_repo_analysis-134"><span class="linenos">134</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="instruct_repo_analysis-135"><a href="#instruct_repo_analysis-135"><span class="linenos">135</span></a>
</span><span id="instruct_repo_analysis-136"><a href="#instruct_repo_analysis-136"><span class="linenos">136</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;directory_structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_dir_structure</span><span class="p">(</span><span class="n">repo_root</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-137"><a href="#instruct_repo_analysis-137"><span class="linenos">137</span></a>
</span><span id="instruct_repo_analysis-138"><a href="#instruct_repo_analysis-138"><span class="linenos">138</span></a>        <span class="c1"># Get git information if available</span>
</span><span id="instruct_repo_analysis-139"><a href="#instruct_repo_analysis-139"><span class="linenos">139</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-140"><a href="#instruct_repo_analysis-140"><span class="linenos">140</span></a>            <span class="c1"># Get current branch</span>
</span><span id="instruct_repo_analysis-141"><a href="#instruct_repo_analysis-141"><span class="linenos">141</span></a>            <span class="n">branch</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
</span><span id="instruct_repo_analysis-142"><a href="#instruct_repo_analysis-142"><span class="linenos">142</span></a>                <span class="p">[</span><span class="s2">&quot;git&quot;</span><span class="p">,</span> <span class="s2">&quot;rev-parse&quot;</span><span class="p">,</span> <span class="s2">&quot;--abbrev-ref&quot;</span><span class="p">,</span> <span class="s2">&quot;HEAD&quot;</span><span class="p">],</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span id="instruct_repo_analysis-143"><a href="#instruct_repo_analysis-143"><span class="linenos">143</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="instruct_repo_analysis-144"><a href="#instruct_repo_analysis-144"><span class="linenos">144</span></a>            <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;git_branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>
</span><span id="instruct_repo_analysis-145"><a href="#instruct_repo_analysis-145"><span class="linenos">145</span></a>
</span><span id="instruct_repo_analysis-146"><a href="#instruct_repo_analysis-146"><span class="linenos">146</span></a>            <span class="c1"># Get recent commits</span>
</span><span id="instruct_repo_analysis-147"><a href="#instruct_repo_analysis-147"><span class="linenos">147</span></a>            <span class="n">commits</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
</span><span id="instruct_repo_analysis-148"><a href="#instruct_repo_analysis-148"><span class="linenos">148</span></a>                <span class="p">[</span><span class="s2">&quot;git&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s2">&quot;--oneline&quot;</span><span class="p">,</span> <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">],</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span><span id="instruct_repo_analysis-149"><a href="#instruct_repo_analysis-149"><span class="linenos">149</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="instruct_repo_analysis-150"><a href="#instruct_repo_analysis-150"><span class="linenos">150</span></a>            <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;recent_commits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">commits</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-151"><a href="#instruct_repo_analysis-151"><span class="linenos">151</span></a>        <span class="k">except</span> <span class="p">(</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
</span><span id="instruct_repo_analysis-152"><a href="#instruct_repo_analysis-152"><span class="linenos">152</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Git information not available&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-153"><a href="#instruct_repo_analysis-153"><span class="linenos">153</span></a>            <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;git_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Not available&quot;</span>
</span><span id="instruct_repo_analysis-154"><a href="#instruct_repo_analysis-154"><span class="linenos">154</span></a>
</span><span id="instruct_repo_analysis-155"><a href="#instruct_repo_analysis-155"><span class="linenos">155</span></a>        <span class="c1"># Get package dependencies</span>
</span><span id="instruct_repo_analysis-156"><a href="#instruct_repo_analysis-156"><span class="linenos">156</span></a>        <span class="n">dependencies</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="instruct_repo_analysis-157"><a href="#instruct_repo_analysis-157"><span class="linenos">157</span></a>
</span><span id="instruct_repo_analysis-158"><a href="#instruct_repo_analysis-158"><span class="linenos">158</span></a>        <span class="c1"># Check for requirements.txt</span>
</span><span id="instruct_repo_analysis-159"><a href="#instruct_repo_analysis-159"><span class="linenos">159</span></a>        <span class="n">req_file</span> <span class="o">=</span> <span class="n">repo_root</span> <span class="o">/</span> <span class="s2">&quot;requirements.txt&quot;</span>
</span><span id="instruct_repo_analysis-160"><a href="#instruct_repo_analysis-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="n">req_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="instruct_repo_analysis-161"><a href="#instruct_repo_analysis-161"><span class="linenos">161</span></a>            <span class="n">dependencies</span><span class="p">[</span><span class="s2">&quot;requirements.txt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">req_file</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-162"><a href="#instruct_repo_analysis-162"><span class="linenos">162</span></a>
</span><span id="instruct_repo_analysis-163"><a href="#instruct_repo_analysis-163"><span class="linenos">163</span></a>        <span class="c1"># Check for pyproject.toml</span>
</span><span id="instruct_repo_analysis-164"><a href="#instruct_repo_analysis-164"><span class="linenos">164</span></a>        <span class="n">pyproject_file</span> <span class="o">=</span> <span class="n">repo_root</span> <span class="o">/</span> <span class="s2">&quot;pyproject.toml&quot;</span>
</span><span id="instruct_repo_analysis-165"><a href="#instruct_repo_analysis-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="n">pyproject_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="instruct_repo_analysis-166"><a href="#instruct_repo_analysis-166"><span class="linenos">166</span></a>            <span class="n">dependencies</span><span class="p">[</span><span class="s2">&quot;pyproject.toml&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Present&quot;</span>
</span><span id="instruct_repo_analysis-167"><a href="#instruct_repo_analysis-167"><span class="linenos">167</span></a>
</span><span id="instruct_repo_analysis-168"><a href="#instruct_repo_analysis-168"><span class="linenos">168</span></a>        <span class="c1"># Check for setup.py</span>
</span><span id="instruct_repo_analysis-169"><a href="#instruct_repo_analysis-169"><span class="linenos">169</span></a>        <span class="n">setup_file</span> <span class="o">=</span> <span class="n">repo_root</span> <span class="o">/</span> <span class="s2">&quot;setup.py&quot;</span>
</span><span id="instruct_repo_analysis-170"><a href="#instruct_repo_analysis-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="n">setup_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="instruct_repo_analysis-171"><a href="#instruct_repo_analysis-171"><span class="linenos">171</span></a>            <span class="n">dependencies</span><span class="p">[</span><span class="s2">&quot;setup.py&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Present&quot;</span>
</span><span id="instruct_repo_analysis-172"><a href="#instruct_repo_analysis-172"><span class="linenos">172</span></a>
</span><span id="instruct_repo_analysis-173"><a href="#instruct_repo_analysis-173"><span class="linenos">173</span></a>        <span class="n">repo_structure</span><span class="p">[</span><span class="s2">&quot;dependencies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dependencies</span>
</span><span id="instruct_repo_analysis-174"><a href="#instruct_repo_analysis-174"><span class="linenos">174</span></a>
</span><span id="instruct_repo_analysis-175"><a href="#instruct_repo_analysis-175"><span class="linenos">175</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Repository analysis completed successfully&quot;</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-176"><a href="#instruct_repo_analysis-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="instruct_repo_analysis-177"><a href="#instruct_repo_analysis-177"><span class="linenos">177</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-178"><a href="#instruct_repo_analysis-178"><span class="linenos">178</span></a>            <span class="s2">&quot;repository_structure&quot;</span><span class="p">:</span> <span class="n">repo_structure</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-179"><a href="#instruct_repo_analysis-179"><span class="linenos">179</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Repository analysis completed successfully&quot;</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-180"><a href="#instruct_repo_analysis-180"><span class="linenos">180</span></a>        <span class="p">}</span>
</span><span id="instruct_repo_analysis-181"><a href="#instruct_repo_analysis-181"><span class="linenos">181</span></a>
</span><span id="instruct_repo_analysis-182"><a href="#instruct_repo_analysis-182"><span class="linenos">182</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="instruct_repo_analysis-183"><a href="#instruct_repo_analysis-183"><span class="linenos">183</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during repository analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="instruct_repo_analysis-184"><a href="#instruct_repo_analysis-184"><span class="linenos">184</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="instruct_repo_analysis-185"><a href="#instruct_repo_analysis-185"><span class="linenos">185</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-186"><a href="#instruct_repo_analysis-186"><span class="linenos">186</span></a>            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Error during repository analysis&quot;</span><span class="p">,</span>
</span><span id="instruct_repo_analysis-187"><a href="#instruct_repo_analysis-187"><span class="linenos">187</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
</span><span id="instruct_repo_analysis-188"><a href="#instruct_repo_analysis-188"><span class="linenos">188</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Run a repository analysis to gather information for cursor rule creation.</p>

<p>This tool executes a script that analyzes the repository structure and
generates a report with information that can be used to create cursor rules.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dict[str, Any]: Repository analysis results, or an error message if the analysis fails.</p>
</blockquote>
</div>


                </section>
                <section id="instruct_custom_repo_rules_generation">
                            <input id="instruct_custom_repo_rules_generation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;instruct_custom_repo_rules_generation&#39;, description=&#39;Run a cursor rules generation process based on repository analysis&#39;)</div>

        <span class="def">def</span>
        <span class="name">instruct_custom_repo_rules_generation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">report_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ai_report.md&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Path to the AI report file, relative to the project root&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ai_report.md&#39;</span><span class="p">,</span> <span class="s1">&#39;docs/ai_report.md&#39;</span><span class="p">])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="instruct_custom_repo_rules_generation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#instruct_custom_repo_rules_generation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="instruct_custom_repo_rules_generation-574"><a href="#instruct_custom_repo_rules_generation-574"><span class="linenos">574</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="instruct_custom_repo_rules_generation-575"><a href="#instruct_custom_repo_rules_generation-575"><span class="linenos">575</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;instruct_custom_repo_rules_generation&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-576"><a href="#instruct_custom_repo_rules_generation-576"><span class="linenos">576</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run a cursor rules generation process based on repository analysis&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-577"><a href="#instruct_custom_repo_rules_generation-577"><span class="linenos">577</span></a><span class="p">)</span>
</span><span id="instruct_custom_repo_rules_generation-578"><a href="#instruct_custom_repo_rules_generation-578"><span class="linenos">578</span></a><span class="k">def</span><span class="w"> </span><span class="nf">instruct_custom_repo_rules_generation</span><span class="p">(</span>
</span><span id="instruct_custom_repo_rules_generation-579"><a href="#instruct_custom_repo_rules_generation-579"><span class="linenos">579</span></a>    <span class="c1"># repo_summary: str = Field(</span>
</span><span id="instruct_custom_repo_rules_generation-580"><a href="#instruct_custom_repo_rules_generation-580"><span class="linenos">580</span></a>    <span class="c1">#     description=&quot;A summary description of the repository, including technologies, frameworks, and key features&quot;,</span>
</span><span id="instruct_custom_repo_rules_generation-581"><a href="#instruct_custom_repo_rules_generation-581"><span class="linenos">581</span></a>    <span class="c1">#     examples=[&quot;A Python web application using FastAPI, SQLAlchemy, and React for the frontend. Includes authentication, API endpoints, and database models.&quot;],</span>
</span><span id="instruct_custom_repo_rules_generation-582"><a href="#instruct_custom_repo_rules_generation-582"><span class="linenos">582</span></a>    <span class="c1">#     min_length=20,</span>
</span><span id="instruct_custom_repo_rules_generation-583"><a href="#instruct_custom_repo_rules_generation-583"><span class="linenos">583</span></a>    <span class="c1"># ),</span>
</span><span id="instruct_custom_repo_rules_generation-584"><a href="#instruct_custom_repo_rules_generation-584"><span class="linenos">584</span></a>    <span class="n">report_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="instruct_custom_repo_rules_generation-585"><a href="#instruct_custom_repo_rules_generation-585"><span class="linenos">585</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Path to the AI report file, relative to the project root&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-586"><a href="#instruct_custom_repo_rules_generation-586"><span class="linenos">586</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ai_report.md&quot;</span><span class="p">,</span> <span class="s2">&quot;docs/ai_report.md&quot;</span><span class="p">],</span>
</span><span id="instruct_custom_repo_rules_generation-587"><a href="#instruct_custom_repo_rules_generation-587"><span class="linenos">587</span></a>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;ai_report.md&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-588"><a href="#instruct_custom_repo_rules_generation-588"><span class="linenos">588</span></a>    <span class="p">),</span>
</span><span id="instruct_custom_repo_rules_generation-589"><a href="#instruct_custom_repo_rules_generation-589"><span class="linenos">589</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="instruct_custom_repo_rules_generation-590"><a href="#instruct_custom_repo_rules_generation-590"><span class="linenos">590</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a cursor rules generation process based on repository analysis.</span>
</span><span id="instruct_custom_repo_rules_generation-591"><a href="#instruct_custom_repo_rules_generation-591"><span class="linenos">591</span></a>
</span><span id="instruct_custom_repo_rules_generation-592"><a href="#instruct_custom_repo_rules_generation-592"><span class="linenos">592</span></a><span class="sd">    This function first checks for the existence of an AI report file,</span>
</span><span id="instruct_custom_repo_rules_generation-593"><a href="#instruct_custom_repo_rules_generation-593"><span class="linenos">593</span></a><span class="sd">    then uses its content to generate cursor rules for the repository.</span>
</span><span id="instruct_custom_repo_rules_generation-594"><a href="#instruct_custom_repo_rules_generation-594"><span class="linenos">594</span></a>
</span><span id="instruct_custom_repo_rules_generation-595"><a href="#instruct_custom_repo_rules_generation-595"><span class="linenos">595</span></a><span class="sd">    Args:</span>
</span><span id="instruct_custom_repo_rules_generation-596"><a href="#instruct_custom_repo_rules_generation-596"><span class="linenos">596</span></a><span class="sd">        report_path: Path to the AI report file, defaults to &quot;ai_report.md&quot;</span>
</span><span id="instruct_custom_repo_rules_generation-597"><a href="#instruct_custom_repo_rules_generation-597"><span class="linenos">597</span></a>
</span><span id="instruct_custom_repo_rules_generation-598"><a href="#instruct_custom_repo_rules_generation-598"><span class="linenos">598</span></a><span class="sd">    Returns:</span>
</span><span id="instruct_custom_repo_rules_generation-599"><a href="#instruct_custom_repo_rules_generation-599"><span class="linenos">599</span></a><span class="sd">        dict[str, Any]: A dictionary containing operations and instructions</span>
</span><span id="instruct_custom_repo_rules_generation-600"><a href="#instruct_custom_repo_rules_generation-600"><span class="linenos">600</span></a>
</span><span id="instruct_custom_repo_rules_generation-601"><a href="#instruct_custom_repo_rules_generation-601"><span class="linenos">601</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="instruct_custom_repo_rules_generation-602"><a href="#instruct_custom_repo_rules_generation-602"><span class="linenos">602</span></a>    <span class="c1"># Define a complete sequence of operations for the cursor rules generation workflow</span>
</span><span id="instruct_custom_repo_rules_generation-603"><a href="#instruct_custom_repo_rules_generation-603"><span class="linenos">603</span></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="instruct_custom_repo_rules_generation-604"><a href="#instruct_custom_repo_rules_generation-604"><span class="linenos">604</span></a>        <span class="c1"># Step 1: Ensure the AI report exists and read its content</span>
</span><span id="instruct_custom_repo_rules_generation-605"><a href="#instruct_custom_repo_rules_generation-605"><span class="linenos">605</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ensure_ai_report&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;report_path&quot;</span><span class="p">:</span> <span class="n">report_path</span><span class="p">}},</span>
</span><span id="instruct_custom_repo_rules_generation-606"><a href="#instruct_custom_repo_rules_generation-606"><span class="linenos">606</span></a>        <span class="c1"># Step 2: Generate recommended cursor rules based on the report content</span>
</span><span id="instruct_custom_repo_rules_generation-607"><a href="#instruct_custom_repo_rules_generation-607"><span class="linenos">607</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;recommend_cursor_rules&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;repo_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{result}</span><span class="s2">&quot;</span><span class="p">}},</span>
</span><span id="instruct_custom_repo_rules_generation-608"><a href="#instruct_custom_repo_rules_generation-608"><span class="linenos">608</span></a>        <span class="c1"># Step 3: Prepare the workspace for cursor rules</span>
</span><span id="instruct_custom_repo_rules_generation-609"><a href="#instruct_custom_repo_rules_generation-609"><span class="linenos">609</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;prep_workspace&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{}},</span>
</span><span id="instruct_custom_repo_rules_generation-610"><a href="#instruct_custom_repo_rules_generation-610"><span class="linenos">610</span></a>        <span class="c1"># Step 4: Check existing cursor rules</span>
</span><span id="instruct_custom_repo_rules_generation-611"><a href="#instruct_custom_repo_rules_generation-611"><span class="linenos">611</span></a>        <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-612"><a href="#instruct_custom_repo_rules_generation-612"><span class="linenos">612</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-613"><a href="#instruct_custom_repo_rules_generation-613"><span class="linenos">613</span></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;list_directory&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-614"><a href="#instruct_custom_repo_rules_generation-614"><span class="linenos">614</span></a>            <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;./hack/drafts/cursor_rules/&quot;</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="s2">&quot;-la&quot;</span><span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-615"><a href="#instruct_custom_repo_rules_generation-615"><span class="linenos">615</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-616"><a href="#instruct_custom_repo_rules_generation-616"><span class="linenos">616</span></a>        <span class="c1"># Step 5: Create the cursor rule files</span>
</span><span id="instruct_custom_repo_rules_generation-617"><a href="#instruct_custom_repo_rules_generation-617"><span class="linenos">617</span></a>        <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-618"><a href="#instruct_custom_repo_rules_generation-618"><span class="linenos">618</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-619"><a href="#instruct_custom_repo_rules_generation-619"><span class="linenos">619</span></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create_cursor_rule_files&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-620"><a href="#instruct_custom_repo_rules_generation-620"><span class="linenos">620</span></a>            <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;rule_names&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{result.recommended_rules}</span><span class="s2">&quot;</span><span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-621"><a href="#instruct_custom_repo_rules_generation-621"><span class="linenos">621</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-622"><a href="#instruct_custom_repo_rules_generation-622"><span class="linenos">622</span></a>        <span class="c1"># Step 6: Ensure the Makefile has the update-cursor-rules task</span>
</span><span id="instruct_custom_repo_rules_generation-623"><a href="#instruct_custom_repo_rules_generation-623"><span class="linenos">623</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ensure_makefile_task&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;makefile_path&quot;</span><span class="p">:</span> <span class="s2">&quot;Makefile&quot;</span><span class="p">}},</span>
</span><span id="instruct_custom_repo_rules_generation-624"><a href="#instruct_custom_repo_rules_generation-624"><span class="linenos">624</span></a>        <span class="c1"># Step 7: Update the .dockerignore file to exclude the cursor rules drafts directory</span>
</span><span id="instruct_custom_repo_rules_generation-625"><a href="#instruct_custom_repo_rules_generation-625"><span class="linenos">625</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke_tool&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;update_dockerignore&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{}},</span>
</span><span id="instruct_custom_repo_rules_generation-626"><a href="#instruct_custom_repo_rules_generation-626"><span class="linenos">626</span></a>    <span class="p">]</span>
</span><span id="instruct_custom_repo_rules_generation-627"><a href="#instruct_custom_repo_rules_generation-627"><span class="linenos">627</span></a>
</span><span id="instruct_custom_repo_rules_generation-628"><a href="#instruct_custom_repo_rules_generation-628"><span class="linenos">628</span></a>    <span class="c1"># Create the response dictionary with all required fields</span>
</span><span id="instruct_custom_repo_rules_generation-629"><a href="#instruct_custom_repo_rules_generation-629"><span class="linenos">629</span></a>    <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-630"><a href="#instruct_custom_repo_rules_generation-630"><span class="linenos">630</span></a>        <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-631"><a href="#instruct_custom_repo_rules_generation-631"><span class="linenos">631</span></a>        <span class="s2">&quot;requires_result&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-632"><a href="#instruct_custom_repo_rules_generation-632"><span class="linenos">632</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Instructions to generate cursor rules based on AI report&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-633"><a href="#instruct_custom_repo_rules_generation-633"><span class="linenos">633</span></a>        <span class="s2">&quot;workflow_steps&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="instruct_custom_repo_rules_generation-634"><a href="#instruct_custom_repo_rules_generation-634"><span class="linenos">634</span></a>            <span class="s2">&quot;1. Read and validate the AI report from the specified path&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-635"><a href="#instruct_custom_repo_rules_generation-635"><span class="linenos">635</span></a>            <span class="s2">&quot;2. Extract repository information and generate recommended rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-636"><a href="#instruct_custom_repo_rules_generation-636"><span class="linenos">636</span></a>            <span class="s2">&quot;3. Prepare the workspace for cursor rules creation&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-637"><a href="#instruct_custom_repo_rules_generation-637"><span class="linenos">637</span></a>            <span class="s2">&quot;4. Create the rule files in the drafts directory&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-638"><a href="#instruct_custom_repo_rules_generation-638"><span class="linenos">638</span></a>            <span class="s2">&quot;5. Ensure the Makefile contains the update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-639"><a href="#instruct_custom_repo_rules_generation-639"><span class="linenos">639</span></a>            <span class="s2">&quot;6. Update .dockerignore to exclude the drafts directory&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-640"><a href="#instruct_custom_repo_rules_generation-640"><span class="linenos">640</span></a>            <span class="s2">&quot;7. Generate rule content based on repository analysis&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-641"><a href="#instruct_custom_repo_rules_generation-641"><span class="linenos">641</span></a>            <span class="s2">&quot;8. Deploy the rules using make update-cursor-rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-642"><a href="#instruct_custom_repo_rules_generation-642"><span class="linenos">642</span></a>        <span class="p">],</span>
</span><span id="instruct_custom_repo_rules_generation-643"><a href="#instruct_custom_repo_rules_generation-643"><span class="linenos">643</span></a>        <span class="s2">&quot;output_directory&quot;</span><span class="p">:</span> <span class="s2">&quot;hack/drafts/cursor_rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-644"><a href="#instruct_custom_repo_rules_generation-644"><span class="linenos">644</span></a>        <span class="s2">&quot;rule_format&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-645"><a href="#instruct_custom_repo_rules_generation-645"><span class="linenos">645</span></a>            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;{rule-name}.mdc.md&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-646"><a href="#instruct_custom_repo_rules_generation-646"><span class="linenos">646</span></a>            <span class="s2">&quot;frontmatter&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-647"><a href="#instruct_custom_repo_rules_generation-647"><span class="linenos">647</span></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Brief description of the rule&#39;s purpose&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-648"><a href="#instruct_custom_repo_rules_generation-648"><span class="linenos">648</span></a>                <span class="s2">&quot;globs&quot;</span><span class="p">:</span> <span class="s2">&quot;File patterns the rule applies to (e.g., *.py)&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-649"><a href="#instruct_custom_repo_rules_generation-649"><span class="linenos">649</span></a>                <span class="s2">&quot;alwaysApply&quot;</span><span class="p">:</span> <span class="s2">&quot;Boolean value (typically false)&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-650"><a href="#instruct_custom_repo_rules_generation-650"><span class="linenos">650</span></a>            <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-651"><a href="#instruct_custom_repo_rules_generation-651"><span class="linenos">651</span></a>            <span class="s2">&quot;rule_structure&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-652"><a href="#instruct_custom_repo_rules_generation-652"><span class="linenos">652</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;rule-name&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-653"><a href="#instruct_custom_repo_rules_generation-653"><span class="linenos">653</span></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Detailed description of the rule&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-654"><a href="#instruct_custom_repo_rules_generation-654"><span class="linenos">654</span></a>                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="s2">&quot;Conditions for when the rule applies&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-655"><a href="#instruct_custom_repo_rules_generation-655"><span class="linenos">655</span></a>                <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="s2">&quot;Suggestions or requirements provided by the rule&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-656"><a href="#instruct_custom_repo_rules_generation-656"><span class="linenos">656</span></a>                <span class="s2">&quot;examples&quot;</span><span class="p">:</span> <span class="s2">&quot;Example inputs and outputs&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-657"><a href="#instruct_custom_repo_rules_generation-657"><span class="linenos">657</span></a>                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;Priority, version, and tags&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-658"><a href="#instruct_custom_repo_rules_generation-658"><span class="linenos">658</span></a>            <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-659"><a href="#instruct_custom_repo_rules_generation-659"><span class="linenos">659</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-660"><a href="#instruct_custom_repo_rules_generation-660"><span class="linenos">660</span></a>        <span class="s2">&quot;rule_example_template&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-661"><a href="#instruct_custom_repo_rules_generation-661"><span class="linenos">661</span></a>            <span class="s2">&quot;frontmatter&quot;</span><span class="p">:</span> <span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">description: Brief description of the rule</span><span class="se">\n</span><span class="s2">globs: *.py  # File patterns to match</span><span class="se">\n</span><span class="s2">alwaysApply: false  # Whether to always apply the rule</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-662"><a href="#instruct_custom_repo_rules_generation-662"><span class="linenos">662</span></a>            <span class="s2">&quot;title_and_introduction&quot;</span><span class="p">:</span> <span class="s2">&quot;# Rule Title</span><span class="se">\n</span><span class="s2">Brief description of what the rule covers.&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-663"><a href="#instruct_custom_repo_rules_generation-663"><span class="linenos">663</span></a>            <span class="s2">&quot;rule_definition&quot;</span><span class="p">:</span> <span class="s1">&#39;&lt;rule&gt;</span><span class="se">\n</span><span class="s1">name: rule_name</span><span class="se">\n</span><span class="s1">description: Concise description of the rule</span><span class="se">\n</span><span class="s1">filters:</span><span class="se">\n</span><span class="s1">  # Match specific file types</span><span class="se">\n</span><span class="s1">  - type: file_extension</span><span class="se">\n</span><span class="s1">    pattern: &quot;</span><span class="se">\\\\</span><span class="s1">.py$&quot;</span><span class="se">\n</span><span class="s1">  # Match specific paths</span><span class="se">\n</span><span class="s1">  - type: file_path</span><span class="se">\n</span><span class="s1">    pattern: &quot;tests?/&quot;</span><span class="se">\n</span><span class="s1">  # Match specific content</span><span class="se">\n</span><span class="s1">  - type: content</span><span class="se">\n</span><span class="s1">    pattern: &quot;(?i)(relevant|terms|to|match)&quot;</span><span class="se">\n</span><span class="s1">actions:</span><span class="se">\n</span><span class="s1">  - type: suggest</span><span class="se">\n</span><span class="s1">    message: |</span><span class="se">\n</span><span class="s1">      # Main Heading</span><span class="se">\n</span><span class="s1">      Explanation of the rule and its purpose.</span><span class="se">\n</span><span class="s1">      ## Subheading</span><span class="se">\n</span><span class="s1">      Detailed guidance with code examples:</span><span class="se">\n</span><span class="s1">      ```python</span><span class="se">\n</span><span class="s1">      # Example code</span><span class="se">\n</span><span class="s1">      def example_function():</span><span class="se">\n</span><span class="s1">          return &quot;example&quot;</span><span class="se">\n</span><span class="s1">      ```</span><span class="se">\n</span><span class="s1">      ## Another Subheading</span><span class="se">\n</span><span class="s1">      More detailed information and best practices.</span><span class="se">\n</span><span class="s1">examples:</span><span class="se">\n</span><span class="s1">  - input: |</span><span class="se">\n</span><span class="s1">      # User query example</span><span class="se">\n</span><span class="s1">      I want to do X with Y</span><span class="se">\n</span><span class="s1">    output: |</span><span class="se">\n</span><span class="s1">      Here</span><span class="se">\&#39;</span><span class="s1">s how to do X with Y:</span><span class="se">\n</span><span class="s1">      </span><span class="se">\n</span><span class="s1">      ```python</span><span class="se">\n</span><span class="s1">      # Solution code</span><span class="se">\n</span><span class="s1">      ```</span><span class="se">\n</span><span class="s1">metadata:</span><span class="se">\n</span><span class="s1">  priority: high</span><span class="se">\n</span><span class="s1">  version: 1.0</span><span class="se">\n</span><span class="s1">  tags:</span><span class="se">\n</span><span class="s1">    - relevant</span><span class="se">\n</span><span class="s1">    - tags</span><span class="se">\n</span><span class="s1">    - here</span><span class="se">\n</span><span class="s1">&lt;/rule&gt;&#39;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-664"><a href="#instruct_custom_repo_rules_generation-664"><span class="linenos">664</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-665"><a href="#instruct_custom_repo_rules_generation-665"><span class="linenos">665</span></a>        <span class="s2">&quot;key_components_explanation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-666"><a href="#instruct_custom_repo_rules_generation-666"><span class="linenos">666</span></a>            <span class="s2">&quot;frontmatter&quot;</span><span class="p">:</span> <span class="s2">&quot;YAML metadata at the top&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-667"><a href="#instruct_custom_repo_rules_generation-667"><span class="linenos">667</span></a>            <span class="s2">&quot;title_and_introduction&quot;</span><span class="p">:</span> <span class="s2">&quot;Markdown heading and description&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-668"><a href="#instruct_custom_repo_rules_generation-668"><span class="linenos">668</span></a>            <span class="s2">&quot;rule_definition&quot;</span><span class="p">:</span> <span class="s2">&quot;Enclosed in &lt;rule&gt; tags with basic properties, filters, actions, examples, and metadata&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-669"><a href="#instruct_custom_repo_rules_generation-669"><span class="linenos">669</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-670"><a href="#instruct_custom_repo_rules_generation-670"><span class="linenos">670</span></a>        <span class="s2">&quot;deployment_commands&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-671"><a href="#instruct_custom_repo_rules_generation-671"><span class="linenos">671</span></a>            <span class="s2">&quot;prepare_files&quot;</span><span class="p">:</span> <span class="s2">&quot;touch hack/drafts/cursor_rules/{rule-name}.mdc.md&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-672"><a href="#instruct_custom_repo_rules_generation-672"><span class="linenos">672</span></a>            <span class="s2">&quot;audit_files&quot;</span><span class="p">:</span> <span class="s2">&quot;head -10 hack/drafts/cursor_rules/{rule-name}.mdc.md | cat&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-673"><a href="#instruct_custom_repo_rules_generation-673"><span class="linenos">673</span></a>            <span class="s2">&quot;deploy_to_production&quot;</span><span class="p">:</span> <span class="s2">&quot;make update-cursor-rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-674"><a href="#instruct_custom_repo_rules_generation-674"><span class="linenos">674</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-675"><a href="#instruct_custom_repo_rules_generation-675"><span class="linenos">675</span></a>        <span class="s2">&quot;processing_tools&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-676"><a href="#instruct_custom_repo_rules_generation-676"><span class="linenos">676</span></a>            <span class="s2">&quot;rule_recommendation&quot;</span><span class="p">:</span> <span class="s2">&quot;recommend_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-677"><a href="#instruct_custom_repo_rules_generation-677"><span class="linenos">677</span></a>            <span class="s2">&quot;complex_reasoning&quot;</span><span class="p">:</span> <span class="s2">&quot;sequentialthinking&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-678"><a href="#instruct_custom_repo_rules_generation-678"><span class="linenos">678</span></a>            <span class="s2">&quot;file_management&quot;</span><span class="p">:</span> <span class="s2">&quot;create_cursor_rule_files&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-679"><a href="#instruct_custom_repo_rules_generation-679"><span class="linenos">679</span></a>            <span class="s2">&quot;makefile_integration&quot;</span><span class="p">:</span> <span class="s2">&quot;ensure_makefile_task&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-680"><a href="#instruct_custom_repo_rules_generation-680"><span class="linenos">680</span></a>            <span class="s2">&quot;docker_integration&quot;</span><span class="p">:</span> <span class="s2">&quot;update_dockerignore&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-681"><a href="#instruct_custom_repo_rules_generation-681"><span class="linenos">681</span></a>            <span class="s2">&quot;ai_report_validation&quot;</span><span class="p">:</span> <span class="s2">&quot;ensure_ai_report&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-682"><a href="#instruct_custom_repo_rules_generation-682"><span class="linenos">682</span></a>            <span class="s2">&quot;deploy_rules&quot;</span><span class="p">:</span> <span class="s2">&quot;run_update_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-683"><a href="#instruct_custom_repo_rules_generation-683"><span class="linenos">683</span></a>        <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-684"><a href="#instruct_custom_repo_rules_generation-684"><span class="linenos">684</span></a>        <span class="s2">&quot;final_steps&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="instruct_custom_repo_rules_generation-685"><a href="#instruct_custom_repo_rules_generation-685"><span class="linenos">685</span></a>            <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-686"><a href="#instruct_custom_repo_rules_generation-686"><span class="linenos">686</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;save_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-687"><a href="#instruct_custom_repo_rules_generation-687"><span class="linenos">687</span></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;For each rule, save the generated content to the appropriate file&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-688"><a href="#instruct_custom_repo_rules_generation-688"><span class="linenos">688</span></a>            <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-689"><a href="#instruct_custom_repo_rules_generation-689"><span class="linenos">689</span></a>            <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;run_update_cursor_rules&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Run the Makefile task to deploy rules to production&quot;</span><span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-690"><a href="#instruct_custom_repo_rules_generation-690"><span class="linenos">690</span></a>        <span class="p">],</span>
</span><span id="instruct_custom_repo_rules_generation-691"><a href="#instruct_custom_repo_rules_generation-691"><span class="linenos">691</span></a>        <span class="c1"># Add the content field that the test is expecting with all required fields</span>
</span><span id="instruct_custom_repo_rules_generation-692"><a href="#instruct_custom_repo_rules_generation-692"><span class="linenos">692</span></a>        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="instruct_custom_repo_rules_generation-693"><a href="#instruct_custom_repo_rules_generation-693"><span class="linenos">693</span></a>            <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-694"><a href="#instruct_custom_repo_rules_generation-694"><span class="linenos">694</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-695"><a href="#instruct_custom_repo_rules_generation-695"><span class="linenos">695</span></a>                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="instruct_custom_repo_rules_generation-696"><a href="#instruct_custom_repo_rules_generation-696"><span class="linenos">696</span></a>                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-697"><a href="#instruct_custom_repo_rules_generation-697"><span class="linenos">697</span></a>                    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Cursor Rules Generation Instructions&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-698"><a href="#instruct_custom_repo_rules_generation-698"><span class="linenos">698</span></a>                    <span class="s2">&quot;cursor_rules_generation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-699"><a href="#instruct_custom_repo_rules_generation-699"><span class="linenos">699</span></a>                    <span class="s2">&quot;analysis_method&quot;</span><span class="p">:</span> <span class="s2">&quot;repository_summary&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-700"><a href="#instruct_custom_repo_rules_generation-700"><span class="linenos">700</span></a>                    <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-701"><a href="#instruct_custom_repo_rules_generation-701"><span class="linenos">701</span></a>                    <span class="s2">&quot;workflow_steps&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="instruct_custom_repo_rules_generation-702"><a href="#instruct_custom_repo_rules_generation-702"><span class="linenos">702</span></a>                        <span class="s2">&quot;1. Read and validate the AI report from the specified path&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-703"><a href="#instruct_custom_repo_rules_generation-703"><span class="linenos">703</span></a>                        <span class="s2">&quot;2. Extract repository information and generate recommended rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-704"><a href="#instruct_custom_repo_rules_generation-704"><span class="linenos">704</span></a>                        <span class="s2">&quot;3. Prepare the workspace for cursor rules creation&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-705"><a href="#instruct_custom_repo_rules_generation-705"><span class="linenos">705</span></a>                        <span class="s2">&quot;4. Create the rule files in the drafts directory&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-706"><a href="#instruct_custom_repo_rules_generation-706"><span class="linenos">706</span></a>                        <span class="s2">&quot;5. Ensure the Makefile contains the update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-707"><a href="#instruct_custom_repo_rules_generation-707"><span class="linenos">707</span></a>                        <span class="s2">&quot;6. Update .dockerignore to exclude the drafts directory&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-708"><a href="#instruct_custom_repo_rules_generation-708"><span class="linenos">708</span></a>                        <span class="s2">&quot;7. Generate rule content based on repository analysis&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-709"><a href="#instruct_custom_repo_rules_generation-709"><span class="linenos">709</span></a>                        <span class="s2">&quot;8. Deploy the rules using make update-cursor-rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-710"><a href="#instruct_custom_repo_rules_generation-710"><span class="linenos">710</span></a>                    <span class="p">],</span>
</span><span id="instruct_custom_repo_rules_generation-711"><a href="#instruct_custom_repo_rules_generation-711"><span class="linenos">711</span></a>                    <span class="s2">&quot;output_directory&quot;</span><span class="p">:</span> <span class="s2">&quot;hack/drafts/cursor_rules&quot;</span><span class="p">,</span>
</span><span id="instruct_custom_repo_rules_generation-712"><a href="#instruct_custom_repo_rules_generation-712"><span class="linenos">712</span></a>                <span class="p">},</span>
</span><span id="instruct_custom_repo_rules_generation-713"><a href="#instruct_custom_repo_rules_generation-713"><span class="linenos">713</span></a>            <span class="p">}</span>
</span><span id="instruct_custom_repo_rules_generation-714"><a href="#instruct_custom_repo_rules_generation-714"><span class="linenos">714</span></a>        <span class="p">],</span>
</span><span id="instruct_custom_repo_rules_generation-715"><a href="#instruct_custom_repo_rules_generation-715"><span class="linenos">715</span></a>    <span class="p">}</span>
</span><span id="instruct_custom_repo_rules_generation-716"><a href="#instruct_custom_repo_rules_generation-716"><span class="linenos">716</span></a>
</span><span id="instruct_custom_repo_rules_generation-717"><a href="#instruct_custom_repo_rules_generation-717"><span class="linenos">717</span></a>    <span class="k">return</span> <span class="n">response</span>
</span></pre></div>


            <div class="docstring"><p>Run a cursor rules generation process based on repository analysis.</p>

<p>This function first checks for the existence of an AI report file,
then uses its content to generate cursor rules for the repository.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>report_path:</strong>  Path to the AI report file, defaults to "ai_report.md"</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing operations and instructions</p>
</blockquote>
</div>


                </section>
                <section id="get_static_cursor_rule">
                            <input id="get_static_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;get_static_cursor_rule&#39;, description=&#34;Get a static cursor rule file by name to be written to the caller&#39;s .cursor/rules directory&#34;)</div>

        <span class="def">def</span>
        <span class="name">get_static_cursor_rule</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Name of the cursor rule to retrieve (with or without .md extension)&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python-best-practices&#39;</span><span class="p">,</span> <span class="s1">&#39;react-patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;error-handling&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">MinLen</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="get_static_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_static_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_static_cursor_rule-720"><a href="#get_static_cursor_rule-720"><span class="linenos">720</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="get_static_cursor_rule-721"><a href="#get_static_cursor_rule-721"><span class="linenos">721</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;get_static_cursor_rule&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rule-722"><a href="#get_static_cursor_rule-722"><span class="linenos">722</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get a static cursor rule file by name to be written to the caller&#39;s .cursor/rules directory&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rule-723"><a href="#get_static_cursor_rule-723"><span class="linenos">723</span></a><span class="p">)</span>
</span><span id="get_static_cursor_rule-724"><a href="#get_static_cursor_rule-724"><span class="linenos">724</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_static_cursor_rule</span><span class="p">(</span>
</span><span id="get_static_cursor_rule-725"><a href="#get_static_cursor_rule-725"><span class="linenos">725</span></a>    <span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="get_static_cursor_rule-726"><a href="#get_static_cursor_rule-726"><span class="linenos">726</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Name of the cursor rule to retrieve (with or without .md extension)&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rule-727"><a href="#get_static_cursor_rule-727"><span class="linenos">727</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-patterns&quot;</span><span class="p">,</span> <span class="s2">&quot;error-handling&quot;</span><span class="p">],</span>
</span><span id="get_static_cursor_rule-728"><a href="#get_static_cursor_rule-728"><span class="linenos">728</span></a>        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="get_static_cursor_rule-729"><a href="#get_static_cursor_rule-729"><span class="linenos">729</span></a>    <span class="p">),</span>
</span><span id="get_static_cursor_rule-730"><a href="#get_static_cursor_rule-730"><span class="linenos">730</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
</span><span id="get_static_cursor_rule-731"><a href="#get_static_cursor_rule-731"><span class="linenos">731</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a static cursor rule file by name.</span>
</span><span id="get_static_cursor_rule-732"><a href="#get_static_cursor_rule-732"><span class="linenos">732</span></a>
</span><span id="get_static_cursor_rule-733"><a href="#get_static_cursor_rule-733"><span class="linenos">733</span></a><span class="sd">    This tool returns the content of a specific cursor rule file so it can be</span>
</span><span id="get_static_cursor_rule-734"><a href="#get_static_cursor_rule-734"><span class="linenos">734</span></a><span class="sd">    written to the calling repository&#39;s .cursor/rules directory.</span>
</span><span id="get_static_cursor_rule-735"><a href="#get_static_cursor_rule-735"><span class="linenos">735</span></a>
</span><span id="get_static_cursor_rule-736"><a href="#get_static_cursor_rule-736"><span class="linenos">736</span></a><span class="sd">    Args:</span>
</span><span id="get_static_cursor_rule-737"><a href="#get_static_cursor_rule-737"><span class="linenos">737</span></a><span class="sd">        rule_name: Name of the cursor rule to retrieve (with or without .md extension).</span>
</span><span id="get_static_cursor_rule-738"><a href="#get_static_cursor_rule-738"><span class="linenos">738</span></a><span class="sd">            Must be at least 1 character long.</span>
</span><span id="get_static_cursor_rule-739"><a href="#get_static_cursor_rule-739"><span class="linenos">739</span></a>
</span><span id="get_static_cursor_rule-740"><a href="#get_static_cursor_rule-740"><span class="linenos">740</span></a><span class="sd">    Returns:</span>
</span><span id="get_static_cursor_rule-741"><a href="#get_static_cursor_rule-741"><span class="linenos">741</span></a><span class="sd">        dict[str, Union[str, bool, list[dict[str, str]]]]: A dictionary containing either:</span>
</span><span id="get_static_cursor_rule-742"><a href="#get_static_cursor_rule-742"><span class="linenos">742</span></a><span class="sd">            - On success: {&quot;rule_name&quot;: str, &quot;content&quot;: str}</span>
</span><span id="get_static_cursor_rule-743"><a href="#get_static_cursor_rule-743"><span class="linenos">743</span></a><span class="sd">            - On error: {&quot;isError&quot;: bool, &quot;content&quot;: list[dict[str, str]]}</span>
</span><span id="get_static_cursor_rule-744"><a href="#get_static_cursor_rule-744"><span class="linenos">744</span></a>
</span><span id="get_static_cursor_rule-745"><a href="#get_static_cursor_rule-745"><span class="linenos">745</span></a><span class="sd">    Raises:</span>
</span><span id="get_static_cursor_rule-746"><a href="#get_static_cursor_rule-746"><span class="linenos">746</span></a><span class="sd">        No exceptions are raised; errors are returned in the result object.</span>
</span><span id="get_static_cursor_rule-747"><a href="#get_static_cursor_rule-747"><span class="linenos">747</span></a>
</span><span id="get_static_cursor_rule-748"><a href="#get_static_cursor_rule-748"><span class="linenos">748</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_static_cursor_rule-749"><a href="#get_static_cursor_rule-749"><span class="linenos">749</span></a>    <span class="c1"># Add .md extension if not already present</span>
</span><span id="get_static_cursor_rule-750"><a href="#get_static_cursor_rule-750"><span class="linenos">750</span></a>    <span class="n">full_rule_name</span> <span class="o">=</span> <span class="n">rule_name</span> <span class="k">if</span> <span class="n">rule_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;mdc.md&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md&quot;</span>
</span><span id="get_static_cursor_rule-751"><a href="#get_static_cursor_rule-751"><span class="linenos">751</span></a>    <span class="c1"># logger.debug(f&quot;full_rule_name: {full_rule_name}&quot;)</span>
</span><span id="get_static_cursor_rule-752"><a href="#get_static_cursor_rule-752"><span class="linenos">752</span></a>
</span><span id="get_static_cursor_rule-753"><a href="#get_static_cursor_rule-753"><span class="linenos">753</span></a>    <span class="n">content</span> <span class="o">=</span> <span class="n">read_cursor_rule</span><span class="p">(</span><span class="n">rule_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.md&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="get_static_cursor_rule-754"><a href="#get_static_cursor_rule-754"><span class="linenos">754</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
</span><span id="get_static_cursor_rule-755"><a href="#get_static_cursor_rule-755"><span class="linenos">755</span></a>        <span class="c1"># Return an error result object instead of raising an exception</span>
</span><span id="get_static_cursor_rule-756"><a href="#get_static_cursor_rule-756"><span class="linenos">756</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="get_static_cursor_rule-757"><a href="#get_static_cursor_rule-757"><span class="linenos">757</span></a>            <span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="get_static_cursor_rule-758"><a href="#get_static_cursor_rule-758"><span class="linenos">758</span></a>            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: Static cursor rule &#39;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">}],</span>
</span><span id="get_static_cursor_rule-759"><a href="#get_static_cursor_rule-759"><span class="linenos">759</span></a>        <span class="p">}</span>
</span><span id="get_static_cursor_rule-760"><a href="#get_static_cursor_rule-760"><span class="linenos">760</span></a>
</span><span id="get_static_cursor_rule-761"><a href="#get_static_cursor_rule-761"><span class="linenos">761</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rule_name&quot;</span><span class="p">:</span> <span class="n">full_rule_name</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get a static cursor rule file by name.</p>

<p>This tool returns the content of a specific cursor rule file so it can be
written to the calling repository's .cursor/rules directory.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_name:</strong>  Name of the cursor rule to retrieve (with or without .md extension).
Must be at least 1 character long.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Union[str, bool, list[dict[str, str]]]]: A dictionary containing either:
      - On success: {"rule_name": str, "content": str}
      - On error: {"isError": bool, "content": list[dict[str, str]]}</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No exceptions are raised; errors are returned in the result object.</li>
</ul>
</div>


                </section>
                <section id="get_static_cursor_rules">
                            <input id="get_static_cursor_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;get_static_cursor_rules&#39;, description=&#34;Get multiple static cursor rule files to be written to the caller&#39;s .cursor/rules directory&#34;)</div>

        <span class="def">def</span>
        <span class="name">get_static_cursor_rules</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;List of cursor rule names to retrieve (with or without .md extension)&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;python-best-practices&#39;</span><span class="p">,</span> <span class="s1">&#39;react-patterns&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;error-handling&#39;</span><span class="p">]],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">MinLen</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>,</span><span class="param">	<span class="n">ignore_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;If True, missing rules will be skipped instead of returning errors&#39;</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]]</span>:</span></span>

                <label class="view-source-button" for="get_static_cursor_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_static_cursor_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_static_cursor_rules-764"><a href="#get_static_cursor_rules-764"><span class="linenos">764</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="get_static_cursor_rules-765"><a href="#get_static_cursor_rules-765"><span class="linenos">765</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;get_static_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-766"><a href="#get_static_cursor_rules-766"><span class="linenos">766</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Get multiple static cursor rule files to be written to the caller&#39;s .cursor/rules directory&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-767"><a href="#get_static_cursor_rules-767"><span class="linenos">767</span></a><span class="p">)</span>
</span><span id="get_static_cursor_rules-768"><a href="#get_static_cursor_rules-768"><span class="linenos">768</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_static_cursor_rules</span><span class="p">(</span>
</span><span id="get_static_cursor_rules-769"><a href="#get_static_cursor_rules-769"><span class="linenos">769</span></a>    <span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="get_static_cursor_rules-770"><a href="#get_static_cursor_rules-770"><span class="linenos">770</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of cursor rule names to retrieve (with or without .md extension)&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-771"><a href="#get_static_cursor_rules-771"><span class="linenos">771</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-patterns&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;error-handling&quot;</span><span class="p">]],</span>
</span><span id="get_static_cursor_rules-772"><a href="#get_static_cursor_rules-772"><span class="linenos">772</span></a>        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-773"><a href="#get_static_cursor_rules-773"><span class="linenos">773</span></a>    <span class="p">),</span>
</span><span id="get_static_cursor_rules-774"><a href="#get_static_cursor_rules-774"><span class="linenos">774</span></a>    <span class="n">ignore_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="get_static_cursor_rules-775"><a href="#get_static_cursor_rules-775"><span class="linenos">775</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;If True, missing rules will be skipped instead of returning errors&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-776"><a href="#get_static_cursor_rules-776"><span class="linenos">776</span></a>        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-777"><a href="#get_static_cursor_rules-777"><span class="linenos">777</span></a>    <span class="p">),</span>
</span><span id="get_static_cursor_rules-778"><a href="#get_static_cursor_rules-778"><span class="linenos">778</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]]:</span>
</span><span id="get_static_cursor_rules-779"><a href="#get_static_cursor_rules-779"><span class="linenos">779</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get multiple static cursor rule files by name.</span>
</span><span id="get_static_cursor_rules-780"><a href="#get_static_cursor_rules-780"><span class="linenos">780</span></a>
</span><span id="get_static_cursor_rules-781"><a href="#get_static_cursor_rules-781"><span class="linenos">781</span></a><span class="sd">    This tool returns the content of specific cursor rule files so they can be</span>
</span><span id="get_static_cursor_rules-782"><a href="#get_static_cursor_rules-782"><span class="linenos">782</span></a><span class="sd">    written to the calling repository&#39;s .cursor/rules directory.</span>
</span><span id="get_static_cursor_rules-783"><a href="#get_static_cursor_rules-783"><span class="linenos">783</span></a>
</span><span id="get_static_cursor_rules-784"><a href="#get_static_cursor_rules-784"><span class="linenos">784</span></a><span class="sd">    Args:</span>
</span><span id="get_static_cursor_rules-785"><a href="#get_static_cursor_rules-785"><span class="linenos">785</span></a><span class="sd">        rule_names: List of cursor rule names to retrieve (with or without .md extension)</span>
</span><span id="get_static_cursor_rules-786"><a href="#get_static_cursor_rules-786"><span class="linenos">786</span></a><span class="sd">        ignore_missing: If True, missing rules will be skipped instead of returning errors</span>
</span><span id="get_static_cursor_rules-787"><a href="#get_static_cursor_rules-787"><span class="linenos">787</span></a>
</span><span id="get_static_cursor_rules-788"><a href="#get_static_cursor_rules-788"><span class="linenos">788</span></a><span class="sd">    Returns:</span>
</span><span id="get_static_cursor_rules-789"><a href="#get_static_cursor_rules-789"><span class="linenos">789</span></a><span class="sd">        dict[str, list[dict[str, Union[str, bool, list[dict[str, str]]]]]]: A dictionary containing:</span>
</span><span id="get_static_cursor_rules-790"><a href="#get_static_cursor_rules-790"><span class="linenos">790</span></a><span class="sd">            - &quot;rules&quot;: A list of rule data objects, each with either:</span>
</span><span id="get_static_cursor_rules-791"><a href="#get_static_cursor_rules-791"><span class="linenos">791</span></a><span class="sd">                - On success: {&quot;rule_name&quot;: str, &quot;content&quot;: str}</span>
</span><span id="get_static_cursor_rules-792"><a href="#get_static_cursor_rules-792"><span class="linenos">792</span></a><span class="sd">                - On error: {&quot;isError&quot;: bool, &quot;content&quot;: list[dict[str, str]]}</span>
</span><span id="get_static_cursor_rules-793"><a href="#get_static_cursor_rules-793"><span class="linenos">793</span></a>
</span><span id="get_static_cursor_rules-794"><a href="#get_static_cursor_rules-794"><span class="linenos">794</span></a><span class="sd">    Raises:</span>
</span><span id="get_static_cursor_rules-795"><a href="#get_static_cursor_rules-795"><span class="linenos">795</span></a><span class="sd">        No exceptions are raised; errors are returned in the result objects.</span>
</span><span id="get_static_cursor_rules-796"><a href="#get_static_cursor_rules-796"><span class="linenos">796</span></a>
</span><span id="get_static_cursor_rules-797"><a href="#get_static_cursor_rules-797"><span class="linenos">797</span></a><span class="sd">    Examples:</span>
</span><span id="get_static_cursor_rules-798"><a href="#get_static_cursor_rules-798"><span class="linenos">798</span></a><span class="sd">        &gt;&gt;&gt; result = get_static_cursor_rules([&quot;python-best-practices&quot;, &quot;react-patterns&quot;])</span>
</span><span id="get_static_cursor_rules-799"><a href="#get_static_cursor_rules-799"><span class="linenos">799</span></a><span class="sd">        &gt;&gt;&gt; print(len(result[&quot;rules&quot;]))</span>
</span><span id="get_static_cursor_rules-800"><a href="#get_static_cursor_rules-800"><span class="linenos">800</span></a><span class="sd">        2</span>
</span><span id="get_static_cursor_rules-801"><a href="#get_static_cursor_rules-801"><span class="linenos">801</span></a><span class="sd">        &gt;&gt;&gt; # With ignore_missing=True</span>
</span><span id="get_static_cursor_rules-802"><a href="#get_static_cursor_rules-802"><span class="linenos">802</span></a><span class="sd">        &gt;&gt;&gt; result = get_static_cursor_rules([&quot;existing-rule&quot;, &quot;non-existent-rule&quot;], ignore_missing=True)</span>
</span><span id="get_static_cursor_rules-803"><a href="#get_static_cursor_rules-803"><span class="linenos">803</span></a><span class="sd">        &gt;&gt;&gt; # Only includes the existing rule</span>
</span><span id="get_static_cursor_rules-804"><a href="#get_static_cursor_rules-804"><span class="linenos">804</span></a>
</span><span id="get_static_cursor_rules-805"><a href="#get_static_cursor_rules-805"><span class="linenos">805</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_static_cursor_rules-806"><a href="#get_static_cursor_rules-806"><span class="linenos">806</span></a>    <span class="c1"># Validate input</span>
</span><span id="get_static_cursor_rules-807"><a href="#get_static_cursor_rules-807"><span class="linenos">807</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_names</span><span class="p">:</span>
</span><span id="get_static_cursor_rules-808"><a href="#get_static_cursor_rules-808"><span class="linenos">808</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="get_static_cursor_rules-809"><a href="#get_static_cursor_rules-809"><span class="linenos">809</span></a>            <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Error: Empty rule_names list provided&quot;</span><span class="p">}]}]</span>
</span><span id="get_static_cursor_rules-810"><a href="#get_static_cursor_rules-810"><span class="linenos">810</span></a>        <span class="p">}</span>
</span><span id="get_static_cursor_rules-811"><a href="#get_static_cursor_rules-811"><span class="linenos">811</span></a>
</span><span id="get_static_cursor_rules-812"><a href="#get_static_cursor_rules-812"><span class="linenos">812</span></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_static_cursor_rules-813"><a href="#get_static_cursor_rules-813"><span class="linenos">813</span></a>    <span class="n">valid_rule_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="get_static_cursor_rules-814"><a href="#get_static_cursor_rules-814"><span class="linenos">814</span></a>
</span><span id="get_static_cursor_rules-815"><a href="#get_static_cursor_rules-815"><span class="linenos">815</span></a>    <span class="k">for</span> <span class="n">rule_name</span> <span class="ow">in</span> <span class="n">rule_names</span><span class="p">:</span>
</span><span id="get_static_cursor_rules-816"><a href="#get_static_cursor_rules-816"><span class="linenos">816</span></a>        <span class="c1"># Basic validation of rule name format</span>
</span><span id="get_static_cursor_rules-817"><a href="#get_static_cursor_rules-817"><span class="linenos">817</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="get_static_cursor_rules-818"><a href="#get_static_cursor_rules-818"><span class="linenos">818</span></a>            <span class="n">error_result</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="get_static_cursor_rules-819"><a href="#get_static_cursor_rules-819"><span class="linenos">819</span></a>                <span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-820"><a href="#get_static_cursor_rules-820"><span class="linenos">820</span></a>                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: Invalid rule name format: </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
</span><span id="get_static_cursor_rules-821"><a href="#get_static_cursor_rules-821"><span class="linenos">821</span></a>            <span class="p">}</span>
</span><span id="get_static_cursor_rules-822"><a href="#get_static_cursor_rules-822"><span class="linenos">822</span></a>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_result</span><span class="p">)</span>
</span><span id="get_static_cursor_rules-823"><a href="#get_static_cursor_rules-823"><span class="linenos">823</span></a>            <span class="k">continue</span>
</span><span id="get_static_cursor_rules-824"><a href="#get_static_cursor_rules-824"><span class="linenos">824</span></a>
</span><span id="get_static_cursor_rules-825"><a href="#get_static_cursor_rules-825"><span class="linenos">825</span></a>        <span class="c1"># Get the rule data using get_static_cursor_rule</span>
</span><span id="get_static_cursor_rules-826"><a href="#get_static_cursor_rules-826"><span class="linenos">826</span></a>        <span class="n">rule_data</span> <span class="o">=</span> <span class="n">get_static_cursor_rule</span><span class="p">(</span><span class="n">rule_name</span><span class="p">)</span>
</span><span id="get_static_cursor_rules-827"><a href="#get_static_cursor_rules-827"><span class="linenos">827</span></a>
</span><span id="get_static_cursor_rules-828"><a href="#get_static_cursor_rules-828"><span class="linenos">828</span></a>        <span class="c1"># logger.debug(f&quot;rule_data: {rule_data}&quot;)</span>
</span><span id="get_static_cursor_rules-829"><a href="#get_static_cursor_rules-829"><span class="linenos">829</span></a>
</span><span id="get_static_cursor_rules-830"><a href="#get_static_cursor_rules-830"><span class="linenos">830</span></a>        <span class="c1"># Check if the rule was found</span>
</span><span id="get_static_cursor_rules-831"><a href="#get_static_cursor_rules-831"><span class="linenos">831</span></a>        <span class="k">if</span> <span class="n">rule_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;isError&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ignore_missing</span><span class="p">:</span>
</span><span id="get_static_cursor_rules-832"><a href="#get_static_cursor_rules-832"><span class="linenos">832</span></a>            <span class="c1"># Skip adding this rule to results if ignore_missing is True</span>
</span><span id="get_static_cursor_rules-833"><a href="#get_static_cursor_rules-833"><span class="linenos">833</span></a>            <span class="k">continue</span>
</span><span id="get_static_cursor_rules-834"><a href="#get_static_cursor_rules-834"><span class="linenos">834</span></a>
</span><span id="get_static_cursor_rules-835"><a href="#get_static_cursor_rules-835"><span class="linenos">835</span></a>        <span class="c1"># Add the result to our list</span>
</span><span id="get_static_cursor_rules-836"><a href="#get_static_cursor_rules-836"><span class="linenos">836</span></a>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule_data</span><span class="p">)</span>
</span><span id="get_static_cursor_rules-837"><a href="#get_static_cursor_rules-837"><span class="linenos">837</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;isError&quot;</span><span class="p">):</span>
</span><span id="get_static_cursor_rules-838"><a href="#get_static_cursor_rules-838"><span class="linenos">838</span></a>            <span class="n">valid_rule_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="get_static_cursor_rules-839"><a href="#get_static_cursor_rules-839"><span class="linenos">839</span></a>
</span><span id="get_static_cursor_rules-840"><a href="#get_static_cursor_rules-840"><span class="linenos">840</span></a>    <span class="c1"># If all rules were missing and ignore_missing is True, provide a helpful message</span>
</span><span id="get_static_cursor_rules-841"><a href="#get_static_cursor_rules-841"><span class="linenos">841</span></a>    <span class="k">if</span> <span class="n">ignore_missing</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="get_static_cursor_rules-842"><a href="#get_static_cursor_rules-842"><span class="linenos">842</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="get_static_cursor_rules-843"><a href="#get_static_cursor_rules-843"><span class="linenos">843</span></a>            <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="get_static_cursor_rules-844"><a href="#get_static_cursor_rules-844"><span class="linenos">844</span></a>                <span class="p">{</span>
</span><span id="get_static_cursor_rules-845"><a href="#get_static_cursor_rules-845"><span class="linenos">845</span></a>                    <span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-846"><a href="#get_static_cursor_rules-846"><span class="linenos">846</span></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="get_static_cursor_rules-847"><a href="#get_static_cursor_rules-847"><span class="linenos">847</span></a>                        <span class="p">{</span>
</span><span id="get_static_cursor_rules-848"><a href="#get_static_cursor_rules-848"><span class="linenos">848</span></a>                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-849"><a href="#get_static_cursor_rules-849"><span class="linenos">849</span></a>                            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: None of the requested rules (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rule_names</span><span class="p">)</span><span class="si">}</span><span class="s2">) were found&quot;</span><span class="p">,</span>
</span><span id="get_static_cursor_rules-850"><a href="#get_static_cursor_rules-850"><span class="linenos">850</span></a>                        <span class="p">}</span>
</span><span id="get_static_cursor_rules-851"><a href="#get_static_cursor_rules-851"><span class="linenos">851</span></a>                    <span class="p">],</span>
</span><span id="get_static_cursor_rules-852"><a href="#get_static_cursor_rules-852"><span class="linenos">852</span></a>                <span class="p">}</span>
</span><span id="get_static_cursor_rules-853"><a href="#get_static_cursor_rules-853"><span class="linenos">853</span></a>            <span class="p">]</span>
</span><span id="get_static_cursor_rules-854"><a href="#get_static_cursor_rules-854"><span class="linenos">854</span></a>        <span class="p">}</span>
</span><span id="get_static_cursor_rules-855"><a href="#get_static_cursor_rules-855"><span class="linenos">855</span></a>
</span><span id="get_static_cursor_rules-856"><a href="#get_static_cursor_rules-856"><span class="linenos">856</span></a>    <span class="c1"># Return a single JSON object with the results array and metadata</span>
</span><span id="get_static_cursor_rules-857"><a href="#get_static_cursor_rules-857"><span class="linenos">857</span></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">,</span> <span class="s2">&quot;valid_rule_count&quot;</span><span class="p">:</span> <span class="n">valid_rule_count</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Get multiple static cursor rule files by name.</p>

<p>This tool returns the content of specific cursor rule files so they can be
written to the calling repository's .cursor/rules directory.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_names:</strong>  List of cursor rule names to retrieve (with or without .md extension)</li>
<li><strong>ignore_missing:</strong>  If True, missing rules will be skipped instead of returning errors</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, list[dict[str, Union[str, bool, list[dict[str, str]]]]]]: A dictionary containing:
      - "rules": A list of rule data objects, each with either:
          - On success: {"rule_name": str, "content": str}
          - On error: {"isError": bool, "content": list[dict[str, str]]}</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No exceptions are raised; errors are returned in the result objects.</li>
</ul>

<h6 id="examples">Examples:</h6>

<blockquote>
  <div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_static_cursor_rules</span><span class="p">([</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-patterns&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]))</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With ignore_missing=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_static_cursor_rules</span><span class="p">([</span><span class="s2">&quot;existing-rule&quot;</span><span class="p">,</span> <span class="s2">&quot;non-existent-rule&quot;</span><span class="p">],</span> <span class="n">ignore_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Only includes the existing rule</span>
</code></pre>
  </div>
</blockquote>
</div>


                </section>
                <section id="save_cursor_rule">
                            <input id="save_cursor_rule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;save_cursor_rule&#39;, description=&#39;Save a cursor rule to the cursor rules directory in the project&#39;)</div>

        <span class="def">def</span>
        <span class="name">save_cursor_rule</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;The name of the cursor rule file (without extension)&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python-best-practices&#39;</span><span class="p">,</span> <span class="s1">&#39;react-component-patterns&#39;</span><span class="p">,</span> <span class="s1">&#39;error-handling&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">MinLen</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;^[a-z0-9-]+$&#39;</span><span class="p">)])</span>,</span><span class="param">	<span class="n">rule_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;The complete content of the cursor rule in mdc.md format&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">description: Rule description</span><span class="se">\n</span><span class="s1">globs: *.py</span><span class="se">\n</span><span class="s1">alwaysApply: false</span><span class="se">\n</span><span class="s1">---</span><span class="se">\n</span><span class="s1"># Python Best Practices</span><span class="se">\n\n</span><span class="s1">When writing Python code, follow these guidelines:</span><span class="se">\n\n</span><span class="s1">&lt;rule&gt;</span><span class="se">\n</span><span class="s1">name: python-best-practices</span><span class="se">\n</span><span class="s1">description: Best practices for Python development</span><span class="se">\n</span><span class="s1">filters:</span><span class="se">\n</span><span class="s1">  - type: file_extension</span><span class="se">\n</span><span class="s1">    pattern: &quot;</span><span class="se">\\</span><span class="s1">.py$&quot;</span><span class="se">\n</span><span class="s1">actions:</span><span class="se">\n</span><span class="s1">  - type: suggest</span><span class="se">\n</span><span class="s1">    message: |</span><span class="se">\n</span><span class="s1">      Follow these guidelines:</span><span class="se">\n</span><span class="s1">      1. Use type hints</span><span class="se">\n</span><span class="s1">      2. Write docstrings</span><span class="se">\n</span><span class="s1">      3. Follow PEP 8</span><span class="se">\n</span><span class="s1">&lt;/rule&gt;&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">MinLen</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)])</span>,</span><span class="param">	<span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Whether to overwrite the file if it already exists&#39;</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="save_cursor_rule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_cursor_rule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_cursor_rule-992"><a href="#save_cursor_rule-992"><span class="linenos"> 992</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;save_cursor_rule&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Save a cursor rule to the cursor rules directory in the project&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-993"><a href="#save_cursor_rule-993"><span class="linenos"> 993</span></a><span class="k">def</span><span class="w"> </span><span class="nf">save_cursor_rule</span><span class="p">(</span>
</span><span id="save_cursor_rule-994"><a href="#save_cursor_rule-994"><span class="linenos"> 994</span></a>    <span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="save_cursor_rule-995"><a href="#save_cursor_rule-995"><span class="linenos"> 995</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The name of the cursor rule file (without extension)&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-996"><a href="#save_cursor_rule-996"><span class="linenos"> 996</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-component-patterns&quot;</span><span class="p">,</span> <span class="s2">&quot;error-handling&quot;</span><span class="p">],</span>
</span><span id="save_cursor_rule-997"><a href="#save_cursor_rule-997"><span class="linenos"> 997</span></a>        <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="save_cursor_rule-998"><a href="#save_cursor_rule-998"><span class="linenos"> 998</span></a>        <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^[a-z0-9-]+$&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-999"><a href="#save_cursor_rule-999"><span class="linenos"> 999</span></a>    <span class="p">),</span>
</span><span id="save_cursor_rule-1000"><a href="#save_cursor_rule-1000"><span class="linenos">1000</span></a>    <span class="n">rule_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="save_cursor_rule-1001"><a href="#save_cursor_rule-1001"><span class="linenos">1001</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The complete content of the cursor rule in mdc.md format&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1002"><a href="#save_cursor_rule-1002"><span class="linenos">1002</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span>
</span><span id="save_cursor_rule-1003"><a href="#save_cursor_rule-1003"><span class="linenos">1003</span></a>            <span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">description: Rule description</span><span class="se">\n</span><span class="s1">globs: *.py</span><span class="se">\n</span><span class="s1">alwaysApply: false</span><span class="se">\n</span><span class="s1">---</span><span class="se">\n</span><span class="s1"># Python Best Practices</span><span class="se">\n\n</span><span class="s1">When writing Python code, follow these guidelines:</span><span class="se">\n\n</span><span class="s1">&lt;rule&gt;</span><span class="se">\n</span><span class="s1">name: python-best-practices</span><span class="se">\n</span><span class="s1">description: Best practices for Python development</span><span class="se">\n</span><span class="s1">filters:</span><span class="se">\n</span><span class="s1">  - type: file_extension</span><span class="se">\n</span><span class="s1">    pattern: &quot;</span><span class="se">\\</span><span class="s1">.py$&quot;</span><span class="se">\n</span><span class="s1">actions:</span><span class="se">\n</span><span class="s1">  - type: suggest</span><span class="se">\n</span><span class="s1">    message: |</span><span class="se">\n</span><span class="s1">      Follow these guidelines:</span><span class="se">\n</span><span class="s1">      1. Use type hints</span><span class="se">\n</span><span class="s1">      2. Write docstrings</span><span class="se">\n</span><span class="s1">      3. Follow PEP 8</span><span class="se">\n</span><span class="s1">&lt;/rule&gt;&#39;</span>
</span><span id="save_cursor_rule-1004"><a href="#save_cursor_rule-1004"><span class="linenos">1004</span></a>        <span class="p">],</span>
</span><span id="save_cursor_rule-1005"><a href="#save_cursor_rule-1005"><span class="linenos">1005</span></a>        <span class="n">min_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="save_cursor_rule-1006"><a href="#save_cursor_rule-1006"><span class="linenos">1006</span></a>    <span class="p">),</span>
</span><span id="save_cursor_rule-1007"><a href="#save_cursor_rule-1007"><span class="linenos">1007</span></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="save_cursor_rule-1008"><a href="#save_cursor_rule-1008"><span class="linenos">1008</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to overwrite the file if it already exists&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1009"><a href="#save_cursor_rule-1009"><span class="linenos">1009</span></a>        <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="save_cursor_rule-1010"><a href="#save_cursor_rule-1010"><span class="linenos">1010</span></a>    <span class="p">),</span>
</span><span id="save_cursor_rule-1011"><a href="#save_cursor_rule-1011"><span class="linenos">1011</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1012"><a href="#save_cursor_rule-1012"><span class="linenos">1012</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Save a cursor rule to the cursor rules directory.</span>
</span><span id="save_cursor_rule-1013"><a href="#save_cursor_rule-1013"><span class="linenos">1013</span></a>
</span><span id="save_cursor_rule-1014"><a href="#save_cursor_rule-1014"><span class="linenos">1014</span></a><span class="sd">    This tool writes a cursor rule to the designated draft directory for cursor rules in the project.</span>
</span><span id="save_cursor_rule-1015"><a href="#save_cursor_rule-1015"><span class="linenos">1015</span></a><span class="sd">    It performs comprehensive validation of the rule name and content before creating the necessary directory</span>
</span><span id="save_cursor_rule-1016"><a href="#save_cursor_rule-1016"><span class="linenos">1016</span></a><span class="sd">    structure and writing the file. The function returns a dictionary with file operation</span>
</span><span id="save_cursor_rule-1017"><a href="#save_cursor_rule-1017"><span class="linenos">1017</span></a><span class="sd">    instructions for the client to execute.</span>
</span><span id="save_cursor_rule-1018"><a href="#save_cursor_rule-1018"><span class="linenos">1018</span></a>
</span><span id="save_cursor_rule-1019"><a href="#save_cursor_rule-1019"><span class="linenos">1019</span></a><span class="sd">    The cursor rule format should follow this structure:</span>
</span><span id="save_cursor_rule-1020"><a href="#save_cursor_rule-1020"><span class="linenos">1020</span></a><span class="sd">    1. Optional YAML frontmatter with metadata inside triple-dash delimiters (---)</span>
</span><span id="save_cursor_rule-1021"><a href="#save_cursor_rule-1021"><span class="linenos">1021</span></a><span class="sd">       - description: Brief description of the rule&#39;s purpose</span>
</span><span id="save_cursor_rule-1022"><a href="#save_cursor_rule-1022"><span class="linenos">1022</span></a><span class="sd">       - globs: File patterns the rule applies to (e.g., *.py)</span>
</span><span id="save_cursor_rule-1023"><a href="#save_cursor_rule-1023"><span class="linenos">1023</span></a><span class="sd">       - alwaysApply: Boolean value (typically false)</span>
</span><span id="save_cursor_rule-1024"><a href="#save_cursor_rule-1024"><span class="linenos">1024</span></a><span class="sd">    2. A markdown title and introduction</span>
</span><span id="save_cursor_rule-1025"><a href="#save_cursor_rule-1025"><span class="linenos">1025</span></a><span class="sd">    3. A &lt;rule&gt;...&lt;/rule&gt; block containing:</span>
</span><span id="save_cursor_rule-1026"><a href="#save_cursor_rule-1026"><span class="linenos">1026</span></a><span class="sd">       - name: The rule identifier (should match the filename)</span>
</span><span id="save_cursor_rule-1027"><a href="#save_cursor_rule-1027"><span class="linenos">1027</span></a><span class="sd">       - description: Brief explanation of the rule</span>
</span><span id="save_cursor_rule-1028"><a href="#save_cursor_rule-1028"><span class="linenos">1028</span></a><span class="sd">       - filters: Conditions for when the rule applies</span>
</span><span id="save_cursor_rule-1029"><a href="#save_cursor_rule-1029"><span class="linenos">1029</span></a><span class="sd">       - actions: Guidance provided when the rule matches</span>
</span><span id="save_cursor_rule-1030"><a href="#save_cursor_rule-1030"><span class="linenos">1030</span></a><span class="sd">       - examples: Sample inputs and outputs</span>
</span><span id="save_cursor_rule-1031"><a href="#save_cursor_rule-1031"><span class="linenos">1031</span></a><span class="sd">       - metadata: Priority, version, and tags</span>
</span><span id="save_cursor_rule-1032"><a href="#save_cursor_rule-1032"><span class="linenos">1032</span></a>
</span><span id="save_cursor_rule-1033"><a href="#save_cursor_rule-1033"><span class="linenos">1033</span></a><span class="sd">    Args:</span>
</span><span id="save_cursor_rule-1034"><a href="#save_cursor_rule-1034"><span class="linenos">1034</span></a><span class="sd">        rule_name: The name of the cursor rule file (without extension).</span>
</span><span id="save_cursor_rule-1035"><a href="#save_cursor_rule-1035"><span class="linenos">1035</span></a><span class="sd">                   Must be lowercase with hyphens (no spaces) and at least 3 characters.</span>
</span><span id="save_cursor_rule-1036"><a href="#save_cursor_rule-1036"><span class="linenos">1036</span></a><span class="sd">        rule_content: The complete content of the cursor rule in mdc.md format.</span>
</span><span id="save_cursor_rule-1037"><a href="#save_cursor_rule-1037"><span class="linenos">1037</span></a><span class="sd">                      Should contain valid markdown and be at least 10 characters long.</span>
</span><span id="save_cursor_rule-1038"><a href="#save_cursor_rule-1038"><span class="linenos">1038</span></a><span class="sd">        overwrite: Whether to overwrite the file if it already exists.</span>
</span><span id="save_cursor_rule-1039"><a href="#save_cursor_rule-1039"><span class="linenos">1039</span></a><span class="sd">                   Defaults to True.</span>
</span><span id="save_cursor_rule-1040"><a href="#save_cursor_rule-1040"><span class="linenos">1040</span></a>
</span><span id="save_cursor_rule-1041"><a href="#save_cursor_rule-1041"><span class="linenos">1041</span></a><span class="sd">    Returns:</span>
</span><span id="save_cursor_rule-1042"><a href="#save_cursor_rule-1042"><span class="linenos">1042</span></a><span class="sd">        dict[str, list[dict[str, str | dict[str, bool | str]]] | str]: Dictionary containing:</span>
</span><span id="save_cursor_rule-1043"><a href="#save_cursor_rule-1043"><span class="linenos">1043</span></a><span class="sd">            - On success: {</span>
</span><span id="save_cursor_rule-1044"><a href="#save_cursor_rule-1044"><span class="linenos">1044</span></a><span class="sd">                &quot;operations&quot;: [</span>
</span><span id="save_cursor_rule-1045"><a href="#save_cursor_rule-1045"><span class="linenos">1045</span></a><span class="sd">                    {&quot;type&quot;: &quot;create_directory&quot;, &quot;path&quot;: str, &quot;options&quot;: {&quot;parents&quot;: bool, &quot;exist_ok&quot;: bool}},</span>
</span><span id="save_cursor_rule-1046"><a href="#save_cursor_rule-1046"><span class="linenos">1046</span></a><span class="sd">                    {&quot;type&quot;: &quot;write_file&quot;, &quot;path&quot;: str, &quot;content&quot;: str, &quot;options&quot;: {&quot;mode&quot;: str, &quot;encoding&quot;: str}}</span>
</span><span id="save_cursor_rule-1047"><a href="#save_cursor_rule-1047"><span class="linenos">1047</span></a><span class="sd">                ],</span>
</span><span id="save_cursor_rule-1048"><a href="#save_cursor_rule-1048"><span class="linenos">1048</span></a><span class="sd">                &quot;message&quot;: str,</span>
</span><span id="save_cursor_rule-1049"><a href="#save_cursor_rule-1049"><span class="linenos">1049</span></a><span class="sd">                &quot;rule_structure&quot;: dict,</span>
</span><span id="save_cursor_rule-1050"><a href="#save_cursor_rule-1050"><span class="linenos">1050</span></a><span class="sd">                &quot;validation_results&quot;: dict</span>
</span><span id="save_cursor_rule-1051"><a href="#save_cursor_rule-1051"><span class="linenos">1051</span></a><span class="sd">              }</span>
</span><span id="save_cursor_rule-1052"><a href="#save_cursor_rule-1052"><span class="linenos">1052</span></a><span class="sd">            - On error: {</span>
</span><span id="save_cursor_rule-1053"><a href="#save_cursor_rule-1053"><span class="linenos">1053</span></a><span class="sd">                &quot;isError&quot;: True,</span>
</span><span id="save_cursor_rule-1054"><a href="#save_cursor_rule-1054"><span class="linenos">1054</span></a><span class="sd">                &quot;content&quot;: [{&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: str}]</span>
</span><span id="save_cursor_rule-1055"><a href="#save_cursor_rule-1055"><span class="linenos">1055</span></a><span class="sd">              }</span>
</span><span id="save_cursor_rule-1056"><a href="#save_cursor_rule-1056"><span class="linenos">1056</span></a>
</span><span id="save_cursor_rule-1057"><a href="#save_cursor_rule-1057"><span class="linenos">1057</span></a><span class="sd">    Examples:</span>
</span><span id="save_cursor_rule-1058"><a href="#save_cursor_rule-1058"><span class="linenos">1058</span></a><span class="sd">        &gt;&gt;&gt; result = save_cursor_rule(&quot;python-best-practices&quot;,</span>
</span><span id="save_cursor_rule-1059"><a href="#save_cursor_rule-1059"><span class="linenos">1059</span></a><span class="sd">        ...   &quot;---\\ndescription: Python guidelines\\nglobs: *.py\\nalwaysApply: false\\n---\\n# Python Best Practices\\n...&quot;)</span>
</span><span id="save_cursor_rule-1060"><a href="#save_cursor_rule-1060"><span class="linenos">1060</span></a><span class="sd">        &gt;&gt;&gt; print(&quot;operations&quot; in result)</span>
</span><span id="save_cursor_rule-1061"><a href="#save_cursor_rule-1061"><span class="linenos">1061</span></a><span class="sd">        True</span>
</span><span id="save_cursor_rule-1062"><a href="#save_cursor_rule-1062"><span class="linenos">1062</span></a>
</span><span id="save_cursor_rule-1063"><a href="#save_cursor_rule-1063"><span class="linenos">1063</span></a><span class="sd">        &gt;&gt;&gt; # Example with invalid rule name</span>
</span><span id="save_cursor_rule-1064"><a href="#save_cursor_rule-1064"><span class="linenos">1064</span></a><span class="sd">        &gt;&gt;&gt; result = save_cursor_rule(&quot;Invalid Name&quot;, &quot;Some content&quot;)</span>
</span><span id="save_cursor_rule-1065"><a href="#save_cursor_rule-1065"><span class="linenos">1065</span></a><span class="sd">        &gt;&gt;&gt; print(result.get(&quot;isError&quot;))</span>
</span><span id="save_cursor_rule-1066"><a href="#save_cursor_rule-1066"><span class="linenos">1066</span></a><span class="sd">        True</span>
</span><span id="save_cursor_rule-1067"><a href="#save_cursor_rule-1067"><span class="linenos">1067</span></a>
</span><span id="save_cursor_rule-1068"><a href="#save_cursor_rule-1068"><span class="linenos">1068</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="save_cursor_rule-1069"><a href="#save_cursor_rule-1069"><span class="linenos">1069</span></a>    <span class="c1"># Additional validation beyond Field decorators</span>
</span><span id="save_cursor_rule-1070"><a href="#save_cursor_rule-1070"><span class="linenos">1070</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_name</span><span class="p">:</span>
</span><span id="save_cursor_rule-1071"><a href="#save_cursor_rule-1071"><span class="linenos">1071</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Error: Rule name cannot be empty&quot;</span><span class="p">}]}</span>
</span><span id="save_cursor_rule-1072"><a href="#save_cursor_rule-1072"><span class="linenos">1072</span></a>
</span><span id="save_cursor_rule-1073"><a href="#save_cursor_rule-1073"><span class="linenos">1073</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_content</span><span class="p">:</span>
</span><span id="save_cursor_rule-1074"><a href="#save_cursor_rule-1074"><span class="linenos">1074</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Error: Rule content cannot be empty&quot;</span><span class="p">}]}</span>
</span><span id="save_cursor_rule-1075"><a href="#save_cursor_rule-1075"><span class="linenos">1075</span></a>
</span><span id="save_cursor_rule-1076"><a href="#save_cursor_rule-1076"><span class="linenos">1076</span></a>    <span class="c1"># Initialize validation results</span>
</span><span id="save_cursor_rule-1077"><a href="#save_cursor_rule-1077"><span class="linenos">1077</span></a>    <span class="n">validation_results</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1078"><a href="#save_cursor_rule-1078"><span class="linenos">1078</span></a>        <span class="s2">&quot;basic_structure&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="save_cursor_rule-1079"><a href="#save_cursor_rule-1079"><span class="linenos">1079</span></a>        <span class="s2">&quot;has_frontmatter&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1080"><a href="#save_cursor_rule-1080"><span class="linenos">1080</span></a>        <span class="s2">&quot;has_rule_block&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1081"><a href="#save_cursor_rule-1081"><span class="linenos">1081</span></a>        <span class="s2">&quot;rule_name_match&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1082"><a href="#save_cursor_rule-1082"><span class="linenos">1082</span></a>        <span class="s2">&quot;has_filters&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1083"><a href="#save_cursor_rule-1083"><span class="linenos">1083</span></a>        <span class="s2">&quot;has_actions&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1084"><a href="#save_cursor_rule-1084"><span class="linenos">1084</span></a>        <span class="s2">&quot;has_examples&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1085"><a href="#save_cursor_rule-1085"><span class="linenos">1085</span></a>        <span class="s2">&quot;has_metadata&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="save_cursor_rule-1086"><a href="#save_cursor_rule-1086"><span class="linenos">1086</span></a>        <span class="s2">&quot;warnings&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="save_cursor_rule-1087"><a href="#save_cursor_rule-1087"><span class="linenos">1087</span></a>        <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="save_cursor_rule-1088"><a href="#save_cursor_rule-1088"><span class="linenos">1088</span></a>    <span class="p">}</span>
</span><span id="save_cursor_rule-1089"><a href="#save_cursor_rule-1089"><span class="linenos">1089</span></a>
</span><span id="save_cursor_rule-1090"><a href="#save_cursor_rule-1090"><span class="linenos">1090</span></a>    <span class="c1"># Check for essential structure: the rule block</span>
</span><span id="save_cursor_rule-1091"><a href="#save_cursor_rule-1091"><span class="linenos">1091</span></a>    <span class="k">if</span> <span class="s2">&quot;&lt;rule&gt;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rule_content</span> <span class="ow">or</span> <span class="s2">&quot;&lt;/rule&gt;&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rule_content</span><span class="p">:</span>
</span><span id="save_cursor_rule-1092"><a href="#save_cursor_rule-1092"><span class="linenos">1092</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;basic_structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="save_cursor_rule-1093"><a href="#save_cursor_rule-1093"><span class="linenos">1093</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_rule_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="save_cursor_rule-1094"><a href="#save_cursor_rule-1094"><span class="linenos">1094</span></a>        <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Error: Rule content must include a &lt;rule&gt;...&lt;/rule&gt; block&quot;</span>
</span><span id="save_cursor_rule-1095"><a href="#save_cursor_rule-1095"><span class="linenos">1095</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="save_cursor_rule-1096"><a href="#save_cursor_rule-1096"><span class="linenos">1096</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">error_message</span><span class="p">}]}</span>
</span><span id="save_cursor_rule-1097"><a href="#save_cursor_rule-1097"><span class="linenos">1097</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="save_cursor_rule-1098"><a href="#save_cursor_rule-1098"><span class="linenos">1098</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_rule_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="save_cursor_rule-1099"><a href="#save_cursor_rule-1099"><span class="linenos">1099</span></a>
</span><span id="save_cursor_rule-1100"><a href="#save_cursor_rule-1100"><span class="linenos">1100</span></a>    <span class="c1"># Check for frontmatter (optional but recommended)</span>
</span><span id="save_cursor_rule-1101"><a href="#save_cursor_rule-1101"><span class="linenos">1101</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="save_cursor_rule-1102"><a href="#save_cursor_rule-1102"><span class="linenos">1102</span></a>
</span><span id="save_cursor_rule-1103"><a href="#save_cursor_rule-1103"><span class="linenos">1103</span></a>    <span class="n">frontmatter_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^---\s*\n(.*?)\n---\s*\n&quot;</span>
</span><span id="save_cursor_rule-1104"><a href="#save_cursor_rule-1104"><span class="linenos">1104</span></a>    <span class="n">frontmatter_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">frontmatter_pattern</span><span class="p">,</span> <span class="n">rule_content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span><span id="save_cursor_rule-1105"><a href="#save_cursor_rule-1105"><span class="linenos">1105</span></a>    <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_frontmatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">frontmatter_match</span><span class="p">)</span>
</span><span id="save_cursor_rule-1106"><a href="#save_cursor_rule-1106"><span class="linenos">1106</span></a>
</span><span id="save_cursor_rule-1107"><a href="#save_cursor_rule-1107"><span class="linenos">1107</span></a>    <span class="k">if</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_frontmatter&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1108"><a href="#save_cursor_rule-1108"><span class="linenos">1108</span></a>        <span class="n">frontmatter_content</span> <span class="o">=</span> <span class="n">frontmatter_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="save_cursor_rule-1109"><a href="#save_cursor_rule-1109"><span class="linenos">1109</span></a>        <span class="c1"># Check for required frontmatter fields</span>
</span><span id="save_cursor_rule-1110"><a href="#save_cursor_rule-1110"><span class="linenos">1110</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;description:&quot;</span> <span class="ow">in</span> <span class="n">frontmatter_content</span>
</span><span id="save_cursor_rule-1111"><a href="#save_cursor_rule-1111"><span class="linenos">1111</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_globs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;globs:&quot;</span> <span class="ow">in</span> <span class="n">frontmatter_content</span>
</span><span id="save_cursor_rule-1112"><a href="#save_cursor_rule-1112"><span class="linenos">1112</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_always_apply&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;alwaysApply:&quot;</span> <span class="ow">in</span> <span class="n">frontmatter_content</span>
</span><span id="save_cursor_rule-1113"><a href="#save_cursor_rule-1113"><span class="linenos">1113</span></a>
</span><span id="save_cursor_rule-1114"><a href="#save_cursor_rule-1114"><span class="linenos">1114</span></a>        <span class="c1"># Add warnings for missing frontmatter fields</span>
</span><span id="save_cursor_rule-1115"><a href="#save_cursor_rule-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_description&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1116"><a href="#save_cursor_rule-1116"><span class="linenos">1116</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Frontmatter is missing &#39;description&#39; field&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1117"><a href="#save_cursor_rule-1117"><span class="linenos">1117</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_globs&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1118"><a href="#save_cursor_rule-1118"><span class="linenos">1118</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Frontmatter is missing &#39;globs&#39; field&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1119"><a href="#save_cursor_rule-1119"><span class="linenos">1119</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_always_apply&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1120"><a href="#save_cursor_rule-1120"><span class="linenos">1120</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Frontmatter is missing &#39;alwaysApply&#39; field&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1121"><a href="#save_cursor_rule-1121"><span class="linenos">1121</span></a>
</span><span id="save_cursor_rule-1122"><a href="#save_cursor_rule-1122"><span class="linenos">1122</span></a>        <span class="c1"># Check for quoted glob patterns (not recommended)</span>
</span><span id="save_cursor_rule-1123"><a href="#save_cursor_rule-1123"><span class="linenos">1123</span></a>        <span class="n">glob_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;globs:\s*</span><span class="se">\&quot;</span><span class="s2">(.*?)</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span id="save_cursor_rule-1124"><a href="#save_cursor_rule-1124"><span class="linenos">1124</span></a>        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">glob_pattern</span><span class="p">,</span> <span class="n">frontmatter_content</span><span class="p">):</span>
</span><span id="save_cursor_rule-1125"><a href="#save_cursor_rule-1125"><span class="linenos">1125</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Glob patterns should not be quoted in frontmatter&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1126"><a href="#save_cursor_rule-1126"><span class="linenos">1126</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="save_cursor_rule-1127"><a href="#save_cursor_rule-1127"><span class="linenos">1127</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Rule is missing YAML frontmatter (recommended but optional)&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1128"><a href="#save_cursor_rule-1128"><span class="linenos">1128</span></a>
</span><span id="save_cursor_rule-1129"><a href="#save_cursor_rule-1129"><span class="linenos">1129</span></a>    <span class="c1"># Check for markdown heading (optional if frontmatter exists)</span>
</span><span id="save_cursor_rule-1130"><a href="#save_cursor_rule-1130"><span class="linenos">1130</span></a>    <span class="n">has_heading</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^# &quot;</span><span class="p">,</span> <span class="n">rule_content</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">))</span>
</span><span id="save_cursor_rule-1131"><a href="#save_cursor_rule-1131"><span class="linenos">1131</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_heading</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_frontmatter&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1132"><a href="#save_cursor_rule-1132"><span class="linenos">1132</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Rule has neither frontmatter nor a markdown heading&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1133"><a href="#save_cursor_rule-1133"><span class="linenos">1133</span></a>
</span><span id="save_cursor_rule-1134"><a href="#save_cursor_rule-1134"><span class="linenos">1134</span></a>    <span class="c1"># Extract rule block for deeper validation</span>
</span><span id="save_cursor_rule-1135"><a href="#save_cursor_rule-1135"><span class="linenos">1135</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="save_cursor_rule-1136"><a href="#save_cursor_rule-1136"><span class="linenos">1136</span></a>        <span class="n">rule_block_start</span> <span class="o">=</span> <span class="n">rule_content</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;&lt;rule&gt;&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1137"><a href="#save_cursor_rule-1137"><span class="linenos">1137</span></a>        <span class="n">rule_block_end</span> <span class="o">=</span> <span class="n">rule_content</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;&lt;/rule&gt;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="s2">&quot;&lt;/rule&gt;&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1138"><a href="#save_cursor_rule-1138"><span class="linenos">1138</span></a>        <span class="n">rule_block</span> <span class="o">=</span> <span class="n">rule_content</span><span class="p">[</span><span class="n">rule_block_start</span><span class="p">:</span><span class="n">rule_block_end</span><span class="p">]</span>
</span><span id="save_cursor_rule-1139"><a href="#save_cursor_rule-1139"><span class="linenos">1139</span></a>
</span><span id="save_cursor_rule-1140"><a href="#save_cursor_rule-1140"><span class="linenos">1140</span></a>        <span class="c1"># Check rule name in rule block</span>
</span><span id="save_cursor_rule-1141"><a href="#save_cursor_rule-1141"><span class="linenos">1141</span></a>        <span class="n">rule_name_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;name:\s*([a-z0-9-]+)&quot;</span>
</span><span id="save_cursor_rule-1142"><a href="#save_cursor_rule-1142"><span class="linenos">1142</span></a>        <span class="n">rule_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">rule_name_pattern</span><span class="p">,</span> <span class="n">rule_block</span><span class="p">)</span>
</span><span id="save_cursor_rule-1143"><a href="#save_cursor_rule-1143"><span class="linenos">1143</span></a>
</span><span id="save_cursor_rule-1144"><a href="#save_cursor_rule-1144"><span class="linenos">1144</span></a>        <span class="k">if</span> <span class="n">rule_name_match</span><span class="p">:</span>
</span><span id="save_cursor_rule-1145"><a href="#save_cursor_rule-1145"><span class="linenos">1145</span></a>            <span class="n">rule_name_in_block</span> <span class="o">=</span> <span class="n">rule_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="save_cursor_rule-1146"><a href="#save_cursor_rule-1146"><span class="linenos">1146</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;rule_name_match&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule_name_in_block</span> <span class="o">==</span> <span class="n">rule_name</span>
</span><span id="save_cursor_rule-1147"><a href="#save_cursor_rule-1147"><span class="linenos">1147</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;rule_name_match&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1148"><a href="#save_cursor_rule-1148"><span class="linenos">1148</span></a>                <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="save_cursor_rule-1149"><a href="#save_cursor_rule-1149"><span class="linenos">1149</span></a>                    <span class="sa">f</span><span class="s2">&quot;Warning: Rule name in file (</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">) doesn&#39;t match name in rule block (</span><span class="si">{</span><span class="n">rule_name_in_block</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="save_cursor_rule-1150"><a href="#save_cursor_rule-1150"><span class="linenos">1150</span></a>                <span class="p">)</span>
</span><span id="save_cursor_rule-1151"><a href="#save_cursor_rule-1151"><span class="linenos">1151</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="save_cursor_rule-1152"><a href="#save_cursor_rule-1152"><span class="linenos">1152</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Could not find rule name in rule block&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1153"><a href="#save_cursor_rule-1153"><span class="linenos">1153</span></a>
</span><span id="save_cursor_rule-1154"><a href="#save_cursor_rule-1154"><span class="linenos">1154</span></a>        <span class="c1"># Check for required rule components</span>
</span><span id="save_cursor_rule-1155"><a href="#save_cursor_rule-1155"><span class="linenos">1155</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_filters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;filters:&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span>
</span><span id="save_cursor_rule-1156"><a href="#save_cursor_rule-1156"><span class="linenos">1156</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_actions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;actions:&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span>
</span><span id="save_cursor_rule-1157"><a href="#save_cursor_rule-1157"><span class="linenos">1157</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_examples&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;examples:&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span>
</span><span id="save_cursor_rule-1158"><a href="#save_cursor_rule-1158"><span class="linenos">1158</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;metadata:&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span>
</span><span id="save_cursor_rule-1159"><a href="#save_cursor_rule-1159"><span class="linenos">1159</span></a>
</span><span id="save_cursor_rule-1160"><a href="#save_cursor_rule-1160"><span class="linenos">1160</span></a>        <span class="c1"># Add warnings for missing components</span>
</span><span id="save_cursor_rule-1161"><a href="#save_cursor_rule-1161"><span class="linenos">1161</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_filters&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1162"><a href="#save_cursor_rule-1162"><span class="linenos">1162</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Rule is missing filters section&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1163"><a href="#save_cursor_rule-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_actions&quot;</span><span class="p">]:</span>
</span><span id="save_cursor_rule-1164"><a href="#save_cursor_rule-1164"><span class="linenos">1164</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Warning: Rule is missing actions section&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1165"><a href="#save_cursor_rule-1165"><span class="linenos">1165</span></a>
</span><span id="save_cursor_rule-1166"><a href="#save_cursor_rule-1166"><span class="linenos">1166</span></a>        <span class="c1"># Check for action types</span>
</span><span id="save_cursor_rule-1167"><a href="#save_cursor_rule-1167"><span class="linenos">1167</span></a>        <span class="k">if</span> <span class="s2">&quot;type: suggest&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">:</span>
</span><span id="save_cursor_rule-1168"><a href="#save_cursor_rule-1168"><span class="linenos">1168</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_suggest_action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="save_cursor_rule-1169"><a href="#save_cursor_rule-1169"><span class="linenos">1169</span></a>        <span class="k">if</span> <span class="s2">&quot;type: reject&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">:</span>
</span><span id="save_cursor_rule-1170"><a href="#save_cursor_rule-1170"><span class="linenos">1170</span></a>            <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;has_reject_action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="save_cursor_rule-1171"><a href="#save_cursor_rule-1171"><span class="linenos">1171</span></a>
</span><span id="save_cursor_rule-1172"><a href="#save_cursor_rule-1172"><span class="linenos">1172</span></a>        <span class="c1"># Check for filter types</span>
</span><span id="save_cursor_rule-1173"><a href="#save_cursor_rule-1173"><span class="linenos">1173</span></a>        <span class="n">filter_types</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1174"><a href="#save_cursor_rule-1174"><span class="linenos">1174</span></a>            <span class="s2">&quot;file_extension&quot;</span><span class="p">:</span> <span class="s2">&quot;type: file_extension&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">,</span>
</span><span id="save_cursor_rule-1175"><a href="#save_cursor_rule-1175"><span class="linenos">1175</span></a>            <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;type: file_path&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">,</span>
</span><span id="save_cursor_rule-1176"><a href="#save_cursor_rule-1176"><span class="linenos">1176</span></a>            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;type: content&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">,</span>
</span><span id="save_cursor_rule-1177"><a href="#save_cursor_rule-1177"><span class="linenos">1177</span></a>            <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;type: event&quot;</span> <span class="ow">in</span> <span class="n">rule_block</span><span class="p">,</span>
</span><span id="save_cursor_rule-1178"><a href="#save_cursor_rule-1178"><span class="linenos">1178</span></a>        <span class="p">}</span>
</span><span id="save_cursor_rule-1179"><a href="#save_cursor_rule-1179"><span class="linenos">1179</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;filter_types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_types</span>
</span><span id="save_cursor_rule-1180"><a href="#save_cursor_rule-1180"><span class="linenos">1180</span></a>
</span><span id="save_cursor_rule-1181"><a href="#save_cursor_rule-1181"><span class="linenos">1181</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="save_cursor_rule-1182"><a href="#save_cursor_rule-1182"><span class="linenos">1182</span></a>        <span class="n">validation_results</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not fully validate rule structure: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1183"><a href="#save_cursor_rule-1183"><span class="linenos">1183</span></a>
</span><span id="save_cursor_rule-1184"><a href="#save_cursor_rule-1184"><span class="linenos">1184</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="save_cursor_rule-1185"><a href="#save_cursor_rule-1185"><span class="linenos">1185</span></a>        <span class="c1"># Normalize path with consideration for cross-platform compatibility</span>
</span><span id="save_cursor_rule-1186"><a href="#save_cursor_rule-1186"><span class="linenos">1186</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="save_cursor_rule-1187"><a href="#save_cursor_rule-1187"><span class="linenos">1187</span></a>
</span><span id="save_cursor_rule-1188"><a href="#save_cursor_rule-1188"><span class="linenos">1188</span></a>        <span class="n">cursor_rules_dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="s2">&quot;hack/drafts/cursor_rules&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1189"><a href="#save_cursor_rule-1189"><span class="linenos">1189</span></a>        <span class="n">rule_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cursor_rules_dir_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md&quot;</span><span class="p">)</span>
</span><span id="save_cursor_rule-1190"><a href="#save_cursor_rule-1190"><span class="linenos">1190</span></a>
</span><span id="save_cursor_rule-1191"><a href="#save_cursor_rule-1191"><span class="linenos">1191</span></a>        <span class="c1"># File existence operations</span>
</span><span id="save_cursor_rule-1192"><a href="#save_cursor_rule-1192"><span class="linenos">1192</span></a>        <span class="n">check_file_existence</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_operation&quot;</span><span class="p">,</span> <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;check_file_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">rule_file_path</span><span class="p">}</span>
</span><span id="save_cursor_rule-1193"><a href="#save_cursor_rule-1193"><span class="linenos">1193</span></a>
</span><span id="save_cursor_rule-1194"><a href="#save_cursor_rule-1194"><span class="linenos">1194</span></a>        <span class="c1"># Determine write operation mode based on file existence and overwrite flag</span>
</span><span id="save_cursor_rule-1195"><a href="#save_cursor_rule-1195"><span class="linenos">1195</span></a>        <span class="n">write_mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span>  <span class="c1"># Default mode</span>
</span><span id="save_cursor_rule-1196"><a href="#save_cursor_rule-1196"><span class="linenos">1196</span></a>
</span><span id="save_cursor_rule-1197"><a href="#save_cursor_rule-1197"><span class="linenos">1197</span></a>        <span class="c1"># If we don&#39;t want to overwrite and the file exists, return an error</span>
</span><span id="save_cursor_rule-1198"><a href="#save_cursor_rule-1198"><span class="linenos">1198</span></a>        <span class="n">file_existence_check</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1199"><a href="#save_cursor_rule-1199"><span class="linenos">1199</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;conditional_operation&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1200"><a href="#save_cursor_rule-1200"><span class="linenos">1200</span></a>            <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1201"><a href="#save_cursor_rule-1201"><span class="linenos">1201</span></a>                <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;file_exists&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1202"><a href="#save_cursor_rule-1202"><span class="linenos">1202</span></a>                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">rule_file_path</span><span class="p">,</span>
</span><span id="save_cursor_rule-1203"><a href="#save_cursor_rule-1203"><span class="linenos">1203</span></a>                <span class="s2">&quot;and&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;not&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">overwrite</span><span class="p">},</span>
</span><span id="save_cursor_rule-1204"><a href="#save_cursor_rule-1204"><span class="linenos">1204</span></a>            <span class="p">},</span>
</span><span id="save_cursor_rule-1205"><a href="#save_cursor_rule-1205"><span class="linenos">1205</span></a>            <span class="s2">&quot;if_true&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1206"><a href="#save_cursor_rule-1206"><span class="linenos">1206</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1207"><a href="#save_cursor_rule-1207"><span class="linenos">1207</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: File </span><span class="si">{</span><span class="n">rule_file_path</span><span class="si">}</span><span class="s2"> already exists and overwrite is set to False&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1208"><a href="#save_cursor_rule-1208"><span class="linenos">1208</span></a>            <span class="p">},</span>
</span><span id="save_cursor_rule-1209"><a href="#save_cursor_rule-1209"><span class="linenos">1209</span></a>        <span class="p">}</span>
</span><span id="save_cursor_rule-1210"><a href="#save_cursor_rule-1210"><span class="linenos">1210</span></a>
</span><span id="save_cursor_rule-1211"><a href="#save_cursor_rule-1211"><span class="linenos">1211</span></a>        <span class="c1"># Return operations for the client to perform</span>
</span><span id="save_cursor_rule-1212"><a href="#save_cursor_rule-1212"><span class="linenos">1212</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1213"><a href="#save_cursor_rule-1213"><span class="linenos">1213</span></a>            <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="save_cursor_rule-1214"><a href="#save_cursor_rule-1214"><span class="linenos">1214</span></a>                <span class="c1"># Check file existence first (conditional operation)</span>
</span><span id="save_cursor_rule-1215"><a href="#save_cursor_rule-1215"><span class="linenos">1215</span></a>                <span class="n">file_existence_check</span><span class="p">,</span>
</span><span id="save_cursor_rule-1216"><a href="#save_cursor_rule-1216"><span class="linenos">1216</span></a>                <span class="c1"># Create directory</span>
</span><span id="save_cursor_rule-1217"><a href="#save_cursor_rule-1217"><span class="linenos">1217</span></a>                <span class="p">{</span>
</span><span id="save_cursor_rule-1218"><a href="#save_cursor_rule-1218"><span class="linenos">1218</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;create_directory&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1219"><a href="#save_cursor_rule-1219"><span class="linenos">1219</span></a>                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">cursor_rules_dir_path</span><span class="p">,</span>
</span><span id="save_cursor_rule-1220"><a href="#save_cursor_rule-1220"><span class="linenos">1220</span></a>                    <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parents&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;exist_ok&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="save_cursor_rule-1221"><a href="#save_cursor_rule-1221"><span class="linenos">1221</span></a>                <span class="p">},</span>
</span><span id="save_cursor_rule-1222"><a href="#save_cursor_rule-1222"><span class="linenos">1222</span></a>                <span class="c1"># Write file with encoding specified</span>
</span><span id="save_cursor_rule-1223"><a href="#save_cursor_rule-1223"><span class="linenos">1223</span></a>                <span class="p">{</span>
</span><span id="save_cursor_rule-1224"><a href="#save_cursor_rule-1224"><span class="linenos">1224</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;write_file&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1225"><a href="#save_cursor_rule-1225"><span class="linenos">1225</span></a>                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">rule_file_path</span><span class="p">,</span>
</span><span id="save_cursor_rule-1226"><a href="#save_cursor_rule-1226"><span class="linenos">1226</span></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">rule_content</span><span class="p">,</span>
</span><span id="save_cursor_rule-1227"><a href="#save_cursor_rule-1227"><span class="linenos">1227</span></a>                    <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">write_mode</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">},</span>
</span><span id="save_cursor_rule-1228"><a href="#save_cursor_rule-1228"><span class="linenos">1228</span></a>                <span class="p">},</span>
</span><span id="save_cursor_rule-1229"><a href="#save_cursor_rule-1229"><span class="linenos">1229</span></a>            <span class="p">],</span>
</span><span id="save_cursor_rule-1230"><a href="#save_cursor_rule-1230"><span class="linenos">1230</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Instructions to save cursor rule to </span><span class="si">{</span><span class="n">rule_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1231"><a href="#save_cursor_rule-1231"><span class="linenos">1231</span></a>            <span class="s2">&quot;rule_structure&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1232"><a href="#save_cursor_rule-1232"><span class="linenos">1232</span></a>                <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1233"><a href="#save_cursor_rule-1233"><span class="linenos">1233</span></a>                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">rule_file_path</span><span class="p">,</span>
</span><span id="save_cursor_rule-1234"><a href="#save_cursor_rule-1234"><span class="linenos">1234</span></a>                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;Markdown with embedded rule specification&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1235"><a href="#save_cursor_rule-1235"><span class="linenos">1235</span></a>                <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1236"><a href="#save_cursor_rule-1236"><span class="linenos">1236</span></a>                    <span class="s2">&quot;frontmatter&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1237"><a href="#save_cursor_rule-1237"><span class="linenos">1237</span></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Brief description of the rule&#39;s purpose&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1238"><a href="#save_cursor_rule-1238"><span class="linenos">1238</span></a>                        <span class="s2">&quot;globs&quot;</span><span class="p">:</span> <span class="s2">&quot;File patterns the rule applies to (e.g., *.py)&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1239"><a href="#save_cursor_rule-1239"><span class="linenos">1239</span></a>                        <span class="s2">&quot;alwaysApply&quot;</span><span class="p">:</span> <span class="s2">&quot;Boolean value (typically false)&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1240"><a href="#save_cursor_rule-1240"><span class="linenos">1240</span></a>                    <span class="p">},</span>
</span><span id="save_cursor_rule-1241"><a href="#save_cursor_rule-1241"><span class="linenos">1241</span></a>                    <span class="s2">&quot;introduction&quot;</span><span class="p">:</span> <span class="s2">&quot;Markdown heading and description&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1242"><a href="#save_cursor_rule-1242"><span class="linenos">1242</span></a>                    <span class="s2">&quot;rule_block&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="save_cursor_rule-1243"><a href="#save_cursor_rule-1243"><span class="linenos">1243</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Rule identifier (should match filename)&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1244"><a href="#save_cursor_rule-1244"><span class="linenos">1244</span></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Brief explanation of the rule&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1245"><a href="#save_cursor_rule-1245"><span class="linenos">1245</span></a>                        <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="s2">&quot;Conditions for when the rule applies&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1246"><a href="#save_cursor_rule-1246"><span class="linenos">1246</span></a>                        <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="s2">&quot;Guidance provided when the rule matches&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1247"><a href="#save_cursor_rule-1247"><span class="linenos">1247</span></a>                        <span class="s2">&quot;examples&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample inputs and outputs&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1248"><a href="#save_cursor_rule-1248"><span class="linenos">1248</span></a>                        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;Priority, version, and tags&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1249"><a href="#save_cursor_rule-1249"><span class="linenos">1249</span></a>                    <span class="p">},</span>
</span><span id="save_cursor_rule-1250"><a href="#save_cursor_rule-1250"><span class="linenos">1250</span></a>                <span class="p">},</span>
</span><span id="save_cursor_rule-1251"><a href="#save_cursor_rule-1251"><span class="linenos">1251</span></a>            <span class="p">},</span>
</span><span id="save_cursor_rule-1252"><a href="#save_cursor_rule-1252"><span class="linenos">1252</span></a>            <span class="s2">&quot;validation_results&quot;</span><span class="p">:</span> <span class="n">validation_results</span><span class="p">,</span>
</span><span id="save_cursor_rule-1253"><a href="#save_cursor_rule-1253"><span class="linenos">1253</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="save_cursor_rule-1254"><a href="#save_cursor_rule-1254"><span class="linenos">1254</span></a>                <span class="s2">&quot;Write content to each file sequentially&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1255"><a href="#save_cursor_rule-1255"><span class="linenos">1255</span></a>                <span class="s2">&quot;Run `make update-cursor-rules` to deploy it to the .cursor/rules directory&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1256"><a href="#save_cursor_rule-1256"><span class="linenos">1256</span></a>                <span class="s2">&quot;Verify the rule appears in your Cursor editor&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1257"><a href="#save_cursor_rule-1257"><span class="linenos">1257</span></a>            <span class="p">],</span>
</span><span id="save_cursor_rule-1258"><a href="#save_cursor_rule-1258"><span class="linenos">1258</span></a>            <span class="s2">&quot;deployment_path&quot;</span><span class="p">:</span> <span class="s2">&quot;.cursor/rules/&quot;</span><span class="p">,</span>
</span><span id="save_cursor_rule-1259"><a href="#save_cursor_rule-1259"><span class="linenos">1259</span></a>        <span class="p">}</span>
</span><span id="save_cursor_rule-1260"><a href="#save_cursor_rule-1260"><span class="linenos">1260</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="save_cursor_rule-1261"><a href="#save_cursor_rule-1261"><span class="linenos">1261</span></a>        <span class="c1"># Handle any unexpected errors</span>
</span><span id="save_cursor_rule-1262"><a href="#save_cursor_rule-1262"><span class="linenos">1262</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;isError&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error saving cursor rule: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">}]}</span>
</span></pre></div>


            <div class="docstring"><p>Save a cursor rule to the cursor rules directory.</p>

<p>This tool writes a cursor rule to the designated draft directory for cursor rules in the project.
It performs comprehensive validation of the rule name and content before creating the necessary directory
structure and writing the file. The function returns a dictionary with file operation
instructions for the client to execute.</p>

<p>The cursor rule format should follow this structure:</p>

<ol>
<li>Optional YAML frontmatter with metadata inside triple-dash delimiters (---)
<ul>
<li>description: Brief description of the rule's purpose</li>
<li>globs: File patterns the rule applies to (e.g., *.py)</li>
<li>alwaysApply: Boolean value (typically false)</li>
</ul></li>
<li>A markdown title and introduction</li>
<li>A <rule>...</rule> block containing:
<ul>
<li>name: The rule identifier (should match the filename)</li>
<li>description: Brief explanation of the rule</li>
<li>filters: Conditions for when the rule applies</li>
<li>actions: Guidance provided when the rule matches</li>
<li>examples: Sample inputs and outputs</li>
<li>metadata: Priority, version, and tags</li>
</ul></li>
</ol>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_name:</strong>  The name of the cursor rule file (without extension).
Must be lowercase with hyphens (no spaces) and at least 3 characters.</li>
<li><strong>rule_content:</strong>  The complete content of the cursor rule in mdc.md format.
Should contain valid markdown and be at least 10 characters long.</li>
<li><strong>overwrite:</strong>  Whether to overwrite the file if it already exists.
Defaults to True.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, list[dict[str, str | dict[str, bool | str]]] | str]: Dictionary containing:
      - On success: {
          "operations": [
              {"type": "create_directory", "path": str, "options": {"parents": bool, "exist_ok": bool}},
              {"type": "write_file", "path": str, "content": str, "options": {"mode": str, "encoding": str}}
          ],
          "message": str,
          "rule_structure": dict,
          "validation_results": dict
        }
      - On error: {
          "isError": True,
          "content": [{"type": "text", "text": str}]
        }</p>
</blockquote>

<h6 id="examples">Examples:</h6>

<blockquote>
  <div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">save_cursor_rule</span><span class="p">(</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span>
<span class="gp">... </span>  <span class="s2">&quot;---</span><span class="se">\\</span><span class="s2">ndescription: Python guidelines</span><span class="se">\\</span><span class="s2">nglobs: *.py</span><span class="se">\\</span><span class="s2">nalwaysApply: false</span><span class="se">\\</span><span class="s2">n---</span><span class="se">\\</span><span class="s2">n# Python Best Practices</span><span class="se">\\</span><span class="s2">n...&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;operations&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
  </div>
  
  <div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with invalid rule name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">save_cursor_rule</span><span class="p">(</span><span class="s2">&quot;Invalid Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Some content&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;isError&quot;</span><span class="p">))</span>
<span class="go">True</span>
</code></pre>
  </div>
</blockquote>
</div>


                </section>
                <section id="recommend_cursor_rules">
                            <input id="recommend_cursor_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;recommend_cursor_rules&#39;, description=&#39;Recommend cursor rules based on repository analysis&#39;)</div>

        <span class="def">def</span>
        <span class="name">recommend_cursor_rules</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">repo_summary</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Summary of the repository&#39;s purpose and structure&quot;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A Python web application using FastAPI and SQLAlchemy&#39;</span><span class="p">])</span>,</span><span class="param">	<span class="n">main_languages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python&#39;</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;List of main programming languages used in the repository&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;typescript&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;python&#39;</span><span class="p">]])</span>,</span><span class="param">	<span class="n">file_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*.py&#39;</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;List of common file patterns in the repository&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;*.py&#39;</span><span class="p">,</span> <span class="s1">&#39;*.ts&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;*.py&#39;</span><span class="p">]])</span>,</span><span class="param">	<span class="n">key_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[],</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;List of key features or functionality in the repository&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;web-api&#39;</span><span class="p">,</span> <span class="s1">&#39;database&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;cli-tool&#39;</span><span class="p">]])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="recommend_cursor_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#recommend_cursor_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="recommend_cursor_rules-191"><a href="#recommend_cursor_rules-191"><span class="linenos">191</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-192"><a href="#recommend_cursor_rules-192"><span class="linenos">192</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;recommend_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-193"><a href="#recommend_cursor_rules-193"><span class="linenos">193</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Recommend cursor rules based on repository analysis&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-194"><a href="#recommend_cursor_rules-194"><span class="linenos">194</span></a><span class="p">)</span>
</span><span id="recommend_cursor_rules-195"><a href="#recommend_cursor_rules-195"><span class="linenos">195</span></a><span class="k">def</span><span class="w"> </span><span class="nf">recommend_cursor_rules</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-196"><a href="#recommend_cursor_rules-196"><span class="linenos">196</span></a>    <span class="n">repo_summary</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-197"><a href="#recommend_cursor_rules-197"><span class="linenos">197</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Summary of the repository&#39;s purpose and structure&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-198"><a href="#recommend_cursor_rules-198"><span class="linenos">198</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A Python web application using FastAPI and SQLAlchemy&quot;</span><span class="p">],</span>
</span><span id="recommend_cursor_rules-199"><a href="#recommend_cursor_rules-199"><span class="linenos">199</span></a>    <span class="p">),</span>
</span><span id="recommend_cursor_rules-200"><a href="#recommend_cursor_rules-200"><span class="linenos">200</span></a>    <span class="n">main_languages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-201"><a href="#recommend_cursor_rules-201"><span class="linenos">201</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of main programming languages used in the repository&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-202"><a href="#recommend_cursor_rules-202"><span class="linenos">202</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="s2">&quot;typescript&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">]],</span>
</span><span id="recommend_cursor_rules-203"><a href="#recommend_cursor_rules-203"><span class="linenos">203</span></a>        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">],</span>
</span><span id="recommend_cursor_rules-204"><a href="#recommend_cursor_rules-204"><span class="linenos">204</span></a>    <span class="p">),</span>
</span><span id="recommend_cursor_rules-205"><a href="#recommend_cursor_rules-205"><span class="linenos">205</span></a>    <span class="n">file_patterns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-206"><a href="#recommend_cursor_rules-206"><span class="linenos">206</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of common file patterns in the repository&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-207"><a href="#recommend_cursor_rules-207"><span class="linenos">207</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;*.py&quot;</span><span class="p">,</span> <span class="s2">&quot;*.ts&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">]],</span>
</span><span id="recommend_cursor_rules-208"><a href="#recommend_cursor_rules-208"><span class="linenos">208</span></a>        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">],</span>
</span><span id="recommend_cursor_rules-209"><a href="#recommend_cursor_rules-209"><span class="linenos">209</span></a>    <span class="p">),</span>
</span><span id="recommend_cursor_rules-210"><a href="#recommend_cursor_rules-210"><span class="linenos">210</span></a>    <span class="n">key_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-211"><a href="#recommend_cursor_rules-211"><span class="linenos">211</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;List of key features or functionality in the repository&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-212"><a href="#recommend_cursor_rules-212"><span class="linenos">212</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;web-api&quot;</span><span class="p">,</span> <span class="s2">&quot;database&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;cli-tool&quot;</span><span class="p">]],</span>
</span><span id="recommend_cursor_rules-213"><a href="#recommend_cursor_rules-213"><span class="linenos">213</span></a>        <span class="n">default</span><span class="o">=</span><span class="p">[],</span>
</span><span id="recommend_cursor_rules-214"><a href="#recommend_cursor_rules-214"><span class="linenos">214</span></a>    <span class="p">),</span>
</span><span id="recommend_cursor_rules-215"><a href="#recommend_cursor_rules-215"><span class="linenos">215</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="recommend_cursor_rules-216"><a href="#recommend_cursor_rules-216"><span class="linenos">216</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Recommend cursor rules based on repository analysis.</span>
</span><span id="recommend_cursor_rules-217"><a href="#recommend_cursor_rules-217"><span class="linenos">217</span></a>
</span><span id="recommend_cursor_rules-218"><a href="#recommend_cursor_rules-218"><span class="linenos">218</span></a><span class="sd">    Args:</span>
</span><span id="recommend_cursor_rules-219"><a href="#recommend_cursor_rules-219"><span class="linenos">219</span></a><span class="sd">        repo_summary: Summary of the repository&#39;s purpose and structure</span>
</span><span id="recommend_cursor_rules-220"><a href="#recommend_cursor_rules-220"><span class="linenos">220</span></a><span class="sd">        main_languages: List of main programming languages used</span>
</span><span id="recommend_cursor_rules-221"><a href="#recommend_cursor_rules-221"><span class="linenos">221</span></a><span class="sd">        file_patterns: List of common file patterns</span>
</span><span id="recommend_cursor_rules-222"><a href="#recommend_cursor_rules-222"><span class="linenos">222</span></a><span class="sd">        key_features: List of key features or functionality</span>
</span><span id="recommend_cursor_rules-223"><a href="#recommend_cursor_rules-223"><span class="linenos">223</span></a>
</span><span id="recommend_cursor_rules-224"><a href="#recommend_cursor_rules-224"><span class="linenos">224</span></a><span class="sd">    Returns:</span>
</span><span id="recommend_cursor_rules-225"><a href="#recommend_cursor_rules-225"><span class="linenos">225</span></a><span class="sd">        Dict[str, Any]: Recommended cursor rules and their priorities</span>
</span><span id="recommend_cursor_rules-226"><a href="#recommend_cursor_rules-226"><span class="linenos">226</span></a>
</span><span id="recommend_cursor_rules-227"><a href="#recommend_cursor_rules-227"><span class="linenos">227</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="recommend_cursor_rules-228"><a href="#recommend_cursor_rules-228"><span class="linenos">228</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-229"><a href="#recommend_cursor_rules-229"><span class="linenos">229</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting cursor rule recommendations&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-230"><a href="#recommend_cursor_rules-230"><span class="linenos">230</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Repository summary: </span><span class="si">{</span><span class="n">repo_summary</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-231"><a href="#recommend_cursor_rules-231"><span class="linenos">231</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Main languages: </span><span class="si">{</span><span class="n">main_languages</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-232"><a href="#recommend_cursor_rules-232"><span class="linenos">232</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File patterns: </span><span class="si">{</span><span class="n">file_patterns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-233"><a href="#recommend_cursor_rules-233"><span class="linenos">233</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key features: </span><span class="si">{</span><span class="n">key_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-234"><a href="#recommend_cursor_rules-234"><span class="linenos">234</span></a>
</span><span id="recommend_cursor_rules-235"><a href="#recommend_cursor_rules-235"><span class="linenos">235</span></a>        <span class="c1"># Initialize recommendations</span>
</span><span id="recommend_cursor_rules-236"><a href="#recommend_cursor_rules-236"><span class="linenos">236</span></a>        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="recommend_cursor_rules-237"><a href="#recommend_cursor_rules-237"><span class="linenos">237</span></a>
</span><span id="recommend_cursor_rules-238"><a href="#recommend_cursor_rules-238"><span class="linenos">238</span></a>        <span class="c1"># Helper function to add a recommendation</span>
</span><span id="recommend_cursor_rules-239"><a href="#recommend_cursor_rules-239"><span class="linenos">239</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">add_recommendation</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-240"><a href="#recommend_cursor_rules-240"><span class="linenos">240</span></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-241"><a href="#recommend_cursor_rules-241"><span class="linenos">241</span></a>                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="n">priority</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">}</span>
</span><span id="recommend_cursor_rules-242"><a href="#recommend_cursor_rules-242"><span class="linenos">242</span></a>            <span class="p">)</span>
</span><span id="recommend_cursor_rules-243"><a href="#recommend_cursor_rules-243"><span class="linenos">243</span></a>
</span><span id="recommend_cursor_rules-244"><a href="#recommend_cursor_rules-244"><span class="linenos">244</span></a>        <span class="c1"># Recommend language-specific rules</span>
</span><span id="recommend_cursor_rules-245"><a href="#recommend_cursor_rules-245"><span class="linenos">245</span></a>        <span class="k">for</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">main_languages</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-246"><a href="#recommend_cursor_rules-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="n">lang</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;python&quot;</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-247"><a href="#recommend_cursor_rules-247"><span class="linenos">247</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-248"><a href="#recommend_cursor_rules-248"><span class="linenos">248</span></a>                    <span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-249"><a href="#recommend_cursor_rules-249"><span class="linenos">249</span></a>                    <span class="s2">&quot;Language&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-250"><a href="#recommend_cursor_rules-250"><span class="linenos">250</span></a>                    <span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-251"><a href="#recommend_cursor_rules-251"><span class="linenos">251</span></a>                    <span class="s2">&quot;Best practices for Python development including type hints, docstrings, and PEP 8&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-252"><a href="#recommend_cursor_rules-252"><span class="linenos">252</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-253"><a href="#recommend_cursor_rules-253"><span class="linenos">253</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-254"><a href="#recommend_cursor_rules-254"><span class="linenos">254</span></a>                    <span class="s2">&quot;python-imports&quot;</span><span class="p">,</span> <span class="s2">&quot;Style&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Guidelines for organizing and formatting Python imports&quot;</span>
</span><span id="recommend_cursor_rules-255"><a href="#recommend_cursor_rules-255"><span class="linenos">255</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-256"><a href="#recommend_cursor_rules-256"><span class="linenos">256</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-257"><a href="#recommend_cursor_rules-257"><span class="linenos">257</span></a>                    <span class="s2">&quot;python-testing&quot;</span><span class="p">,</span> <span class="s2">&quot;Testing&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;Best practices for Python testing using pytest&quot;</span>
</span><span id="recommend_cursor_rules-258"><a href="#recommend_cursor_rules-258"><span class="linenos">258</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-259"><a href="#recommend_cursor_rules-259"><span class="linenos">259</span></a>            <span class="k">elif</span> <span class="n">lang</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;typescript&quot;</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-260"><a href="#recommend_cursor_rules-260"><span class="linenos">260</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-261"><a href="#recommend_cursor_rules-261"><span class="linenos">261</span></a>                    <span class="s2">&quot;typescript-patterns&quot;</span><span class="p">,</span> <span class="s2">&quot;Language&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;TypeScript best practices and common patterns&quot;</span>
</span><span id="recommend_cursor_rules-262"><a href="#recommend_cursor_rules-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-263"><a href="#recommend_cursor_rules-263"><span class="linenos">263</span></a>
</span><span id="recommend_cursor_rules-264"><a href="#recommend_cursor_rules-264"><span class="linenos">264</span></a>        <span class="c1"># Recommend feature-specific rules</span>
</span><span id="recommend_cursor_rules-265"><a href="#recommend_cursor_rules-265"><span class="linenos">265</span></a>        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">key_features</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-266"><a href="#recommend_cursor_rules-266"><span class="linenos">266</span></a>            <span class="k">if</span> <span class="s2">&quot;api&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="recommend_cursor_rules-267"><a href="#recommend_cursor_rules-267"><span class="linenos">267</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-268"><a href="#recommend_cursor_rules-268"><span class="linenos">268</span></a>                    <span class="s2">&quot;api-design&quot;</span><span class="p">,</span> <span class="s2">&quot;Architecture&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;Guidelines for designing consistent and maintainable APIs&quot;</span>
</span><span id="recommend_cursor_rules-269"><a href="#recommend_cursor_rules-269"><span class="linenos">269</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-270"><a href="#recommend_cursor_rules-270"><span class="linenos">270</span></a>            <span class="k">if</span> <span class="s2">&quot;database&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="recommend_cursor_rules-271"><a href="#recommend_cursor_rules-271"><span class="linenos">271</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-272"><a href="#recommend_cursor_rules-272"><span class="linenos">272</span></a>                    <span class="s2">&quot;database-patterns&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-273"><a href="#recommend_cursor_rules-273"><span class="linenos">273</span></a>                    <span class="s2">&quot;Architecture&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-274"><a href="#recommend_cursor_rules-274"><span class="linenos">274</span></a>                    <span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-275"><a href="#recommend_cursor_rules-275"><span class="linenos">275</span></a>                    <span class="s2">&quot;Best practices for database interactions and ORM usage&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-276"><a href="#recommend_cursor_rules-276"><span class="linenos">276</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-277"><a href="#recommend_cursor_rules-277"><span class="linenos">277</span></a>            <span class="k">if</span> <span class="s2">&quot;cli&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="recommend_cursor_rules-278"><a href="#recommend_cursor_rules-278"><span class="linenos">278</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-279"><a href="#recommend_cursor_rules-279"><span class="linenos">279</span></a>                    <span class="s2">&quot;cli-design&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-280"><a href="#recommend_cursor_rules-280"><span class="linenos">280</span></a>                    <span class="s2">&quot;Architecture&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-281"><a href="#recommend_cursor_rules-281"><span class="linenos">281</span></a>                    <span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-282"><a href="#recommend_cursor_rules-282"><span class="linenos">282</span></a>                    <span class="s2">&quot;Guidelines for designing user-friendly command-line interfaces&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-283"><a href="#recommend_cursor_rules-283"><span class="linenos">283</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-284"><a href="#recommend_cursor_rules-284"><span class="linenos">284</span></a>
</span><span id="recommend_cursor_rules-285"><a href="#recommend_cursor_rules-285"><span class="linenos">285</span></a>        <span class="c1"># Recommend general development rules</span>
</span><span id="recommend_cursor_rules-286"><a href="#recommend_cursor_rules-286"><span class="linenos">286</span></a>        <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-287"><a href="#recommend_cursor_rules-287"><span class="linenos">287</span></a>            <span class="s2">&quot;code-documentation&quot;</span><span class="p">,</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;Standards for code documentation and inline comments&quot;</span>
</span><span id="recommend_cursor_rules-288"><a href="#recommend_cursor_rules-288"><span class="linenos">288</span></a>        <span class="p">)</span>
</span><span id="recommend_cursor_rules-289"><a href="#recommend_cursor_rules-289"><span class="linenos">289</span></a>        <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-290"><a href="#recommend_cursor_rules-290"><span class="linenos">290</span></a>            <span class="s2">&quot;error-handling&quot;</span><span class="p">,</span> <span class="s2">&quot;Best Practices&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;Guidelines for consistent error handling and logging&quot;</span>
</span><span id="recommend_cursor_rules-291"><a href="#recommend_cursor_rules-291"><span class="linenos">291</span></a>        <span class="p">)</span>
</span><span id="recommend_cursor_rules-292"><a href="#recommend_cursor_rules-292"><span class="linenos">292</span></a>        <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-293"><a href="#recommend_cursor_rules-293"><span class="linenos">293</span></a>            <span class="s2">&quot;security-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;Security&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;Security best practices and common vulnerability prevention&quot;</span>
</span><span id="recommend_cursor_rules-294"><a href="#recommend_cursor_rules-294"><span class="linenos">294</span></a>        <span class="p">)</span>
</span><span id="recommend_cursor_rules-295"><a href="#recommend_cursor_rules-295"><span class="linenos">295</span></a>
</span><span id="recommend_cursor_rules-296"><a href="#recommend_cursor_rules-296"><span class="linenos">296</span></a>        <span class="c1"># Check file patterns for specific recommendations</span>
</span><span id="recommend_cursor_rules-297"><a href="#recommend_cursor_rules-297"><span class="linenos">297</span></a>        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">file_patterns</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-298"><a href="#recommend_cursor_rules-298"><span class="linenos">298</span></a>            <span class="k">if</span> <span class="s2">&quot;test&quot;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="recommend_cursor_rules-299"><a href="#recommend_cursor_rules-299"><span class="linenos">299</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-300"><a href="#recommend_cursor_rules-300"><span class="linenos">300</span></a>                    <span class="s2">&quot;test-organization&quot;</span><span class="p">,</span> <span class="s2">&quot;Testing&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Guidelines for organizing and structuring tests&quot;</span>
</span><span id="recommend_cursor_rules-301"><a href="#recommend_cursor_rules-301"><span class="linenos">301</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-302"><a href="#recommend_cursor_rules-302"><span class="linenos">302</span></a>            <span class="k">if</span> <span class="s2">&quot;docker&quot;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span><span id="recommend_cursor_rules-303"><a href="#recommend_cursor_rules-303"><span class="linenos">303</span></a>                <span class="n">add_recommendation</span><span class="p">(</span>
</span><span id="recommend_cursor_rules-304"><a href="#recommend_cursor_rules-304"><span class="linenos">304</span></a>                    <span class="s2">&quot;docker-best-practices&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-305"><a href="#recommend_cursor_rules-305"><span class="linenos">305</span></a>                    <span class="s2">&quot;DevOps&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-306"><a href="#recommend_cursor_rules-306"><span class="linenos">306</span></a>                    <span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-307"><a href="#recommend_cursor_rules-307"><span class="linenos">307</span></a>                    <span class="s2">&quot;Best practices for Dockerfile creation and container configuration&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-308"><a href="#recommend_cursor_rules-308"><span class="linenos">308</span></a>                <span class="p">)</span>
</span><span id="recommend_cursor_rules-309"><a href="#recommend_cursor_rules-309"><span class="linenos">309</span></a>
</span><span id="recommend_cursor_rules-310"><a href="#recommend_cursor_rules-310"><span class="linenos">310</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">recommendations</span><span class="p">)</span><span class="si">}</span><span class="s2"> recommendations&quot;</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-311"><a href="#recommend_cursor_rules-311"><span class="linenos">311</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="recommend_cursor_rules-312"><a href="#recommend_cursor_rules-312"><span class="linenos">312</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-313"><a href="#recommend_cursor_rules-313"><span class="linenos">313</span></a>            <span class="s2">&quot;recommendations&quot;</span><span class="p">:</span> <span class="n">recommendations</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-314"><a href="#recommend_cursor_rules-314"><span class="linenos">314</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">recommendations</span><span class="p">)</span><span class="si">}</span><span class="s2"> cursor rule recommendations&quot;</span><span class="p">,</span>
</span><span id="recommend_cursor_rules-315"><a href="#recommend_cursor_rules-315"><span class="linenos">315</span></a>        <span class="p">}</span>
</span><span id="recommend_cursor_rules-316"><a href="#recommend_cursor_rules-316"><span class="linenos">316</span></a>
</span><span id="recommend_cursor_rules-317"><a href="#recommend_cursor_rules-317"><span class="linenos">317</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="recommend_cursor_rules-318"><a href="#recommend_cursor_rules-318"><span class="linenos">318</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generating recommendations: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="recommend_cursor_rules-319"><a href="#recommend_cursor_rules-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to generate recommendations&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span></pre></div>


            <div class="docstring"><p>Recommend cursor rules based on repository analysis.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>repo_summary:</strong>  Summary of the repository's purpose and structure</li>
<li><strong>main_languages:</strong>  List of main programming languages used</li>
<li><strong>file_patterns:</strong>  List of common file patterns</li>
<li><strong>key_features:</strong>  List of key features or functionality</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dict[str, Any]: Recommended cursor rules and their priorities</p>
</blockquote>
</div>


                </section>
                <section id="prep_workspace">
                            <input id="prep_workspace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;prep_workspace&#39;, description=&#39;Prepare the workspace for cursor rules by returning natural language instructions&#39;)</div>

        <span class="def">def</span>
        <span class="name">prep_workspace</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="prep_workspace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#prep_workspace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="prep_workspace-1573"><a href="#prep_workspace-1573"><span class="linenos">1573</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="prep_workspace-1574"><a href="#prep_workspace-1574"><span class="linenos">1574</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;prep_workspace&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1575"><a href="#prep_workspace-1575"><span class="linenos">1575</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Prepare the workspace for cursor rules by returning natural language instructions&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1576"><a href="#prep_workspace-1576"><span class="linenos">1576</span></a><span class="p">)</span>
</span><span id="prep_workspace-1577"><a href="#prep_workspace-1577"><span class="linenos">1577</span></a><span class="k">def</span><span class="w"> </span><span class="nf">prep_workspace</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="prep_workspace-1578"><a href="#prep_workspace-1578"><span class="linenos">1578</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the workspace for cursor rules.</span>
</span><span id="prep_workspace-1579"><a href="#prep_workspace-1579"><span class="linenos">1579</span></a>
</span><span id="prep_workspace-1580"><a href="#prep_workspace-1580"><span class="linenos">1580</span></a><span class="sd">    This function provides natural language instructions and commands</span>
</span><span id="prep_workspace-1581"><a href="#prep_workspace-1581"><span class="linenos">1581</span></a><span class="sd">    for cursor rules, including directory creation and file preparation steps.</span>
</span><span id="prep_workspace-1582"><a href="#prep_workspace-1582"><span class="linenos">1582</span></a><span class="sd">    It returns instructions relative to the current working directory without</span>
</span><span id="prep_workspace-1583"><a href="#prep_workspace-1583"><span class="linenos">1583</span></a><span class="sd">    actually creating any directories.</span>
</span><span id="prep_workspace-1584"><a href="#prep_workspace-1584"><span class="linenos">1584</span></a>
</span><span id="prep_workspace-1585"><a href="#prep_workspace-1585"><span class="linenos">1585</span></a><span class="sd">    Returns:</span>
</span><span id="prep_workspace-1586"><a href="#prep_workspace-1586"><span class="linenos">1586</span></a><span class="sd">        dict[str, str]: A dictionary containing status, instructions, and commands</span>
</span><span id="prep_workspace-1587"><a href="#prep_workspace-1587"><span class="linenos">1587</span></a><span class="sd">        with the following keys:</span>
</span><span id="prep_workspace-1588"><a href="#prep_workspace-1588"><span class="linenos">1588</span></a><span class="sd">        - status: &quot;success&quot; or &quot;error&quot;</span>
</span><span id="prep_workspace-1589"><a href="#prep_workspace-1589"><span class="linenos">1589</span></a><span class="sd">        - message: Instructions or error message</span>
</span><span id="prep_workspace-1590"><a href="#prep_workspace-1590"><span class="linenos">1590</span></a><span class="sd">        - directory_exists: Boolean indicating if directory already exists</span>
</span><span id="prep_workspace-1591"><a href="#prep_workspace-1591"><span class="linenos">1591</span></a><span class="sd">        - directory_path: Path to the cursor rules directory</span>
</span><span id="prep_workspace-1592"><a href="#prep_workspace-1592"><span class="linenos">1592</span></a><span class="sd">        - mkdir_command: Command to create the directory</span>
</span><span id="prep_workspace-1593"><a href="#prep_workspace-1593"><span class="linenos">1593</span></a><span class="sd">        - directory_structure: Information about the structure to create</span>
</span><span id="prep_workspace-1594"><a href="#prep_workspace-1594"><span class="linenos">1594</span></a>
</span><span id="prep_workspace-1595"><a href="#prep_workspace-1595"><span class="linenos">1595</span></a><span class="sd">    Raises:</span>
</span><span id="prep_workspace-1596"><a href="#prep_workspace-1596"><span class="linenos">1596</span></a><span class="sd">        No exceptions are raised as they are caught and returned as error messages.</span>
</span><span id="prep_workspace-1597"><a href="#prep_workspace-1597"><span class="linenos">1597</span></a>
</span><span id="prep_workspace-1598"><a href="#prep_workspace-1598"><span class="linenos">1598</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="prep_workspace-1599"><a href="#prep_workspace-1599"><span class="linenos">1599</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="prep_workspace-1600"><a href="#prep_workspace-1600"><span class="linenos">1600</span></a>        <span class="c1"># Get the current working directory</span>
</span><span id="prep_workspace-1601"><a href="#prep_workspace-1601"><span class="linenos">1601</span></a>        <span class="n">current_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
</span><span id="prep_workspace-1602"><a href="#prep_workspace-1602"><span class="linenos">1602</span></a>
</span><span id="prep_workspace-1603"><a href="#prep_workspace-1603"><span class="linenos">1603</span></a>        <span class="c1"># Define the cursor rules directory path</span>
</span><span id="prep_workspace-1604"><a href="#prep_workspace-1604"><span class="linenos">1604</span></a>        <span class="n">cursor_rules_dir</span> <span class="o">=</span> <span class="n">current_dir</span> <span class="o">/</span> <span class="s2">&quot;hack&quot;</span> <span class="o">/</span> <span class="s2">&quot;drafts&quot;</span> <span class="o">/</span> <span class="s2">&quot;cursor_rules&quot;</span>
</span><span id="prep_workspace-1605"><a href="#prep_workspace-1605"><span class="linenos">1605</span></a>
</span><span id="prep_workspace-1606"><a href="#prep_workspace-1606"><span class="linenos">1606</span></a>        <span class="c1"># Check if the directory exists</span>
</span><span id="prep_workspace-1607"><a href="#prep_workspace-1607"><span class="linenos">1607</span></a>        <span class="n">dir_exists</span> <span class="o">=</span> <span class="n">cursor_rules_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</span><span id="prep_workspace-1608"><a href="#prep_workspace-1608"><span class="linenos">1608</span></a>
</span><span id="prep_workspace-1609"><a href="#prep_workspace-1609"><span class="linenos">1609</span></a>        <span class="c1"># Prepare instructions with relative path for display</span>
</span><span id="prep_workspace-1610"><a href="#prep_workspace-1610"><span class="linenos">1610</span></a>        <span class="n">relative_path</span> <span class="o">=</span> <span class="s2">&quot;./hack/drafts/cursor_rules&quot;</span>
</span><span id="prep_workspace-1611"><a href="#prep_workspace-1611"><span class="linenos">1611</span></a>        <span class="n">mkdir_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mkdir -p </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2"> .cursor/rules || true&quot;</span>
</span><span id="prep_workspace-1612"><a href="#prep_workspace-1612"><span class="linenos">1612</span></a>
</span><span id="prep_workspace-1613"><a href="#prep_workspace-1613"><span class="linenos">1613</span></a>        <span class="n">instructions</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="prep_workspace-1614"><a href="#prep_workspace-1614"><span class="linenos">1614</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1615"><a href="#prep_workspace-1615"><span class="linenos">1615</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="prep_workspace-1616"><a href="#prep_workspace-1616"><span class="linenos">1616</span></a><span class="s2">To prepare the workspace for cursor rules, the following steps are needed:</span>
</span><span id="prep_workspace-1617"><a href="#prep_workspace-1617"><span class="linenos">1617</span></a>
</span><span id="prep_workspace-1618"><a href="#prep_workspace-1618"><span class="linenos">1618</span></a><span class="s2">1. Create the cursor rules directory structure, this should be relative to the repo root eg ./hack/drafts/cursor_rules:</span>
</span><span id="prep_workspace-1619"><a href="#prep_workspace-1619"><span class="linenos">1619</span></a><span class="s2">   </span><span class="si">{</span><span class="n">mkdir_cmd</span><span class="si">}</span>
</span><span id="prep_workspace-1620"><a href="#prep_workspace-1620"><span class="linenos">1620</span></a>
</span><span id="prep_workspace-1621"><a href="#prep_workspace-1621"><span class="linenos">1621</span></a><span class="s2">2. Ensure the .cursor/rules directory exists for deployment:</span>
</span><span id="prep_workspace-1622"><a href="#prep_workspace-1622"><span class="linenos">1622</span></a><span class="s2">   mkdir -p .cursor/rules</span>
</span><span id="prep_workspace-1623"><a href="#prep_workspace-1623"><span class="linenos">1623</span></a><span class="s2">   mkdir -p ./hack/drafts/cursor_rules</span>
</span><span id="prep_workspace-1624"><a href="#prep_workspace-1624"><span class="linenos">1624</span></a>
</span><span id="prep_workspace-1625"><a href="#prep_workspace-1625"><span class="linenos">1625</span></a><span class="s2">3. Check if Makefile exists with an update-cursor-rules task:</span>
</span><span id="prep_workspace-1626"><a href="#prep_workspace-1626"><span class="linenos">1626</span></a><span class="s2">   The update-cursor-rules task should copy files from hack/drafts/cursor_rules to .cursor/rules. This command updates Cursor editor rules by copying rule definitions from a drafts directory into the Cursor configuration folder. It first creates a .cursor/rules directory if it doesn&#39;t exist. Then it finds all Markdown (.md) files in the hack/drafts/cursor_rules directory (excluding any README files), copies them to the .cursor/rules directory, and preserves their filenames without the .md extension. The comment notes that Cursor doesn&#39;t support generating .mdc files directly through the Composer Agent at the time this was written</span>
</span><span id="prep_workspace-1627"><a href="#prep_workspace-1627"><span class="linenos">1627</span></a>
</span><span id="prep_workspace-1628"><a href="#prep_workspace-1628"><span class="linenos">1628</span></a>
</span><span id="prep_workspace-1629"><a href="#prep_workspace-1629"><span class="linenos">1629</span></a><span class="s2">4. Update .dockerignore to exclude the cursor rules drafts directory:</span>
</span><span id="prep_workspace-1630"><a href="#prep_workspace-1630"><span class="linenos">1630</span></a><span class="s2">   Add &#39;hack/drafts/cursor_rules&#39; to .dockerignore if it exists</span>
</span><span id="prep_workspace-1631"><a href="#prep_workspace-1631"><span class="linenos">1631</span></a>
</span><span id="prep_workspace-1632"><a href="#prep_workspace-1632"><span class="linenos">1632</span></a><span class="s2">5. Write the following mandatory cursor rule files to the client repo&#39;s cursor rules stage directory one at a time, using the get_static_cursor_rules function to retrieve each file. when saving the file ensure the file has extension .mdc.md, eg tree.mdc becomes tree.mdc.md. use these as rule_names arguments to the get_static_cursor_rules function:</span>
</span><span id="prep_workspace-1633"><a href="#prep_workspace-1633"><span class="linenos">1633</span></a><span class="s2">   - tree: A rule for displaying repository structure</span>
</span><span id="prep_workspace-1634"><a href="#prep_workspace-1634"><span class="linenos">1634</span></a><span class="s2">   - repo_analyzer: A rule for analyzing repository structure and locating code definitions</span>
</span><span id="prep_workspace-1635"><a href="#prep_workspace-1635"><span class="linenos">1635</span></a><span class="s2">   - notify: A rule for notification at the end of tasks</span>
</span><span id="prep_workspace-1636"><a href="#prep_workspace-1636"><span class="linenos">1636</span></a><span class="s2">   - repomix: A rule for repository summarization and packaging for LLM consumption</span>
</span><span id="prep_workspace-1637"><a href="#prep_workspace-1637"><span class="linenos">1637</span></a><span class="s2">   - cursor_rules_location: A rule for locating the cursor rules directory and how to write them</span>
</span><span id="prep_workspace-1638"><a href="#prep_workspace-1638"><span class="linenos">1638</span></a>
</span><span id="prep_workspace-1639"><a href="#prep_workspace-1639"><span class="linenos">1639</span></a><span class="s2">6. Update the client repo&#39;s .cursor/mcp.json file to include new entries if they don&#39;t already exist:</span>
</span><span id="prep_workspace-1640"><a href="#prep_workspace-1640"><span class="linenos">1640</span></a><span class="s2">   Ensure the .cursor/mcp.json file contains entries for prompt_library and sequentialthinking:</span>
</span><span id="prep_workspace-1641"><a href="#prep_workspace-1641"><span class="linenos">1641</span></a><span class="s2">   ```json</span>
</span><span id="prep_workspace-1642"><a href="#prep_workspace-1642"><span class="linenos">1642</span></a><span class="s2">   </span><span class="se">{{</span>
</span><span id="prep_workspace-1643"><a href="#prep_workspace-1643"><span class="linenos">1643</span></a><span class="s2">     &quot;prompt_library&quot;: </span><span class="se">{{</span>
</span><span id="prep_workspace-1644"><a href="#prep_workspace-1644"><span class="linenos">1644</span></a><span class="s2">       &quot;command&quot;: &quot;uv&quot;,</span>
</span><span id="prep_workspace-1645"><a href="#prep_workspace-1645"><span class="linenos">1645</span></a><span class="s2">       &quot;args&quot;: [</span>
</span><span id="prep_workspace-1646"><a href="#prep_workspace-1646"><span class="linenos">1646</span></a><span class="s2">         &quot;run&quot;,</span>
</span><span id="prep_workspace-1647"><a href="#prep_workspace-1647"><span class="linenos">1647</span></a><span class="s2">         &quot;--with&quot;,</span>
</span><span id="prep_workspace-1648"><a href="#prep_workspace-1648"><span class="linenos">1648</span></a><span class="s2">         &quot;mcp[cli]&quot;,</span>
</span><span id="prep_workspace-1649"><a href="#prep_workspace-1649"><span class="linenos">1649</span></a><span class="s2">         &quot;mcp&quot;,</span>
</span><span id="prep_workspace-1650"><a href="#prep_workspace-1650"><span class="linenos">1650</span></a><span class="s2">         &quot;run&quot;,</span>
</span><span id="prep_workspace-1651"><a href="#prep_workspace-1651"><span class="linenos">1651</span></a><span class="s2">         &quot;$</span><span class="se">{{</span><span class="s2">PWD</span><span class="se">}}</span><span class="s2">/src/codegen_lab/prompt_library.py&quot;</span>
</span><span id="prep_workspace-1652"><a href="#prep_workspace-1652"><span class="linenos">1652</span></a><span class="s2">       ]</span>
</span><span id="prep_workspace-1653"><a href="#prep_workspace-1653"><span class="linenos">1653</span></a><span class="s2">     </span><span class="se">}}</span><span class="s2">,</span>
</span><span id="prep_workspace-1654"><a href="#prep_workspace-1654"><span class="linenos">1654</span></a><span class="s2">     &quot;sequentialthinking&quot;: </span><span class="se">{{</span>
</span><span id="prep_workspace-1655"><a href="#prep_workspace-1655"><span class="linenos">1655</span></a><span class="s2">       &quot;command&quot;: &quot;npx&quot;,</span>
</span><span id="prep_workspace-1656"><a href="#prep_workspace-1656"><span class="linenos">1656</span></a><span class="s2">       &quot;args&quot;: [</span>
</span><span id="prep_workspace-1657"><a href="#prep_workspace-1657"><span class="linenos">1657</span></a><span class="s2">         &quot;-y&quot;,</span>
</span><span id="prep_workspace-1658"><a href="#prep_workspace-1658"><span class="linenos">1658</span></a><span class="s2">         &quot;@modelcontextprotocol/server-sequential-thinking&quot;</span>
</span><span id="prep_workspace-1659"><a href="#prep_workspace-1659"><span class="linenos">1659</span></a><span class="s2">       ]</span>
</span><span id="prep_workspace-1660"><a href="#prep_workspace-1660"><span class="linenos">1660</span></a><span class="s2">     </span><span class="se">}}</span>
</span><span id="prep_workspace-1661"><a href="#prep_workspace-1661"><span class="linenos">1661</span></a><span class="s2">   </span><span class="se">}}</span>
</span><span id="prep_workspace-1662"><a href="#prep_workspace-1662"><span class="linenos">1662</span></a><span class="s2">   ```</span>
</span><span id="prep_workspace-1663"><a href="#prep_workspace-1663"><span class="linenos">1663</span></a><span class="s2">   Note: The path in the prompt_library entry should be adjusted to use the actual project path (PWD) instead of hardcoded paths.</span>
</span><span id="prep_workspace-1664"><a href="#prep_workspace-1664"><span class="linenos">1664</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1665"><a href="#prep_workspace-1665"><span class="linenos">1665</span></a>            <span class="s2">&quot;directory_exists&quot;</span><span class="p">:</span> <span class="n">dir_exists</span><span class="p">,</span>
</span><span id="prep_workspace-1666"><a href="#prep_workspace-1666"><span class="linenos">1666</span></a>            <span class="s2">&quot;directory_path&quot;</span><span class="p">:</span> <span class="n">relative_path</span><span class="p">,</span>
</span><span id="prep_workspace-1667"><a href="#prep_workspace-1667"><span class="linenos">1667</span></a>            <span class="s2">&quot;mkdir_command&quot;</span><span class="p">:</span> <span class="n">mkdir_cmd</span><span class="p">,</span>
</span><span id="prep_workspace-1668"><a href="#prep_workspace-1668"><span class="linenos">1668</span></a>            <span class="s2">&quot;directory_structure&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Directory structure to create at </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1669"><a href="#prep_workspace-1669"><span class="linenos">1669</span></a>            <span class="s2">&quot;workspace_prepared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Changed to False since we&#39;re not creating directories</span>
</span><span id="prep_workspace-1670"><a href="#prep_workspace-1670"><span class="linenos">1670</span></a>            <span class="s2">&quot;workspace_result&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="prep_workspace-1671"><a href="#prep_workspace-1671"><span class="linenos">1671</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1672"><a href="#prep_workspace-1672"><span class="linenos">1672</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Instructions provided for workspace preparation at </span><span class="si">{</span><span class="n">relative_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1673"><a href="#prep_workspace-1673"><span class="linenos">1673</span></a>                <span class="s2">&quot;directory_exists&quot;</span><span class="p">:</span> <span class="n">dir_exists</span><span class="p">,</span>
</span><span id="prep_workspace-1674"><a href="#prep_workspace-1674"><span class="linenos">1674</span></a>                <span class="s2">&quot;directory_path&quot;</span><span class="p">:</span> <span class="n">relative_path</span><span class="p">,</span>
</span><span id="prep_workspace-1675"><a href="#prep_workspace-1675"><span class="linenos">1675</span></a>                <span class="s2">&quot;mkdir_command&quot;</span><span class="p">:</span> <span class="n">mkdir_cmd</span><span class="p">,</span>
</span><span id="prep_workspace-1676"><a href="#prep_workspace-1676"><span class="linenos">1676</span></a>            <span class="p">},</span>
</span><span id="prep_workspace-1677"><a href="#prep_workspace-1677"><span class="linenos">1677</span></a>        <span class="p">}</span>
</span><span id="prep_workspace-1678"><a href="#prep_workspace-1678"><span class="linenos">1678</span></a>
</span><span id="prep_workspace-1679"><a href="#prep_workspace-1679"><span class="linenos">1679</span></a>        <span class="k">return</span> <span class="n">instructions</span>
</span><span id="prep_workspace-1680"><a href="#prep_workspace-1680"><span class="linenos">1680</span></a>
</span><span id="prep_workspace-1681"><a href="#prep_workspace-1681"><span class="linenos">1681</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="prep_workspace-1682"><a href="#prep_workspace-1682"><span class="linenos">1682</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="prep_workspace-1683"><a href="#prep_workspace-1683"><span class="linenos">1683</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1684"><a href="#prep_workspace-1684"><span class="linenos">1684</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error preparing workspace instructions: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1685"><a href="#prep_workspace-1685"><span class="linenos">1685</span></a>            <span class="s2">&quot;directory_exists&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="prep_workspace-1686"><a href="#prep_workspace-1686"><span class="linenos">1686</span></a>            <span class="s2">&quot;directory_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./hack/drafts/cursor_rules&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1687"><a href="#prep_workspace-1687"><span class="linenos">1687</span></a>            <span class="s2">&quot;mkdir_command&quot;</span><span class="p">:</span> <span class="s2">&quot;mkdir -p ./hack/drafts/cursor_rules .cursor/rules || true&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1688"><a href="#prep_workspace-1688"><span class="linenos">1688</span></a>            <span class="s2">&quot;workspace_prepared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="prep_workspace-1689"><a href="#prep_workspace-1689"><span class="linenos">1689</span></a>            <span class="s2">&quot;workspace_result&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="prep_workspace-1690"><a href="#prep_workspace-1690"><span class="linenos">1690</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1691"><a href="#prep_workspace-1691"><span class="linenos">1691</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error preparing workspace instructions: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1692"><a href="#prep_workspace-1692"><span class="linenos">1692</span></a>                <span class="s2">&quot;directory_exists&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="prep_workspace-1693"><a href="#prep_workspace-1693"><span class="linenos">1693</span></a>                <span class="s2">&quot;directory_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./hack/drafts/cursor_rules&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1694"><a href="#prep_workspace-1694"><span class="linenos">1694</span></a>                <span class="s2">&quot;mkdir_command&quot;</span><span class="p">:</span> <span class="s2">&quot;mkdir -p ./hack/drafts/cursor_rules .cursor/rules || true&quot;</span><span class="p">,</span>
</span><span id="prep_workspace-1695"><a href="#prep_workspace-1695"><span class="linenos">1695</span></a>            <span class="p">},</span>
</span><span id="prep_workspace-1696"><a href="#prep_workspace-1696"><span class="linenos">1696</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Prepare the workspace for cursor rules.</p>

<p>This function provides natural language instructions and commands
for cursor rules, including directory creation and file preparation steps.
It returns instructions relative to the current working directory without
actually creating any directories.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, str]: A dictionary containing status, instructions, and commands
  with the following keys:</p>
  
  <ul>
  <li>status: "success" or "error"</li>
  <li>message: Instructions or error message</li>
  <li>directory_exists: Boolean indicating if directory already exists</li>
  <li>directory_path: Path to the cursor rules directory</li>
  <li>mkdir_command: Command to create the directory</li>
  <li>directory_structure: Information about the structure to create</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No exceptions are raised as they are caught and returned as error messages.</li>
</ul>
</div>


                </section>
                <section id="create_cursor_rule_files">
                            <input id="create_cursor_rule_files-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;create_cursor_rule_files&#39;, description=&#39;Create empty cursor rule files and provide instructions for sequential content creation&#39;)</div>

        <span class="def">def</span>
        <span class="name">create_cursor_rule_files</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A list of cursor rule names to create (without file extensions)&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python-best-practices&#39;</span><span class="p">,</span> <span class="s1">&#39;react-component-structure&#39;</span><span class="p">,</span> <span class="s1">&#39;typescript-patterns&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">MinLen</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="create_cursor_rule_files-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_cursor_rule_files"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_cursor_rule_files-1699"><a href="#create_cursor_rule_files-1699"><span class="linenos">1699</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="create_cursor_rule_files-1700"><a href="#create_cursor_rule_files-1700"><span class="linenos">1700</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;create_cursor_rule_files&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1701"><a href="#create_cursor_rule_files-1701"><span class="linenos">1701</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Create empty cursor rule files and provide instructions for sequential content creation&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1702"><a href="#create_cursor_rule_files-1702"><span class="linenos">1702</span></a><span class="p">)</span>
</span><span id="create_cursor_rule_files-1703"><a href="#create_cursor_rule_files-1703"><span class="linenos">1703</span></a><span class="k">def</span><span class="w"> </span><span class="nf">create_cursor_rule_files</span><span class="p">(</span>
</span><span id="create_cursor_rule_files-1704"><a href="#create_cursor_rule_files-1704"><span class="linenos">1704</span></a>    <span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="create_cursor_rule_files-1705"><a href="#create_cursor_rule_files-1705"><span class="linenos">1705</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A list of cursor rule names to create (without file extensions)&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1706"><a href="#create_cursor_rule_files-1706"><span class="linenos">1706</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-component-structure&quot;</span><span class="p">,</span> <span class="s2">&quot;typescript-patterns&quot;</span><span class="p">],</span>
</span><span id="create_cursor_rule_files-1707"><a href="#create_cursor_rule_files-1707"><span class="linenos">1707</span></a>        <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1708"><a href="#create_cursor_rule_files-1708"><span class="linenos">1708</span></a>    <span class="p">),</span>
</span><span id="create_cursor_rule_files-1709"><a href="#create_cursor_rule_files-1709"><span class="linenos">1709</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="create_cursor_rule_files-1710"><a href="#create_cursor_rule_files-1710"><span class="linenos">1710</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create empty cursor rule files in the hack/drafts/cursor_rules directory.</span>
</span><span id="create_cursor_rule_files-1711"><a href="#create_cursor_rule_files-1711"><span class="linenos">1711</span></a>
</span><span id="create_cursor_rule_files-1712"><a href="#create_cursor_rule_files-1712"><span class="linenos">1712</span></a><span class="sd">    Args:</span>
</span><span id="create_cursor_rule_files-1713"><a href="#create_cursor_rule_files-1713"><span class="linenos">1713</span></a><span class="sd">        rule_names: A list of cursor rule names to create (without file extensions)</span>
</span><span id="create_cursor_rule_files-1714"><a href="#create_cursor_rule_files-1714"><span class="linenos">1714</span></a>
</span><span id="create_cursor_rule_files-1715"><a href="#create_cursor_rule_files-1715"><span class="linenos">1715</span></a><span class="sd">    Returns:</span>
</span><span id="create_cursor_rule_files-1716"><a href="#create_cursor_rule_files-1716"><span class="linenos">1716</span></a><span class="sd">        dict[str, Any]: A dictionary containing file operation instructions and next steps</span>
</span><span id="create_cursor_rule_files-1717"><a href="#create_cursor_rule_files-1717"><span class="linenos">1717</span></a>
</span><span id="create_cursor_rule_files-1718"><a href="#create_cursor_rule_files-1718"><span class="linenos">1718</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_cursor_rule_files-1719"><a href="#create_cursor_rule_files-1719"><span class="linenos">1719</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="create_cursor_rule_files-1720"><a href="#create_cursor_rule_files-1720"><span class="linenos">1720</span></a>        <span class="c1"># Define the cursor rules directory path</span>
</span><span id="create_cursor_rule_files-1721"><a href="#create_cursor_rule_files-1721"><span class="linenos">1721</span></a>        <span class="n">cursor_rules_dir_path</span> <span class="o">=</span> <span class="s2">&quot;hack/drafts/cursor_rules&quot;</span>
</span><span id="create_cursor_rule_files-1722"><a href="#create_cursor_rule_files-1722"><span class="linenos">1722</span></a>
</span><span id="create_cursor_rule_files-1723"><a href="#create_cursor_rule_files-1723"><span class="linenos">1723</span></a>        <span class="c1"># Prepare operations list</span>
</span><span id="create_cursor_rule_files-1724"><a href="#create_cursor_rule_files-1724"><span class="linenos">1724</span></a>        <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="create_cursor_rule_files-1725"><a href="#create_cursor_rule_files-1725"><span class="linenos">1725</span></a>            <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;create_directory&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">cursor_rules_dir_path</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;parents&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;exist_ok&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
</span><span id="create_cursor_rule_files-1726"><a href="#create_cursor_rule_files-1726"><span class="linenos">1726</span></a>        <span class="p">]</span>
</span><span id="create_cursor_rule_files-1727"><a href="#create_cursor_rule_files-1727"><span class="linenos">1727</span></a>
</span><span id="create_cursor_rule_files-1728"><a href="#create_cursor_rule_files-1728"><span class="linenos">1728</span></a>        <span class="n">created_files</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="create_cursor_rule_files-1729"><a href="#create_cursor_rule_files-1729"><span class="linenos">1729</span></a>        <span class="k">for</span> <span class="n">rule_name</span> <span class="ow">in</span> <span class="n">rule_names</span><span class="p">:</span>
</span><span id="create_cursor_rule_files-1730"><a href="#create_cursor_rule_files-1730"><span class="linenos">1730</span></a>            <span class="c1"># Ensure the rule name has the correct extension</span>
</span><span id="create_cursor_rule_files-1731"><a href="#create_cursor_rule_files-1731"><span class="linenos">1731</span></a>            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.mdc.md&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">rule_name</span>
</span><span id="create_cursor_rule_files-1732"><a href="#create_cursor_rule_files-1732"><span class="linenos">1732</span></a>
</span><span id="create_cursor_rule_files-1733"><a href="#create_cursor_rule_files-1733"><span class="linenos">1733</span></a>            <span class="c1"># Create the file path</span>
</span><span id="create_cursor_rule_files-1734"><a href="#create_cursor_rule_files-1734"><span class="linenos">1734</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cursor_rules_dir_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="create_cursor_rule_files-1735"><a href="#create_cursor_rule_files-1735"><span class="linenos">1735</span></a>
</span><span id="create_cursor_rule_files-1736"><a href="#create_cursor_rule_files-1736"><span class="linenos">1736</span></a>            <span class="c1"># Add operation to create an empty file</span>
</span><span id="create_cursor_rule_files-1737"><a href="#create_cursor_rule_files-1737"><span class="linenos">1737</span></a>            <span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="create_cursor_rule_files-1738"><a href="#create_cursor_rule_files-1738"><span class="linenos">1738</span></a>                <span class="p">{</span>
</span><span id="create_cursor_rule_files-1739"><a href="#create_cursor_rule_files-1739"><span class="linenos">1739</span></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;write_file&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1740"><a href="#create_cursor_rule_files-1740"><span class="linenos">1740</span></a>                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1741"><a href="#create_cursor_rule_files-1741"><span class="linenos">1741</span></a>                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Empty content for now</span>
</span><span id="create_cursor_rule_files-1742"><a href="#create_cursor_rule_files-1742"><span class="linenos">1742</span></a>                    <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;w&quot;</span><span class="p">},</span>
</span><span id="create_cursor_rule_files-1743"><a href="#create_cursor_rule_files-1743"><span class="linenos">1743</span></a>                <span class="p">}</span>
</span><span id="create_cursor_rule_files-1744"><a href="#create_cursor_rule_files-1744"><span class="linenos">1744</span></a>            <span class="p">)</span>
</span><span id="create_cursor_rule_files-1745"><a href="#create_cursor_rule_files-1745"><span class="linenos">1745</span></a>
</span><span id="create_cursor_rule_files-1746"><a href="#create_cursor_rule_files-1746"><span class="linenos">1746</span></a>            <span class="n">created_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="create_cursor_rule_files-1747"><a href="#create_cursor_rule_files-1747"><span class="linenos">1747</span></a>
</span><span id="create_cursor_rule_files-1748"><a href="#create_cursor_rule_files-1748"><span class="linenos">1748</span></a>        <span class="c1"># Prepare touch command for display</span>
</span><span id="create_cursor_rule_files-1749"><a href="#create_cursor_rule_files-1749"><span class="linenos">1749</span></a>        <span class="n">touch_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;touch </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">cursor_rules_dir_path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">created_files</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="create_cursor_rule_files-1750"><a href="#create_cursor_rule_files-1750"><span class="linenos">1750</span></a>
</span><span id="create_cursor_rule_files-1751"><a href="#create_cursor_rule_files-1751"><span class="linenos">1751</span></a>        <span class="c1"># Prepare next steps</span>
</span><span id="create_cursor_rule_files-1752"><a href="#create_cursor_rule_files-1752"><span class="linenos">1752</span></a>        <span class="n">next_steps</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="create_cursor_rule_files-1753"><a href="#create_cursor_rule_files-1753"><span class="linenos">1753</span></a><span class="s2">Next steps:</span>
</span><span id="create_cursor_rule_files-1754"><a href="#create_cursor_rule_files-1754"><span class="linenos">1754</span></a><span class="s2">1. Write content to each file sequentially</span>
</span><span id="create_cursor_rule_files-1755"><a href="#create_cursor_rule_files-1755"><span class="linenos">1755</span></a><span class="s2">2. Deploy the rules using &#39;make update-cursor-rules&#39;</span>
</span><span id="create_cursor_rule_files-1756"><a href="#create_cursor_rule_files-1756"><span class="linenos">1756</span></a><span class="s2">3. Verify the rules are correctly deployed to .cursor/rules</span>
</span><span id="create_cursor_rule_files-1757"><a href="#create_cursor_rule_files-1757"><span class="linenos">1757</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="create_cursor_rule_files-1758"><a href="#create_cursor_rule_files-1758"><span class="linenos">1758</span></a>
</span><span id="create_cursor_rule_files-1759"><a href="#create_cursor_rule_files-1759"><span class="linenos">1759</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="create_cursor_rule_files-1760"><a href="#create_cursor_rule_files-1760"><span class="linenos">1760</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1761"><a href="#create_cursor_rule_files-1761"><span class="linenos">1761</span></a>            <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1762"><a href="#create_cursor_rule_files-1762"><span class="linenos">1762</span></a>            <span class="s2">&quot;created_files&quot;</span><span class="p">:</span> <span class="n">created_files</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1763"><a href="#create_cursor_rule_files-1763"><span class="linenos">1763</span></a>            <span class="s2">&quot;touch_command&quot;</span><span class="p">:</span> <span class="n">touch_cmd</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1764"><a href="#create_cursor_rule_files-1764"><span class="linenos">1764</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="n">next_steps</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1765"><a href="#create_cursor_rule_files-1765"><span class="linenos">1765</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Instructions to create </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">created_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> empty cursor rule files in </span><span class="si">{</span><span class="n">cursor_rules_dir_path</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">next_steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1766"><a href="#create_cursor_rule_files-1766"><span class="linenos">1766</span></a>        <span class="p">}</span>
</span><span id="create_cursor_rule_files-1767"><a href="#create_cursor_rule_files-1767"><span class="linenos">1767</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="create_cursor_rule_files-1768"><a href="#create_cursor_rule_files-1768"><span class="linenos">1768</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="create_cursor_rule_files-1769"><a href="#create_cursor_rule_files-1769"><span class="linenos">1769</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1770"><a href="#create_cursor_rule_files-1770"><span class="linenos">1770</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1771"><a href="#create_cursor_rule_files-1771"><span class="linenos">1771</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Check the error message and try again.&quot;</span><span class="p">,</span>
</span><span id="create_cursor_rule_files-1772"><a href="#create_cursor_rule_files-1772"><span class="linenos">1772</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Create empty cursor rule files in the hack/drafts/cursor_rules directory.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_names:</strong>  A list of cursor rule names to create (without file extensions)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing file operation instructions and next steps</p>
</blockquote>
</div>


                </section>
                <section id="ensure_makefile_task">
                            <input id="ensure_makefile_task-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;ensure_makefile_task&#39;, description=&#39;Ensure the Makefile has the update-cursor-rules task&#39;)</div>

        <span class="def">def</span>
        <span class="name">ensure_makefile_task</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">makefile_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Makefile&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Path to the Makefile file, relative to the project root&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Makefile&#39;</span><span class="p">,</span> <span class="s1">&#39;build/Makefile&#39;</span><span class="p">])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ensure_makefile_task-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ensure_makefile_task"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ensure_makefile_task-1775"><a href="#ensure_makefile_task-1775"><span class="linenos">1775</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="ensure_makefile_task-1776"><a href="#ensure_makefile_task-1776"><span class="linenos">1776</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ensure_makefile_task&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1777"><a href="#ensure_makefile_task-1777"><span class="linenos">1777</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Ensure the Makefile has the update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1778"><a href="#ensure_makefile_task-1778"><span class="linenos">1778</span></a><span class="p">)</span>
</span><span id="ensure_makefile_task-1779"><a href="#ensure_makefile_task-1779"><span class="linenos">1779</span></a><span class="k">def</span><span class="w"> </span><span class="nf">ensure_makefile_task</span><span class="p">(</span>
</span><span id="ensure_makefile_task-1780"><a href="#ensure_makefile_task-1780"><span class="linenos">1780</span></a>    <span class="n">makefile_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="ensure_makefile_task-1781"><a href="#ensure_makefile_task-1781"><span class="linenos">1781</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Path to the Makefile file, relative to the project root&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1782"><a href="#ensure_makefile_task-1782"><span class="linenos">1782</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Makefile&quot;</span><span class="p">,</span> <span class="s2">&quot;build/Makefile&quot;</span><span class="p">],</span>
</span><span id="ensure_makefile_task-1783"><a href="#ensure_makefile_task-1783"><span class="linenos">1783</span></a>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Makefile&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1784"><a href="#ensure_makefile_task-1784"><span class="linenos">1784</span></a>    <span class="p">),</span>
</span><span id="ensure_makefile_task-1785"><a href="#ensure_makefile_task-1785"><span class="linenos">1785</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="ensure_makefile_task-1786"><a href="#ensure_makefile_task-1786"><span class="linenos">1786</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensure the Makefile has the update-cursor-rules task.</span>
</span><span id="ensure_makefile_task-1787"><a href="#ensure_makefile_task-1787"><span class="linenos">1787</span></a>
</span><span id="ensure_makefile_task-1788"><a href="#ensure_makefile_task-1788"><span class="linenos">1788</span></a><span class="sd">    This function checks if the Makefile exists and contains the update-cursor-rules task.</span>
</span><span id="ensure_makefile_task-1789"><a href="#ensure_makefile_task-1789"><span class="linenos">1789</span></a><span class="sd">    If the task doesn&#39;t exist, it returns instructions to add it to the Makefile.</span>
</span><span id="ensure_makefile_task-1790"><a href="#ensure_makefile_task-1790"><span class="linenos">1790</span></a><span class="sd">    If the Makefile doesn&#39;t exist, it returns instructions to create one with the task.</span>
</span><span id="ensure_makefile_task-1791"><a href="#ensure_makefile_task-1791"><span class="linenos">1791</span></a>
</span><span id="ensure_makefile_task-1792"><a href="#ensure_makefile_task-1792"><span class="linenos">1792</span></a><span class="sd">    Args:</span>
</span><span id="ensure_makefile_task-1793"><a href="#ensure_makefile_task-1793"><span class="linenos">1793</span></a><span class="sd">        makefile_path: Path to the Makefile, defaults to &quot;Makefile&quot;</span>
</span><span id="ensure_makefile_task-1794"><a href="#ensure_makefile_task-1794"><span class="linenos">1794</span></a>
</span><span id="ensure_makefile_task-1795"><a href="#ensure_makefile_task-1795"><span class="linenos">1795</span></a><span class="sd">    Returns:</span>
</span><span id="ensure_makefile_task-1796"><a href="#ensure_makefile_task-1796"><span class="linenos">1796</span></a><span class="sd">        dict[str, Any]: A dictionary containing operations to perform and additional information</span>
</span><span id="ensure_makefile_task-1797"><a href="#ensure_makefile_task-1797"><span class="linenos">1797</span></a>
</span><span id="ensure_makefile_task-1798"><a href="#ensure_makefile_task-1798"><span class="linenos">1798</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ensure_makefile_task-1799"><a href="#ensure_makefile_task-1799"><span class="linenos">1799</span></a>    <span class="c1"># Handle the case where makefile_path is a Field object</span>
</span><span id="ensure_makefile_task-1800"><a href="#ensure_makefile_task-1800"><span class="linenos">1800</span></a>    <span class="c1"># This is a common pattern when using FastMCP with Field decorators</span>
</span><span id="ensure_makefile_task-1801"><a href="#ensure_makefile_task-1801"><span class="linenos">1801</span></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">makefile_path</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">):</span>
</span><span id="ensure_makefile_task-1802"><a href="#ensure_makefile_task-1802"><span class="linenos">1802</span></a>        <span class="n">path_str</span> <span class="o">=</span> <span class="n">makefile_path</span><span class="o">.</span><span class="n">default</span>
</span><span id="ensure_makefile_task-1803"><a href="#ensure_makefile_task-1803"><span class="linenos">1803</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="ensure_makefile_task-1804"><a href="#ensure_makefile_task-1804"><span class="linenos">1804</span></a>        <span class="n">path_str</span> <span class="o">=</span> <span class="n">makefile_path</span>
</span><span id="ensure_makefile_task-1805"><a href="#ensure_makefile_task-1805"><span class="linenos">1805</span></a>
</span><span id="ensure_makefile_task-1806"><a href="#ensure_makefile_task-1806"><span class="linenos">1806</span></a>    <span class="c1"># Check if the makefile path is valid</span>
</span><span id="ensure_makefile_task-1807"><a href="#ensure_makefile_task-1807"><span class="linenos">1807</span></a>    <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;?&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_str</span><span class="p">):</span>
</span><span id="ensure_makefile_task-1808"><a href="#ensure_makefile_task-1808"><span class="linenos">1808</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="ensure_makefile_task-1809"><a href="#ensure_makefile_task-1809"><span class="linenos">1809</span></a>            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1810"><a href="#ensure_makefile_task-1810"><span class="linenos">1810</span></a>            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid file path&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1811"><a href="#ensure_makefile_task-1811"><span class="linenos">1811</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid file path: wildcards are not allowed&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1812"><a href="#ensure_makefile_task-1812"><span class="linenos">1812</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Please provide a valid file path without wildcards.&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1813"><a href="#ensure_makefile_task-1813"><span class="linenos">1813</span></a>        <span class="p">}</span>
</span><span id="ensure_makefile_task-1814"><a href="#ensure_makefile_task-1814"><span class="linenos">1814</span></a>
</span><span id="ensure_makefile_task-1815"><a href="#ensure_makefile_task-1815"><span class="linenos">1815</span></a>    <span class="c1"># The update-cursor-rules task content</span>
</span><span id="ensure_makefile_task-1816"><a href="#ensure_makefile_task-1816"><span class="linenos">1816</span></a>    <span class="n">update_task_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="ensure_makefile_task-1817"><a href="#ensure_makefile_task-1817"><span class="linenos">1817</span></a><span class="s2"># Cursor Rules</span>
</span><span id="ensure_makefile_task-1818"><a href="#ensure_makefile_task-1818"><span class="linenos">1818</span></a><span class="s2">.PHONY: update-cursor-rules</span>
</span><span id="ensure_makefile_task-1819"><a href="#ensure_makefile_task-1819"><span class="linenos">1819</span></a><span class="s2">update-cursor-rules:  ## Update cursor rules from prompts/drafts/cursor_rules</span>
</span><span id="ensure_makefile_task-1820"><a href="#ensure_makefile_task-1820"><span class="linenos">1820</span></a><span class="s2">	# Create .cursor/rules directory if it doesn&#39;t exist.</span>
</span><span id="ensure_makefile_task-1821"><a href="#ensure_makefile_task-1821"><span class="linenos">1821</span></a><span class="s2">	# Note: at the time of writing, cursor does not support generating .mdc files via Composer Agent.s</span>
</span><span id="ensure_makefile_task-1822"><a href="#ensure_makefile_task-1822"><span class="linenos">1822</span></a><span class="s2">	mkdir -p .cursor/rules || true</span>
</span><span id="ensure_makefile_task-1823"><a href="#ensure_makefile_task-1823"><span class="linenos">1823</span></a><span class="s2">	# Copy files from hack/prompts/drafts/cursor_rules to .cursor/rules and change extension to .mdc</span>
</span><span id="ensure_makefile_task-1824"><a href="#ensure_makefile_task-1824"><span class="linenos">1824</span></a><span class="s2">	# Exclude README.md files from being copied</span>
</span><span id="ensure_makefile_task-1825"><a href="#ensure_makefile_task-1825"><span class="linenos">1825</span></a><span class="s2">	find hack/drafts/cursor_rules -type f -name &quot;*.md&quot; ! -name &quot;README.md&quot; -exec sh -c &#39;for file; do target=$${file%.md}; cp -a &quot;$$file&quot; &quot;.cursor/rules/$$(basename &quot;$$target&quot;)&quot;; done&#39; sh </span><span class="si">{}</span><span class="s2"> +</span>
</span><span id="ensure_makefile_task-1826"><a href="#ensure_makefile_task-1826"><span class="linenos">1826</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="ensure_makefile_task-1827"><a href="#ensure_makefile_task-1827"><span class="linenos">1827</span></a>
</span><span id="ensure_makefile_task-1828"><a href="#ensure_makefile_task-1828"><span class="linenos">1828</span></a>    <span class="c1"># Define the operations to check if Makefile exists and contains the task</span>
</span><span id="ensure_makefile_task-1829"><a href="#ensure_makefile_task-1829"><span class="linenos">1829</span></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ensure_makefile_task-1830"><a href="#ensure_makefile_task-1830"><span class="linenos">1830</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;check_file_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">path_str</span><span class="p">},</span>
</span><span id="ensure_makefile_task-1831"><a href="#ensure_makefile_task-1831"><span class="linenos">1831</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">path_str</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">}},</span>
</span><span id="ensure_makefile_task-1832"><a href="#ensure_makefile_task-1832"><span class="linenos">1832</span></a>    <span class="p">]</span>
</span><span id="ensure_makefile_task-1833"><a href="#ensure_makefile_task-1833"><span class="linenos">1833</span></a>
</span><span id="ensure_makefile_task-1834"><a href="#ensure_makefile_task-1834"><span class="linenos">1834</span></a>    <span class="c1"># Return operations with instructions for the client</span>
</span><span id="ensure_makefile_task-1835"><a href="#ensure_makefile_task-1835"><span class="linenos">1835</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="ensure_makefile_task-1836"><a href="#ensure_makefile_task-1836"><span class="linenos">1836</span></a>        <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1837"><a href="#ensure_makefile_task-1837"><span class="linenos">1837</span></a>        <span class="s2">&quot;requires_result&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1838"><a href="#ensure_makefile_task-1838"><span class="linenos">1838</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Instructions to check Makefile and update if needed&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1839"><a href="#ensure_makefile_task-1839"><span class="linenos">1839</span></a>        <span class="s2">&quot;update_task_content&quot;</span><span class="p">:</span> <span class="n">update_task_content</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1840"><a href="#ensure_makefile_task-1840"><span class="linenos">1840</span></a>        <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;After applying these operations, you&#39;ll need to check if the Makefile exists and contains the update-cursor-rules task, then update or create it accordingly.&quot;</span><span class="p">,</span>
</span><span id="ensure_makefile_task-1841"><a href="#ensure_makefile_task-1841"><span class="linenos">1841</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Ensure the Makefile has the update-cursor-rules task.</p>

<p>This function checks if the Makefile exists and contains the update-cursor-rules task.
If the task doesn't exist, it returns instructions to add it to the Makefile.
If the Makefile doesn't exist, it returns instructions to create one with the task.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>makefile_path:</strong>  Path to the Makefile, defaults to "Makefile"</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing operations to perform and additional information</p>
</blockquote>
</div>


                </section>
                <section id="ensure_ai_report">
                            <input id="ensure_ai_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;ensure_ai_report&#39;, description=&#39;Check for the existence of an AI report file and ensure its content aligns with requirements&#39;)</div>

        <span class="def">def</span>
        <span class="name">ensure_ai_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">report_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;./ai_report.md&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Path to the AI report file, relative to the project root&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;./ai_report.md&#39;</span><span class="p">,</span> <span class="s1">&#39;./docs/ai_report.md&#39;</span><span class="p">,</span> <span class="s1">&#39;./reports/ai_report.md&#39;</span><span class="p">])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ensure_ai_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ensure_ai_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ensure_ai_report-1844"><a href="#ensure_ai_report-1844"><span class="linenos">1844</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="ensure_ai_report-1845"><a href="#ensure_ai_report-1845"><span class="linenos">1845</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ensure_ai_report&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1846"><a href="#ensure_ai_report-1846"><span class="linenos">1846</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Check for the existence of an AI report file and ensure its content aligns with requirements&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1847"><a href="#ensure_ai_report-1847"><span class="linenos">1847</span></a><span class="p">)</span>
</span><span id="ensure_ai_report-1848"><a href="#ensure_ai_report-1848"><span class="linenos">1848</span></a><span class="k">def</span><span class="w"> </span><span class="nf">ensure_ai_report</span><span class="p">(</span>
</span><span id="ensure_ai_report-1849"><a href="#ensure_ai_report-1849"><span class="linenos">1849</span></a>    <span class="n">report_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="ensure_ai_report-1850"><a href="#ensure_ai_report-1850"><span class="linenos">1850</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Path to the AI report file, relative to the project root&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1851"><a href="#ensure_ai_report-1851"><span class="linenos">1851</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span>
</span><span id="ensure_ai_report-1852"><a href="#ensure_ai_report-1852"><span class="linenos">1852</span></a>            <span class="s2">&quot;./ai_report.md&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1853"><a href="#ensure_ai_report-1853"><span class="linenos">1853</span></a>            <span class="s2">&quot;./docs/ai_report.md&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1854"><a href="#ensure_ai_report-1854"><span class="linenos">1854</span></a>            <span class="s2">&quot;./reports/ai_report.md&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1855"><a href="#ensure_ai_report-1855"><span class="linenos">1855</span></a>        <span class="p">],</span>
</span><span id="ensure_ai_report-1856"><a href="#ensure_ai_report-1856"><span class="linenos">1856</span></a>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;./ai_report.md&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1857"><a href="#ensure_ai_report-1857"><span class="linenos">1857</span></a>    <span class="p">),</span>
</span><span id="ensure_ai_report-1858"><a href="#ensure_ai_report-1858"><span class="linenos">1858</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="ensure_ai_report-1859"><a href="#ensure_ai_report-1859"><span class="linenos">1859</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for the existence of an AI report file and ensure its content aligns with requirements.</span>
</span><span id="ensure_ai_report-1860"><a href="#ensure_ai_report-1860"><span class="linenos">1860</span></a>
</span><span id="ensure_ai_report-1861"><a href="#ensure_ai_report-1861"><span class="linenos">1861</span></a><span class="sd">    This function verifies if the specified AI report file exists and contains all required sections.</span>
</span><span id="ensure_ai_report-1862"><a href="#ensure_ai_report-1862"><span class="linenos">1862</span></a><span class="sd">    If the file doesn&#39;t exist or is missing required sections, it provides instructions for remediation.</span>
</span><span id="ensure_ai_report-1863"><a href="#ensure_ai_report-1863"><span class="linenos">1863</span></a>
</span><span id="ensure_ai_report-1864"><a href="#ensure_ai_report-1864"><span class="linenos">1864</span></a><span class="sd">    Args:</span>
</span><span id="ensure_ai_report-1865"><a href="#ensure_ai_report-1865"><span class="linenos">1865</span></a><span class="sd">        report_path: Path to the AI report file, defaults to &quot;ai_report.md&quot;</span>
</span><span id="ensure_ai_report-1866"><a href="#ensure_ai_report-1866"><span class="linenos">1866</span></a>
</span><span id="ensure_ai_report-1867"><a href="#ensure_ai_report-1867"><span class="linenos">1867</span></a><span class="sd">    Returns:</span>
</span><span id="ensure_ai_report-1868"><a href="#ensure_ai_report-1868"><span class="linenos">1868</span></a><span class="sd">        dict[str, Any]: A dictionary containing status, operations, and guidance</span>
</span><span id="ensure_ai_report-1869"><a href="#ensure_ai_report-1869"><span class="linenos">1869</span></a>
</span><span id="ensure_ai_report-1870"><a href="#ensure_ai_report-1870"><span class="linenos">1870</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ensure_ai_report-1871"><a href="#ensure_ai_report-1871"><span class="linenos">1871</span></a>    <span class="c1"># Define the operations to check if the report file exists and read its content</span>
</span><span id="ensure_ai_report-1872"><a href="#ensure_ai_report-1872"><span class="linenos">1872</span></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ensure_ai_report-1873"><a href="#ensure_ai_report-1873"><span class="linenos">1873</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;check_file_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">report_path</span><span class="p">},</span>
</span><span id="ensure_ai_report-1874"><a href="#ensure_ai_report-1874"><span class="linenos">1874</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">report_path</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">}},</span>
</span><span id="ensure_ai_report-1875"><a href="#ensure_ai_report-1875"><span class="linenos">1875</span></a>    <span class="p">]</span>
</span><span id="ensure_ai_report-1876"><a href="#ensure_ai_report-1876"><span class="linenos">1876</span></a>
</span><span id="ensure_ai_report-1877"><a href="#ensure_ai_report-1877"><span class="linenos">1877</span></a>    <span class="c1"># Return payload with operations and additional information</span>
</span><span id="ensure_ai_report-1878"><a href="#ensure_ai_report-1878"><span class="linenos">1878</span></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ensure_ai_report-1879"><a href="#ensure_ai_report-1879"><span class="linenos">1879</span></a>        <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="ensure_ai_report-1880"><a href="#ensure_ai_report-1880"><span class="linenos">1880</span></a>        <span class="s2">&quot;requires_result&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ensure_ai_report-1881"><a href="#ensure_ai_report-1881"><span class="linenos">1881</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Instructions to check AI report file at </span><span class="si">{</span><span class="n">report_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1882"><a href="#ensure_ai_report-1882"><span class="linenos">1882</span></a>        <span class="s2">&quot;expected_sections&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="ensure_ai_report-1883"><a href="#ensure_ai_report-1883"><span class="linenos">1883</span></a>            <span class="s2">&quot;Project Overview&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1884"><a href="#ensure_ai_report-1884"><span class="linenos">1884</span></a>            <span class="s2">&quot;Repository Structure&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1885"><a href="#ensure_ai_report-1885"><span class="linenos">1885</span></a>            <span class="s2">&quot;Technology Stack&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1886"><a href="#ensure_ai_report-1886"><span class="linenos">1886</span></a>            <span class="s2">&quot;Application Structure&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1887"><a href="#ensure_ai_report-1887"><span class="linenos">1887</span></a>            <span class="s2">&quot;Deployment&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1888"><a href="#ensure_ai_report-1888"><span class="linenos">1888</span></a>            <span class="s2">&quot;Development Tools&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1889"><a href="#ensure_ai_report-1889"><span class="linenos">1889</span></a>            <span class="s2">&quot;Conclusion&quot;</span><span class="p">,</span>
</span><span id="ensure_ai_report-1890"><a href="#ensure_ai_report-1890"><span class="linenos">1890</span></a>        <span class="p">],</span>
</span><span id="ensure_ai_report-1891"><a href="#ensure_ai_report-1891"><span class="linenos">1891</span></a>    <span class="p">}</span>
</span><span id="ensure_ai_report-1892"><a href="#ensure_ai_report-1892"><span class="linenos">1892</span></a>
</span><span id="ensure_ai_report-1893"><a href="#ensure_ai_report-1893"><span class="linenos">1893</span></a>    <span class="k">return</span> <span class="n">payload</span>
</span></pre></div>


            <div class="docstring"><p>Check for the existence of an AI report file and ensure its content aligns with requirements.</p>

<p>This function verifies if the specified AI report file exists and contains all required sections.
If the file doesn't exist or is missing required sections, it provides instructions for remediation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>report_path:</strong>  Path to the AI report file, defaults to "ai_report.md"</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing status, operations, and guidance</p>
</blockquote>
</div>


                </section>
                <section id="run_update_cursor_rules">
                            <input id="run_update_cursor_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;run_update_cursor_rules&#39;, description=&#39;Run the update-cursor-rules Makefile task to deploy cursor rules&#39;)</div>

        <span class="def">def</span>
        <span class="name">run_update_cursor_rules</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="run_update_cursor_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#run_update_cursor_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="run_update_cursor_rules-1896"><a href="#run_update_cursor_rules-1896"><span class="linenos">1896</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="run_update_cursor_rules-1897"><a href="#run_update_cursor_rules-1897"><span class="linenos">1897</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;run_update_cursor_rules&quot;</span><span class="p">,</span>
</span><span id="run_update_cursor_rules-1898"><a href="#run_update_cursor_rules-1898"><span class="linenos">1898</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run the update-cursor-rules Makefile task to deploy cursor rules&quot;</span><span class="p">,</span>
</span><span id="run_update_cursor_rules-1899"><a href="#run_update_cursor_rules-1899"><span class="linenos">1899</span></a><span class="p">)</span>
</span><span id="run_update_cursor_rules-1900"><a href="#run_update_cursor_rules-1900"><span class="linenos">1900</span></a><span class="k">def</span><span class="w"> </span><span class="nf">run_update_cursor_rules</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="run_update_cursor_rules-1901"><a href="#run_update_cursor_rules-1901"><span class="linenos">1901</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the update-cursor-rules Makefile task to deploy cursor rules.</span>
</span><span id="run_update_cursor_rules-1902"><a href="#run_update_cursor_rules-1902"><span class="linenos">1902</span></a>
</span><span id="run_update_cursor_rules-1903"><a href="#run_update_cursor_rules-1903"><span class="linenos">1903</span></a><span class="sd">    This function returns instructions to execute the update-cursor-rules Makefile task</span>
</span><span id="run_update_cursor_rules-1904"><a href="#run_update_cursor_rules-1904"><span class="linenos">1904</span></a><span class="sd">    to deploy cursor rules from hack/drafts/cursor_rules to .cursor/rules.</span>
</span><span id="run_update_cursor_rules-1905"><a href="#run_update_cursor_rules-1905"><span class="linenos">1905</span></a>
</span><span id="run_update_cursor_rules-1906"><a href="#run_update_cursor_rules-1906"><span class="linenos">1906</span></a><span class="sd">    Returns:</span>
</span><span id="run_update_cursor_rules-1907"><a href="#run_update_cursor_rules-1907"><span class="linenos">1907</span></a><span class="sd">        dict[str, Any]: A dictionary containing operations to perform and additional information</span>
</span><span id="run_update_cursor_rules-1908"><a href="#run_update_cursor_rules-1908"><span class="linenos">1908</span></a>
</span><span id="run_update_cursor_rules-1909"><a href="#run_update_cursor_rules-1909"><span class="linenos">1909</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="run_update_cursor_rules-1910"><a href="#run_update_cursor_rules-1910"><span class="linenos">1910</span></a>    <span class="c1"># Define the operations to check if Makefile exists and contains the task</span>
</span><span id="run_update_cursor_rules-1911"><a href="#run_update_cursor_rules-1911"><span class="linenos">1911</span></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="run_update_cursor_rules-1912"><a href="#run_update_cursor_rules-1912"><span class="linenos">1912</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;check_file_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Makefile&quot;</span><span class="p">},</span>
</span><span id="run_update_cursor_rules-1913"><a href="#run_update_cursor_rules-1913"><span class="linenos">1913</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Makefile&quot;</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">}},</span>
</span><span id="run_update_cursor_rules-1914"><a href="#run_update_cursor_rules-1914"><span class="linenos">1914</span></a>    <span class="p">]</span>
</span><span id="run_update_cursor_rules-1915"><a href="#run_update_cursor_rules-1915"><span class="linenos">1915</span></a>
</span><span id="run_update_cursor_rules-1916"><a href="#run_update_cursor_rules-1916"><span class="linenos">1916</span></a>    <span class="c1"># Return operations with instructions for the client</span>
</span><span id="run_update_cursor_rules-1917"><a href="#run_update_cursor_rules-1917"><span class="linenos">1917</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="run_update_cursor_rules-1918"><a href="#run_update_cursor_rules-1918"><span class="linenos">1918</span></a>        <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="run_update_cursor_rules-1919"><a href="#run_update_cursor_rules-1919"><span class="linenos">1919</span></a>        <span class="s2">&quot;requires_result&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="run_update_cursor_rules-1920"><a href="#run_update_cursor_rules-1920"><span class="linenos">1920</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Instructions to check Makefile before running update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="run_update_cursor_rules-1921"><a href="#run_update_cursor_rules-1921"><span class="linenos">1921</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Run the update-cursor-rules Makefile task to deploy cursor rules.</p>

<p>This function returns instructions to execute the update-cursor-rules Makefile task
to deploy cursor rules from hack/drafts/cursor_rules to .cursor/rules.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing operations to perform and additional information</p>
</blockquote>
</div>


                </section>
                <section id="update_dockerignore">
                            <input id="update_dockerignore-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;update_dockerignore&#39;, description=&#39;Update the .dockerignore file to exclude the cursor rules drafts directory&#39;)</div>

        <span class="def">def</span>
        <span class="name">update_dockerignore</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="update_dockerignore-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#update_dockerignore"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="update_dockerignore-1924"><a href="#update_dockerignore-1924"><span class="linenos">1924</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="update_dockerignore-1925"><a href="#update_dockerignore-1925"><span class="linenos">1925</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;update_dockerignore&quot;</span><span class="p">,</span>
</span><span id="update_dockerignore-1926"><a href="#update_dockerignore-1926"><span class="linenos">1926</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Update the .dockerignore file to exclude the cursor rules drafts directory&quot;</span><span class="p">,</span>
</span><span id="update_dockerignore-1927"><a href="#update_dockerignore-1927"><span class="linenos">1927</span></a><span class="p">)</span>
</span><span id="update_dockerignore-1928"><a href="#update_dockerignore-1928"><span class="linenos">1928</span></a><span class="k">def</span><span class="w"> </span><span class="nf">update_dockerignore</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="update_dockerignore-1929"><a href="#update_dockerignore-1929"><span class="linenos">1929</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the .dockerignore file to exclude the cursor rules drafts directory.</span>
</span><span id="update_dockerignore-1930"><a href="#update_dockerignore-1930"><span class="linenos">1930</span></a>
</span><span id="update_dockerignore-1931"><a href="#update_dockerignore-1931"><span class="linenos">1931</span></a><span class="sd">    This function returns instructions to check if the .dockerignore file exists and add an entry</span>
</span><span id="update_dockerignore-1932"><a href="#update_dockerignore-1932"><span class="linenos">1932</span></a><span class="sd">    to exclude the cursor rules drafts directory if it doesn&#39;t already exist.</span>
</span><span id="update_dockerignore-1933"><a href="#update_dockerignore-1933"><span class="linenos">1933</span></a>
</span><span id="update_dockerignore-1934"><a href="#update_dockerignore-1934"><span class="linenos">1934</span></a><span class="sd">    Returns:</span>
</span><span id="update_dockerignore-1935"><a href="#update_dockerignore-1935"><span class="linenos">1935</span></a><span class="sd">        dict[str, Any]: A dictionary containing operations to perform and additional information</span>
</span><span id="update_dockerignore-1936"><a href="#update_dockerignore-1936"><span class="linenos">1936</span></a>
</span><span id="update_dockerignore-1937"><a href="#update_dockerignore-1937"><span class="linenos">1937</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="update_dockerignore-1938"><a href="#update_dockerignore-1938"><span class="linenos">1938</span></a>    <span class="c1"># The entry to add to .dockerignore</span>
</span><span id="update_dockerignore-1939"><a href="#update_dockerignore-1939"><span class="linenos">1939</span></a>    <span class="n">entry</span> <span class="o">=</span> <span class="s2">&quot;hack/drafts/cursor_rules&quot;</span>
</span><span id="update_dockerignore-1940"><a href="#update_dockerignore-1940"><span class="linenos">1940</span></a>
</span><span id="update_dockerignore-1941"><a href="#update_dockerignore-1941"><span class="linenos">1941</span></a>    <span class="c1"># Define the operations to check if .dockerignore exists and read its content</span>
</span><span id="update_dockerignore-1942"><a href="#update_dockerignore-1942"><span class="linenos">1942</span></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="update_dockerignore-1943"><a href="#update_dockerignore-1943"><span class="linenos">1943</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;check_file_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;.dockerignore&quot;</span><span class="p">},</span>
</span><span id="update_dockerignore-1944"><a href="#update_dockerignore-1944"><span class="linenos">1944</span></a>        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;read_file&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;.dockerignore&quot;</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">}},</span>
</span><span id="update_dockerignore-1945"><a href="#update_dockerignore-1945"><span class="linenos">1945</span></a>    <span class="p">]</span>
</span><span id="update_dockerignore-1946"><a href="#update_dockerignore-1946"><span class="linenos">1946</span></a>
</span><span id="update_dockerignore-1947"><a href="#update_dockerignore-1947"><span class="linenos">1947</span></a>    <span class="c1"># Return operations with instructions for the client</span>
</span><span id="update_dockerignore-1948"><a href="#update_dockerignore-1948"><span class="linenos">1948</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="update_dockerignore-1949"><a href="#update_dockerignore-1949"><span class="linenos">1949</span></a>        <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="n">operations</span><span class="p">,</span>
</span><span id="update_dockerignore-1950"><a href="#update_dockerignore-1950"><span class="linenos">1950</span></a>        <span class="s2">&quot;requires_result&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="update_dockerignore-1951"><a href="#update_dockerignore-1951"><span class="linenos">1951</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Instructions to check .dockerignore file&quot;</span><span class="p">,</span>
</span><span id="update_dockerignore-1952"><a href="#update_dockerignore-1952"><span class="linenos">1952</span></a>        <span class="s2">&quot;entry&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span>
</span><span id="update_dockerignore-1953"><a href="#update_dockerignore-1953"><span class="linenos">1953</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Update the .dockerignore file to exclude the cursor rules drafts directory.</p>

<p>This function returns instructions to check if the .dockerignore file exists and add an entry
to exclude the cursor rules drafts directory if it doesn't already exist.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing operations to perform and additional information</p>
</blockquote>
</div>


                </section>
                <section id="cursor_rules_workflow">
                            <input id="cursor_rules_workflow-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;cursor_rules_workflow&#39;, description=&#39;Execute the complete cursor rules workflow&#39;)</div>

        <span class="def">def</span>
        <span class="name">cursor_rules_workflow</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A list of cursor rule names to create (without file extensions)&#39;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;python-best-practices&#39;</span><span class="p">,</span> <span class="s1">&#39;react-component-structure&#39;</span><span class="p">,</span> <span class="s1">&#39;typescript-patterns&#39;</span><span class="p">])</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="cursor_rules_workflow-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#cursor_rules_workflow"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="cursor_rules_workflow-1956"><a href="#cursor_rules_workflow-1956"><span class="linenos">1956</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="cursor_rules_workflow-1957"><a href="#cursor_rules_workflow-1957"><span class="linenos">1957</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cursor_rules_workflow&quot;</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-1958"><a href="#cursor_rules_workflow-1958"><span class="linenos">1958</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Execute the complete cursor rules workflow&quot;</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-1959"><a href="#cursor_rules_workflow-1959"><span class="linenos">1959</span></a><span class="p">)</span>
</span><span id="cursor_rules_workflow-1960"><a href="#cursor_rules_workflow-1960"><span class="linenos">1960</span></a><span class="k">def</span><span class="w"> </span><span class="nf">cursor_rules_workflow</span><span class="p">(</span>
</span><span id="cursor_rules_workflow-1961"><a href="#cursor_rules_workflow-1961"><span class="linenos">1961</span></a>    <span class="n">rule_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="cursor_rules_workflow-1962"><a href="#cursor_rules_workflow-1962"><span class="linenos">1962</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A list of cursor rule names to create (without file extensions)&quot;</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-1963"><a href="#cursor_rules_workflow-1963"><span class="linenos">1963</span></a>        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python-best-practices&quot;</span><span class="p">,</span> <span class="s2">&quot;react-component-structure&quot;</span><span class="p">,</span> <span class="s2">&quot;typescript-patterns&quot;</span><span class="p">],</span>
</span><span id="cursor_rules_workflow-1964"><a href="#cursor_rules_workflow-1964"><span class="linenos">1964</span></a>    <span class="p">),</span>
</span><span id="cursor_rules_workflow-1965"><a href="#cursor_rules_workflow-1965"><span class="linenos">1965</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="cursor_rules_workflow-1966"><a href="#cursor_rules_workflow-1966"><span class="linenos">1966</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the complete cursor rules workflow.</span>
</span><span id="cursor_rules_workflow-1967"><a href="#cursor_rules_workflow-1967"><span class="linenos">1967</span></a>
</span><span id="cursor_rules_workflow-1968"><a href="#cursor_rules_workflow-1968"><span class="linenos">1968</span></a><span class="sd">    Args:</span>
</span><span id="cursor_rules_workflow-1969"><a href="#cursor_rules_workflow-1969"><span class="linenos">1969</span></a><span class="sd">        rule_names: A list of cursor rule names to create (without file extensions)</span>
</span><span id="cursor_rules_workflow-1970"><a href="#cursor_rules_workflow-1970"><span class="linenos">1970</span></a>
</span><span id="cursor_rules_workflow-1971"><a href="#cursor_rules_workflow-1971"><span class="linenos">1971</span></a><span class="sd">    Returns:</span>
</span><span id="cursor_rules_workflow-1972"><a href="#cursor_rules_workflow-1972"><span class="linenos">1972</span></a><span class="sd">        dict[str, Any]: A dictionary containing operations to perform and additional information</span>
</span><span id="cursor_rules_workflow-1973"><a href="#cursor_rules_workflow-1973"><span class="linenos">1973</span></a>
</span><span id="cursor_rules_workflow-1974"><a href="#cursor_rules_workflow-1974"><span class="linenos">1974</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="cursor_rules_workflow-1975"><a href="#cursor_rules_workflow-1975"><span class="linenos">1975</span></a>    <span class="c1"># First call prep_workspace directly</span>
</span><span id="cursor_rules_workflow-1976"><a href="#cursor_rules_workflow-1976"><span class="linenos">1976</span></a>    <span class="n">workspace_result</span> <span class="o">=</span> <span class="n">prep_workspace</span><span class="p">()</span>
</span><span id="cursor_rules_workflow-1977"><a href="#cursor_rules_workflow-1977"><span class="linenos">1977</span></a>
</span><span id="cursor_rules_workflow-1978"><a href="#cursor_rules_workflow-1978"><span class="linenos">1978</span></a>    <span class="c1"># Call create_cursor_rule_files directly</span>
</span><span id="cursor_rules_workflow-1979"><a href="#cursor_rules_workflow-1979"><span class="linenos">1979</span></a>    <span class="n">files_result</span> <span class="o">=</span> <span class="n">create_cursor_rule_files</span><span class="p">(</span><span class="n">rule_names</span><span class="p">)</span>
</span><span id="cursor_rules_workflow-1980"><a href="#cursor_rules_workflow-1980"><span class="linenos">1980</span></a>
</span><span id="cursor_rules_workflow-1981"><a href="#cursor_rules_workflow-1981"><span class="linenos">1981</span></a>    <span class="c1"># Call ensure_makefile_task directly</span>
</span><span id="cursor_rules_workflow-1982"><a href="#cursor_rules_workflow-1982"><span class="linenos">1982</span></a>    <span class="n">makefile_result</span> <span class="o">=</span> <span class="n">ensure_makefile_task</span><span class="p">()</span>
</span><span id="cursor_rules_workflow-1983"><a href="#cursor_rules_workflow-1983"><span class="linenos">1983</span></a>
</span><span id="cursor_rules_workflow-1984"><a href="#cursor_rules_workflow-1984"><span class="linenos">1984</span></a>    <span class="c1"># Call update_dockerignore directly</span>
</span><span id="cursor_rules_workflow-1985"><a href="#cursor_rules_workflow-1985"><span class="linenos">1985</span></a>    <span class="n">dockerignore_result</span> <span class="o">=</span> <span class="n">update_dockerignore</span><span class="p">()</span>
</span><span id="cursor_rules_workflow-1986"><a href="#cursor_rules_workflow-1986"><span class="linenos">1986</span></a>
</span><span id="cursor_rules_workflow-1987"><a href="#cursor_rules_workflow-1987"><span class="linenos">1987</span></a>    <span class="c1"># Prepare next steps message</span>
</span><span id="cursor_rules_workflow-1988"><a href="#cursor_rules_workflow-1988"><span class="linenos">1988</span></a>    <span class="n">next_steps</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="cursor_rules_workflow-1989"><a href="#cursor_rules_workflow-1989"><span class="linenos">1989</span></a><span class="s2">Workflow completed successfully. Next steps:</span>
</span><span id="cursor_rules_workflow-1990"><a href="#cursor_rules_workflow-1990"><span class="linenos">1990</span></a>
</span><span id="cursor_rules_workflow-1991"><a href="#cursor_rules_workflow-1991"><span class="linenos">1991</span></a><span class="s2">1. Write content to each cursor rule file sequentially:</span>
</span><span id="cursor_rules_workflow-1992"><a href="#cursor_rules_workflow-1992"><span class="linenos">1992</span></a><span class="s2">   - Edit each file to add the cursor rule content</span>
</span><span id="cursor_rules_workflow-1993"><a href="#cursor_rules_workflow-1993"><span class="linenos">1993</span></a><span class="s2">   - Save each file after editing</span>
</span><span id="cursor_rules_workflow-1994"><a href="#cursor_rules_workflow-1994"><span class="linenos">1994</span></a>
</span><span id="cursor_rules_workflow-1995"><a href="#cursor_rules_workflow-1995"><span class="linenos">1995</span></a><span class="s2">2. Deploy the cursor rules:</span>
</span><span id="cursor_rules_workflow-1996"><a href="#cursor_rules_workflow-1996"><span class="linenos">1996</span></a><span class="s2">   - Run &#39;make update-cursor-rules&#39; to deploy the cursor rules to .cursor/rules</span>
</span><span id="cursor_rules_workflow-1997"><a href="#cursor_rules_workflow-1997"><span class="linenos">1997</span></a><span class="s2">   - Verify the rules are correctly deployed</span>
</span><span id="cursor_rules_workflow-1998"><a href="#cursor_rules_workflow-1998"><span class="linenos">1998</span></a>
</span><span id="cursor_rules_workflow-1999"><a href="#cursor_rules_workflow-1999"><span class="linenos">1999</span></a><span class="s2">3. Test the cursor rules:</span>
</span><span id="cursor_rules_workflow-2000"><a href="#cursor_rules_workflow-2000"><span class="linenos">2000</span></a><span class="s2">   - Open a file that should trigger a cursor rule</span>
</span><span id="cursor_rules_workflow-2001"><a href="#cursor_rules_workflow-2001"><span class="linenos">2001</span></a><span class="s2">   - Verify that the cursor rule is applied correctly</span>
</span><span id="cursor_rules_workflow-2002"><a href="#cursor_rules_workflow-2002"><span class="linenos">2002</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="cursor_rules_workflow-2003"><a href="#cursor_rules_workflow-2003"><span class="linenos">2003</span></a>
</span><span id="cursor_rules_workflow-2004"><a href="#cursor_rules_workflow-2004"><span class="linenos">2004</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="cursor_rules_workflow-2005"><a href="#cursor_rules_workflow-2005"><span class="linenos">2005</span></a>        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2006"><a href="#cursor_rules_workflow-2006"><span class="linenos">2006</span></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Instructions to execute the cursor rules workflow for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rule_names</span><span class="p">)</span><span class="si">}</span><span class="s2"> rule(s): </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rule_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2007"><a href="#cursor_rules_workflow-2007"><span class="linenos">2007</span></a>        <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="n">next_steps</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2008"><a href="#cursor_rules_workflow-2008"><span class="linenos">2008</span></a>        <span class="s2">&quot;workspace_result&quot;</span><span class="p">:</span> <span class="n">workspace_result</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2009"><a href="#cursor_rules_workflow-2009"><span class="linenos">2009</span></a>        <span class="s2">&quot;files_result&quot;</span><span class="p">:</span> <span class="n">files_result</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2010"><a href="#cursor_rules_workflow-2010"><span class="linenos">2010</span></a>        <span class="s2">&quot;makefile_result&quot;</span><span class="p">:</span> <span class="n">makefile_result</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2011"><a href="#cursor_rules_workflow-2011"><span class="linenos">2011</span></a>        <span class="s2">&quot;dockerignore_result&quot;</span><span class="p">:</span> <span class="n">dockerignore_result</span><span class="p">,</span>
</span><span id="cursor_rules_workflow-2012"><a href="#cursor_rules_workflow-2012"><span class="linenos">2012</span></a>        <span class="s2">&quot;created_files&quot;</span><span class="p">:</span> <span class="n">files_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_files&quot;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="cursor_rules_workflow-2013"><a href="#cursor_rules_workflow-2013"><span class="linenos">2013</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute the complete cursor rules workflow.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_names:</strong>  A list of cursor rule names to create (without file extensions)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: A dictionary containing operations to perform and additional information</p>
</blockquote>
</div>


                </section>
                <section id="repo_analysis_prompt">
                            <input id="repo_analysis_prompt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.prompt">@mcp.prompt(name=&#39;repo-analysis&#39;, description=&#39;Analyze a repository to gather information for cursor rule creation&#39;)</div>

        <span class="def">def</span>
        <span class="name">repo_analysis_prompt</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">repo_description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">main_languages</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">key_features</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ctx</span><span class="p">:</span> <span class="n">mcp</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">fastmcp</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="repo_analysis_prompt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#repo_analysis_prompt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="repo_analysis_prompt-861"><a href="#repo_analysis_prompt-861"><span class="linenos">861</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;repo-analysis&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyze a repository to gather information for cursor rule creation&quot;</span><span class="p">)</span>
</span><span id="repo_analysis_prompt-862"><a href="#repo_analysis_prompt-862"><span class="linenos">862</span></a><span class="k">def</span><span class="w"> </span><span class="nf">repo_analysis_prompt</span><span class="p">(</span>
</span><span id="repo_analysis_prompt-863"><a href="#repo_analysis_prompt-863"><span class="linenos">863</span></a>    <span class="n">repo_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">main_languages</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key_features</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="repo_analysis_prompt-864"><a href="#repo_analysis_prompt-864"><span class="linenos">864</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</span><span id="repo_analysis_prompt-865"><a href="#repo_analysis_prompt-865"><span class="linenos">865</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prompt for analyzing a repository to gather information for cursor rule creation.</span>
</span><span id="repo_analysis_prompt-866"><a href="#repo_analysis_prompt-866"><span class="linenos">866</span></a>
</span><span id="repo_analysis_prompt-867"><a href="#repo_analysis_prompt-867"><span class="linenos">867</span></a><span class="sd">    Args:</span>
</span><span id="repo_analysis_prompt-868"><a href="#repo_analysis_prompt-868"><span class="linenos">868</span></a><span class="sd">        repo_description: Description of the repository and its purpose</span>
</span><span id="repo_analysis_prompt-869"><a href="#repo_analysis_prompt-869"><span class="linenos">869</span></a><span class="sd">        main_languages: Main programming languages used in the repository</span>
</span><span id="repo_analysis_prompt-870"><a href="#repo_analysis_prompt-870"><span class="linenos">870</span></a><span class="sd">        file_patterns: Common file patterns in the repository</span>
</span><span id="repo_analysis_prompt-871"><a href="#repo_analysis_prompt-871"><span class="linenos">871</span></a><span class="sd">        key_features: Key features or components of the repository</span>
</span><span id="repo_analysis_prompt-872"><a href="#repo_analysis_prompt-872"><span class="linenos">872</span></a><span class="sd">        ctx: The MCP context (optional)</span>
</span><span id="repo_analysis_prompt-873"><a href="#repo_analysis_prompt-873"><span class="linenos">873</span></a>
</span><span id="repo_analysis_prompt-874"><a href="#repo_analysis_prompt-874"><span class="linenos">874</span></a><span class="sd">    Returns:</span>
</span><span id="repo_analysis_prompt-875"><a href="#repo_analysis_prompt-875"><span class="linenos">875</span></a><span class="sd">        List[Dict[str, Any]]: List of messages for the prompt</span>
</span><span id="repo_analysis_prompt-876"><a href="#repo_analysis_prompt-876"><span class="linenos">876</span></a>
</span><span id="repo_analysis_prompt-877"><a href="#repo_analysis_prompt-877"><span class="linenos">877</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="repo_analysis_prompt-878"><a href="#repo_analysis_prompt-878"><span class="linenos">878</span></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="repo_analysis_prompt-879"><a href="#repo_analysis_prompt-879"><span class="linenos">879</span></a>        <span class="p">{</span>
</span><span id="repo_analysis_prompt-880"><a href="#repo_analysis_prompt-880"><span class="linenos">880</span></a>            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="repo_analysis_prompt-881"><a href="#repo_analysis_prompt-881"><span class="linenos">881</span></a>            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="repo_analysis_prompt-882"><a href="#repo_analysis_prompt-882"><span class="linenos">882</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="repo_analysis_prompt-883"><a href="#repo_analysis_prompt-883"><span class="linenos">883</span></a>                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;I need to analyze a repository to create a cursor rule. Here&#39;s the information:</span>
</span><span id="repo_analysis_prompt-884"><a href="#repo_analysis_prompt-884"><span class="linenos">884</span></a>
</span><span id="repo_analysis_prompt-885"><a href="#repo_analysis_prompt-885"><span class="linenos">885</span></a><span class="s2">Repository Description:</span>
</span><span id="repo_analysis_prompt-886"><a href="#repo_analysis_prompt-886"><span class="linenos">886</span></a><span class="si">{</span><span class="n">repo_description</span><span class="si">}</span>
</span><span id="repo_analysis_prompt-887"><a href="#repo_analysis_prompt-887"><span class="linenos">887</span></a>
</span><span id="repo_analysis_prompt-888"><a href="#repo_analysis_prompt-888"><span class="linenos">888</span></a><span class="s2">Main Languages:</span>
</span><span id="repo_analysis_prompt-889"><a href="#repo_analysis_prompt-889"><span class="linenos">889</span></a><span class="si">{</span><span class="n">main_languages</span><span class="si">}</span>
</span><span id="repo_analysis_prompt-890"><a href="#repo_analysis_prompt-890"><span class="linenos">890</span></a>
</span><span id="repo_analysis_prompt-891"><a href="#repo_analysis_prompt-891"><span class="linenos">891</span></a><span class="s2">File Patterns:</span>
</span><span id="repo_analysis_prompt-892"><a href="#repo_analysis_prompt-892"><span class="linenos">892</span></a><span class="si">{</span><span class="n">file_patterns</span><span class="si">}</span>
</span><span id="repo_analysis_prompt-893"><a href="#repo_analysis_prompt-893"><span class="linenos">893</span></a>
</span><span id="repo_analysis_prompt-894"><a href="#repo_analysis_prompt-894"><span class="linenos">894</span></a><span class="s2">Key Features:</span>
</span><span id="repo_analysis_prompt-895"><a href="#repo_analysis_prompt-895"><span class="linenos">895</span></a><span class="si">{</span><span class="n">key_features</span><span class="si">}</span>
</span><span id="repo_analysis_prompt-896"><a href="#repo_analysis_prompt-896"><span class="linenos">896</span></a>
</span><span id="repo_analysis_prompt-897"><a href="#repo_analysis_prompt-897"><span class="linenos">897</span></a><span class="s2">Based on this information, what types of cursor rules would be most beneficial for this repository?</span>
</span><span id="repo_analysis_prompt-898"><a href="#repo_analysis_prompt-898"><span class="linenos">898</span></a><span class="s2">What patterns should I look for in the code?</span>
</span><span id="repo_analysis_prompt-899"><a href="#repo_analysis_prompt-899"><span class="linenos">899</span></a><span class="s2">What best practices should I enforce?</span>
</span><span id="repo_analysis_prompt-900"><a href="#repo_analysis_prompt-900"><span class="linenos">900</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="repo_analysis_prompt-901"><a href="#repo_analysis_prompt-901"><span class="linenos">901</span></a>            <span class="p">},</span>
</span><span id="repo_analysis_prompt-902"><a href="#repo_analysis_prompt-902"><span class="linenos">902</span></a>        <span class="p">}</span>
</span><span id="repo_analysis_prompt-903"><a href="#repo_analysis_prompt-903"><span class="linenos">903</span></a>    <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Prompt for analyzing a repository to gather information for cursor rule creation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>repo_description:</strong>  Description of the repository and its purpose</li>
<li><strong>main_languages:</strong>  Main programming languages used in the repository</li>
<li><strong>file_patterns:</strong>  Common file patterns in the repository</li>
<li><strong>key_features:</strong>  Key features or components of the repository</li>
<li><strong>ctx:</strong>  The MCP context (optional)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List[Dict[str, Any]]: List of messages for the prompt</p>
</blockquote>
</div>


                </section>
                <section id="generate_cursor_rule_prompt">
                            <input id="generate_cursor_rule_prompt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.prompt">@mcp.prompt(name=&#39;generate-cursor-rule&#39;, description=&#39;Generate a custom cursor rule based on repository information&#39;)</div>

        <span class="def">def</span>
        <span class="name">generate_cursor_rule_prompt</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">description</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">content_patterns</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">action_message</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">examples</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">tags</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span>,</span><span class="param">	<span class="n">template_rule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ctx</span><span class="p">:</span> <span class="n">mcp</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">fastmcp</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="generate_cursor_rule_prompt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_cursor_rule_prompt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_cursor_rule_prompt-906"><a href="#generate_cursor_rule_prompt-906"><span class="linenos">906</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;generate-cursor-rule&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Generate a custom cursor rule based on repository information&quot;</span><span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-907"><a href="#generate_cursor_rule_prompt-907"><span class="linenos">907</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_cursor_rule_prompt</span><span class="p">(</span>
</span><span id="generate_cursor_rule_prompt-908"><a href="#generate_cursor_rule_prompt-908"><span class="linenos">908</span></a>    <span class="n">rule_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-909"><a href="#generate_cursor_rule_prompt-909"><span class="linenos">909</span></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-910"><a href="#generate_cursor_rule_prompt-910"><span class="linenos">910</span></a>    <span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-911"><a href="#generate_cursor_rule_prompt-911"><span class="linenos">911</span></a>    <span class="n">content_patterns</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-912"><a href="#generate_cursor_rule_prompt-912"><span class="linenos">912</span></a>    <span class="n">action_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-913"><a href="#generate_cursor_rule_prompt-913"><span class="linenos">913</span></a>    <span class="n">examples</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-914"><a href="#generate_cursor_rule_prompt-914"><span class="linenos">914</span></a>    <span class="n">tags</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-915"><a href="#generate_cursor_rule_prompt-915"><span class="linenos">915</span></a>    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-916"><a href="#generate_cursor_rule_prompt-916"><span class="linenos">916</span></a>    <span class="n">template_rule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-917"><a href="#generate_cursor_rule_prompt-917"><span class="linenos">917</span></a>    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-918"><a href="#generate_cursor_rule_prompt-918"><span class="linenos">918</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</span><span id="generate_cursor_rule_prompt-919"><a href="#generate_cursor_rule_prompt-919"><span class="linenos">919</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prompt for generating a custom cursor rule.</span>
</span><span id="generate_cursor_rule_prompt-920"><a href="#generate_cursor_rule_prompt-920"><span class="linenos">920</span></a>
</span><span id="generate_cursor_rule_prompt-921"><a href="#generate_cursor_rule_prompt-921"><span class="linenos">921</span></a><span class="sd">    Args:</span>
</span><span id="generate_cursor_rule_prompt-922"><a href="#generate_cursor_rule_prompt-922"><span class="linenos">922</span></a><span class="sd">        rule_name: Name of the cursor rule (kebab-case)</span>
</span><span id="generate_cursor_rule_prompt-923"><a href="#generate_cursor_rule_prompt-923"><span class="linenos">923</span></a><span class="sd">        description: Description of the cursor rule</span>
</span><span id="generate_cursor_rule_prompt-924"><a href="#generate_cursor_rule_prompt-924"><span class="linenos">924</span></a><span class="sd">        file_patterns: File patterns to match (comma-separated)</span>
</span><span id="generate_cursor_rule_prompt-925"><a href="#generate_cursor_rule_prompt-925"><span class="linenos">925</span></a><span class="sd">        content_patterns: Content patterns to match (comma-separated)</span>
</span><span id="generate_cursor_rule_prompt-926"><a href="#generate_cursor_rule_prompt-926"><span class="linenos">926</span></a><span class="sd">        action_message: Message to display when the rule is triggered</span>
</span><span id="generate_cursor_rule_prompt-927"><a href="#generate_cursor_rule_prompt-927"><span class="linenos">927</span></a><span class="sd">        examples: Examples in JSON format</span>
</span><span id="generate_cursor_rule_prompt-928"><a href="#generate_cursor_rule_prompt-928"><span class="linenos">928</span></a><span class="sd">        tags: Tags for the rule (comma-separated)</span>
</span><span id="generate_cursor_rule_prompt-929"><a href="#generate_cursor_rule_prompt-929"><span class="linenos">929</span></a><span class="sd">        priority: Priority of the rule (high, medium, low)</span>
</span><span id="generate_cursor_rule_prompt-930"><a href="#generate_cursor_rule_prompt-930"><span class="linenos">930</span></a><span class="sd">        template_rule: Optional template rule name to base the new rule on</span>
</span><span id="generate_cursor_rule_prompt-931"><a href="#generate_cursor_rule_prompt-931"><span class="linenos">931</span></a><span class="sd">        ctx: The MCP context (optional)</span>
</span><span id="generate_cursor_rule_prompt-932"><a href="#generate_cursor_rule_prompt-932"><span class="linenos">932</span></a>
</span><span id="generate_cursor_rule_prompt-933"><a href="#generate_cursor_rule_prompt-933"><span class="linenos">933</span></a><span class="sd">    Returns:</span>
</span><span id="generate_cursor_rule_prompt-934"><a href="#generate_cursor_rule_prompt-934"><span class="linenos">934</span></a><span class="sd">        List[Dict[str, Any]]: List of messages for the prompt</span>
</span><span id="generate_cursor_rule_prompt-935"><a href="#generate_cursor_rule_prompt-935"><span class="linenos">935</span></a>
</span><span id="generate_cursor_rule_prompt-936"><a href="#generate_cursor_rule_prompt-936"><span class="linenos">936</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_cursor_rule_prompt-937"><a href="#generate_cursor_rule_prompt-937"><span class="linenos">937</span></a>    <span class="c1"># Parse inputs</span>
</span><span id="generate_cursor_rule_prompt-938"><a href="#generate_cursor_rule_prompt-938"><span class="linenos">938</span></a>    <span class="n">file_patterns_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">file_patterns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
</span><span id="generate_cursor_rule_prompt-939"><a href="#generate_cursor_rule_prompt-939"><span class="linenos">939</span></a>    <span class="n">content_patterns_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">content_patterns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
</span><span id="generate_cursor_rule_prompt-940"><a href="#generate_cursor_rule_prompt-940"><span class="linenos">940</span></a>    <span class="n">tags_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
</span><span id="generate_cursor_rule_prompt-941"><a href="#generate_cursor_rule_prompt-941"><span class="linenos">941</span></a>
</span><span id="generate_cursor_rule_prompt-942"><a href="#generate_cursor_rule_prompt-942"><span class="linenos">942</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="generate_cursor_rule_prompt-943"><a href="#generate_cursor_rule_prompt-943"><span class="linenos">943</span></a>        <span class="n">examples_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-944"><a href="#generate_cursor_rule_prompt-944"><span class="linenos">944</span></a>    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
</span><span id="generate_cursor_rule_prompt-945"><a href="#generate_cursor_rule_prompt-945"><span class="linenos">945</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Examples must be valid JSON&quot;</span><span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-946"><a href="#generate_cursor_rule_prompt-946"><span class="linenos">946</span></a>
</span><span id="generate_cursor_rule_prompt-947"><a href="#generate_cursor_rule_prompt-947"><span class="linenos">947</span></a>    <span class="c1"># Generate the cursor rule</span>
</span><span id="generate_cursor_rule_prompt-948"><a href="#generate_cursor_rule_prompt-948"><span class="linenos">948</span></a>    <span class="n">template_content</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="generate_cursor_rule_prompt-949"><a href="#generate_cursor_rule_prompt-949"><span class="linenos">949</span></a>    <span class="k">if</span> <span class="n">template_rule</span><span class="p">:</span>
</span><span id="generate_cursor_rule_prompt-950"><a href="#generate_cursor_rule_prompt-950"><span class="linenos">950</span></a>        <span class="n">template_content</span> <span class="o">=</span> <span class="n">read_cursor_rule</span><span class="p">(</span><span class="n">template_rule</span><span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-951"><a href="#generate_cursor_rule_prompt-951"><span class="linenos">951</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">template_content</span> <span class="ow">and</span> <span class="n">ctx</span><span class="p">:</span>
</span><span id="generate_cursor_rule_prompt-952"><a href="#generate_cursor_rule_prompt-952"><span class="linenos">952</span></a>            <span class="n">ctx</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template rule &#39;</span><span class="si">{</span><span class="n">template_rule</span><span class="si">}</span><span class="s2">&#39; not found, generating without template&quot;</span><span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-953"><a href="#generate_cursor_rule_prompt-953"><span class="linenos">953</span></a>
</span><span id="generate_cursor_rule_prompt-954"><a href="#generate_cursor_rule_prompt-954"><span class="linenos">954</span></a>    <span class="c1"># Generate the cursor rule</span>
</span><span id="generate_cursor_rule_prompt-955"><a href="#generate_cursor_rule_prompt-955"><span class="linenos">955</span></a>    <span class="n">generated_rule</span> <span class="o">=</span> <span class="n">generate_cursor_rule</span><span class="p">(</span>
</span><span id="generate_cursor_rule_prompt-956"><a href="#generate_cursor_rule_prompt-956"><span class="linenos">956</span></a>        <span class="n">rule_name</span><span class="o">=</span><span class="n">rule_name</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-957"><a href="#generate_cursor_rule_prompt-957"><span class="linenos">957</span></a>        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-958"><a href="#generate_cursor_rule_prompt-958"><span class="linenos">958</span></a>        <span class="n">file_patterns</span><span class="o">=</span><span class="n">file_patterns_list</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-959"><a href="#generate_cursor_rule_prompt-959"><span class="linenos">959</span></a>        <span class="n">content_patterns</span><span class="o">=</span><span class="n">content_patterns_list</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-960"><a href="#generate_cursor_rule_prompt-960"><span class="linenos">960</span></a>        <span class="n">action_message</span><span class="o">=</span><span class="n">action_message</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-961"><a href="#generate_cursor_rule_prompt-961"><span class="linenos">961</span></a>        <span class="n">examples</span><span class="o">=</span><span class="n">examples_list</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-962"><a href="#generate_cursor_rule_prompt-962"><span class="linenos">962</span></a>        <span class="n">tags</span><span class="o">=</span><span class="n">tags_list</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-963"><a href="#generate_cursor_rule_prompt-963"><span class="linenos">963</span></a>        <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-964"><a href="#generate_cursor_rule_prompt-964"><span class="linenos">964</span></a>    <span class="p">)</span>
</span><span id="generate_cursor_rule_prompt-965"><a href="#generate_cursor_rule_prompt-965"><span class="linenos">965</span></a>
</span><span id="generate_cursor_rule_prompt-966"><a href="#generate_cursor_rule_prompt-966"><span class="linenos">966</span></a>    <span class="k">return</span> <span class="p">[</span>
</span><span id="generate_cursor_rule_prompt-967"><a href="#generate_cursor_rule_prompt-967"><span class="linenos">967</span></a>        <span class="p">{</span>
</span><span id="generate_cursor_rule_prompt-968"><a href="#generate_cursor_rule_prompt-968"><span class="linenos">968</span></a>            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-969"><a href="#generate_cursor_rule_prompt-969"><span class="linenos">969</span></a>            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="generate_cursor_rule_prompt-970"><a href="#generate_cursor_rule_prompt-970"><span class="linenos">970</span></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-971"><a href="#generate_cursor_rule_prompt-971"><span class="linenos">971</span></a>                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;I&#39;ve generated a cursor rule based on your specifications:</span>
</span><span id="generate_cursor_rule_prompt-972"><a href="#generate_cursor_rule_prompt-972"><span class="linenos">972</span></a>
</span><span id="generate_cursor_rule_prompt-973"><a href="#generate_cursor_rule_prompt-973"><span class="linenos">973</span></a><span class="s2">```markdown</span>
</span><span id="generate_cursor_rule_prompt-974"><a href="#generate_cursor_rule_prompt-974"><span class="linenos">974</span></a><span class="si">{</span><span class="n">generated_rule</span><span class="si">}</span>
</span><span id="generate_cursor_rule_prompt-975"><a href="#generate_cursor_rule_prompt-975"><span class="linenos">975</span></a><span class="s2">```</span>
</span><span id="generate_cursor_rule_prompt-976"><a href="#generate_cursor_rule_prompt-976"><span class="linenos">976</span></a>
</span><span id="generate_cursor_rule_prompt-977"><a href="#generate_cursor_rule_prompt-977"><span class="linenos">977</span></a><span class="s2">This cursor rule:</span>
</span><span id="generate_cursor_rule_prompt-978"><a href="#generate_cursor_rule_prompt-978"><span class="linenos">978</span></a><span class="s2">1. Matches files with patterns: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_patterns_list</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_cursor_rule_prompt-979"><a href="#generate_cursor_rule_prompt-979"><span class="linenos">979</span></a><span class="s2">2. Looks for content patterns: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content_patterns_list</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_cursor_rule_prompt-980"><a href="#generate_cursor_rule_prompt-980"><span class="linenos">980</span></a><span class="s2">3. Provides suggestions when triggered</span>
</span><span id="generate_cursor_rule_prompt-981"><a href="#generate_cursor_rule_prompt-981"><span class="linenos">981</span></a><span class="s2">4. Includes </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">examples_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> examples</span>
</span><span id="generate_cursor_rule_prompt-982"><a href="#generate_cursor_rule_prompt-982"><span class="linenos">982</span></a><span class="s2">5. Has tags: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags_list</span><span class="p">)</span><span class="si">}</span>
</span><span id="generate_cursor_rule_prompt-983"><a href="#generate_cursor_rule_prompt-983"><span class="linenos">983</span></a><span class="s2">6. Priority: </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span>
</span><span id="generate_cursor_rule_prompt-984"><a href="#generate_cursor_rule_prompt-984"><span class="linenos">984</span></a>
</span><span id="generate_cursor_rule_prompt-985"><a href="#generate_cursor_rule_prompt-985"><span class="linenos">985</span></a><span class="s2">You can save this to a file named `</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc.md` in your cursor rules directory.</span>
</span><span id="generate_cursor_rule_prompt-986"><a href="#generate_cursor_rule_prompt-986"><span class="linenos">986</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="generate_cursor_rule_prompt-987"><a href="#generate_cursor_rule_prompt-987"><span class="linenos">987</span></a>            <span class="p">},</span>
</span><span id="generate_cursor_rule_prompt-988"><a href="#generate_cursor_rule_prompt-988"><span class="linenos">988</span></a>        <span class="p">}</span>
</span><span id="generate_cursor_rule_prompt-989"><a href="#generate_cursor_rule_prompt-989"><span class="linenos">989</span></a>    <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Prompt for generating a custom cursor rule.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rule_name:</strong>  Name of the cursor rule (kebab-case)</li>
<li><strong>description:</strong>  Description of the cursor rule</li>
<li><strong>file_patterns:</strong>  File patterns to match (comma-separated)</li>
<li><strong>content_patterns:</strong>  Content patterns to match (comma-separated)</li>
<li><strong>action_message:</strong>  Message to display when the rule is triggered</li>
<li><strong>examples:</strong>  Examples in JSON format</li>
<li><strong>tags:</strong>  Tags for the rule (comma-separated)</li>
<li><strong>priority:</strong>  Priority of the rule (high, medium, low)</li>
<li><strong>template_rule:</strong>  Optional template rule name to base the new rule on</li>
<li><strong>ctx:</strong>  The MCP context (optional)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List[Dict[str, Any]]: List of messages for the prompt</p>
</blockquote>
</div>


                </section>
                <section id="plan_and_execute_prompt_library_workflow">
                            <input id="plan_and_execute_prompt_library_workflow-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-mcp.tool">@mcp.tool(name=&#39;plan_and_execute_prompt_library_workflow&#39;, description=&#39;Execute a structured workflow for generating custom cursor rules based on repository analysis&#39;)</div>

        <span class="def">def</span>
        <span class="name">plan_and_execute_prompt_library_workflow</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">repo_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Brief description of the repository&#39;s purpose and functionality&quot;</span><span class="p">)</span>,</span><span class="param">	<span class="n">main_languages</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Main programming languages used in the repository (comma-separated)&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Common file patterns/extensions in the repository (comma-separated)&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">key_features</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Key features or functionality of the repository (comma-separated)&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">client_repo_root</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Absolute path to the client&#39;s repository root directory&quot;</span><span class="p">)</span>,</span><span class="param">	<span class="n">phase</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Current phase of the workflow (1-5)&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Current state of the workflow for continuing execution&#39;</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="plan_and_execute_prompt_library_workflow-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plan_and_execute_prompt_library_workflow"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plan_and_execute_prompt_library_workflow-2016"><a href="#plan_and_execute_prompt_library_workflow-2016"><span class="linenos">2016</span></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span>
</span><span id="plan_and_execute_prompt_library_workflow-2017"><a href="#plan_and_execute_prompt_library_workflow-2017"><span class="linenos">2017</span></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;plan_and_execute_prompt_library_workflow&quot;</span><span class="p">,</span>
</span><span id="plan_and_execute_prompt_library_workflow-2018"><a href="#plan_and_execute_prompt_library_workflow-2018"><span class="linenos">2018</span></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Execute a structured workflow for generating custom cursor rules based on repository analysis&quot;</span><span class="p">,</span>
</span><span id="plan_and_execute_prompt_library_workflow-2019"><a href="#plan_and_execute_prompt_library_workflow-2019"><span class="linenos">2019</span></a><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2020"><a href="#plan_and_execute_prompt_library_workflow-2020"><span class="linenos">2020</span></a><span class="k">def</span><span class="w"> </span><span class="nf">plan_and_execute_prompt_library_workflow</span><span class="p">(</span>
</span><span id="plan_and_execute_prompt_library_workflow-2021"><a href="#plan_and_execute_prompt_library_workflow-2021"><span class="linenos">2021</span></a>    <span class="n">repo_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Brief description of the repository&#39;s purpose and functionality&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2022"><a href="#plan_and_execute_prompt_library_workflow-2022"><span class="linenos">2022</span></a>    <span class="n">main_languages</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Main programming languages used in the repository (comma-separated)&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2023"><a href="#plan_and_execute_prompt_library_workflow-2023"><span class="linenos">2023</span></a>    <span class="n">file_patterns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Common file patterns/extensions in the repository (comma-separated)&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2024"><a href="#plan_and_execute_prompt_library_workflow-2024"><span class="linenos">2024</span></a>    <span class="n">key_features</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Key features or functionality of the repository (comma-separated)&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2025"><a href="#plan_and_execute_prompt_library_workflow-2025"><span class="linenos">2025</span></a>    <span class="n">client_repo_root</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Absolute path to the client&#39;s repository root directory&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2026"><a href="#plan_and_execute_prompt_library_workflow-2026"><span class="linenos">2026</span></a>    <span class="n">phase</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current phase of the workflow (1-5)&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2027"><a href="#plan_and_execute_prompt_library_workflow-2027"><span class="linenos">2027</span></a>    <span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="plan_and_execute_prompt_library_workflow-2028"><a href="#plan_and_execute_prompt_library_workflow-2028"><span class="linenos">2028</span></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current state of the workflow for continuing execution&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
</span><span id="plan_and_execute_prompt_library_workflow-2029"><a href="#plan_and_execute_prompt_library_workflow-2029"><span class="linenos">2029</span></a>    <span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2030"><a href="#plan_and_execute_prompt_library_workflow-2030"><span class="linenos">2030</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2031"><a href="#plan_and_execute_prompt_library_workflow-2031"><span class="linenos">2031</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute a structured workflow for generating custom cursor rules based on repository analysis.</span>
</span><span id="plan_and_execute_prompt_library_workflow-2032"><a href="#plan_and_execute_prompt_library_workflow-2032"><span class="linenos">2032</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2033"><a href="#plan_and_execute_prompt_library_workflow-2033"><span class="linenos">2033</span></a><span class="sd">    This tool facilitates a structured, phase-based workflow for analyzing a repository and</span>
</span><span id="plan_and_execute_prompt_library_workflow-2034"><a href="#plan_and_execute_prompt_library_workflow-2034"><span class="linenos">2034</span></a><span class="sd">    generating custom cursor rules tailored to its specific technologies and patterns.</span>
</span><span id="plan_and_execute_prompt_library_workflow-2035"><a href="#plan_and_execute_prompt_library_workflow-2035"><span class="linenos">2035</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2036"><a href="#plan_and_execute_prompt_library_workflow-2036"><span class="linenos">2036</span></a><span class="sd">    The workflow consists of five phases:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2037"><a href="#plan_and_execute_prompt_library_workflow-2037"><span class="linenos">2037</span></a><span class="sd">    1. Repository Analysis: Analyze the repository to identify technologies, patterns, and features</span>
</span><span id="plan_and_execute_prompt_library_workflow-2038"><a href="#plan_and_execute_prompt_library_workflow-2038"><span class="linenos">2038</span></a><span class="sd">    2. Rule Identification: Recommend cursor rules based on the analysis</span>
</span><span id="plan_and_execute_prompt_library_workflow-2039"><a href="#plan_and_execute_prompt_library_workflow-2039"><span class="linenos">2039</span></a><span class="sd">    3. Workspace Preparation: Set up the necessary directory structure</span>
</span><span id="plan_and_execute_prompt_library_workflow-2040"><a href="#plan_and_execute_prompt_library_workflow-2040"><span class="linenos">2040</span></a><span class="sd">    4. Rule Creation: Generate the content for each cursor rule</span>
</span><span id="plan_and_execute_prompt_library_workflow-2041"><a href="#plan_and_execute_prompt_library_workflow-2041"><span class="linenos">2041</span></a><span class="sd">    5. Deployment and Testing: Deploy the cursor rules and verify functionality</span>
</span><span id="plan_and_execute_prompt_library_workflow-2042"><a href="#plan_and_execute_prompt_library_workflow-2042"><span class="linenos">2042</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2043"><a href="#plan_and_execute_prompt_library_workflow-2043"><span class="linenos">2043</span></a><span class="sd">    Args:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2044"><a href="#plan_and_execute_prompt_library_workflow-2044"><span class="linenos">2044</span></a><span class="sd">        repo_description: Brief description of the repository&#39;s purpose and functionality</span>
</span><span id="plan_and_execute_prompt_library_workflow-2045"><a href="#plan_and_execute_prompt_library_workflow-2045"><span class="linenos">2045</span></a><span class="sd">        main_languages: Main programming languages used in the repository (comma-separated)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2046"><a href="#plan_and_execute_prompt_library_workflow-2046"><span class="linenos">2046</span></a><span class="sd">        file_patterns: Common file patterns/extensions in the repository (comma-separated)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2047"><a href="#plan_and_execute_prompt_library_workflow-2047"><span class="linenos">2047</span></a><span class="sd">        key_features: Key features or functionality of the repository (comma-separated)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2048"><a href="#plan_and_execute_prompt_library_workflow-2048"><span class="linenos">2048</span></a><span class="sd">        client_repo_root: Absolute path to the client&#39;s repository root directory</span>
</span><span id="plan_and_execute_prompt_library_workflow-2049"><a href="#plan_and_execute_prompt_library_workflow-2049"><span class="linenos">2049</span></a><span class="sd">        phase: Current phase of the workflow (1-5)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2050"><a href="#plan_and_execute_prompt_library_workflow-2050"><span class="linenos">2050</span></a><span class="sd">        workflow_state: Current state of the workflow for continuing execution</span>
</span><span id="plan_and_execute_prompt_library_workflow-2051"><a href="#plan_and_execute_prompt_library_workflow-2051"><span class="linenos">2051</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2052"><a href="#plan_and_execute_prompt_library_workflow-2052"><span class="linenos">2052</span></a><span class="sd">    Returns:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2053"><a href="#plan_and_execute_prompt_library_workflow-2053"><span class="linenos">2053</span></a><span class="sd">        dict[str, Any]: Status of the workflow, next steps, and any generated content</span>
</span><span id="plan_and_execute_prompt_library_workflow-2054"><a href="#plan_and_execute_prompt_library_workflow-2054"><span class="linenos">2054</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2055"><a href="#plan_and_execute_prompt_library_workflow-2055"><span class="linenos">2055</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="plan_and_execute_prompt_library_workflow-2056"><a href="#plan_and_execute_prompt_library_workflow-2056"><span class="linenos">2056</span></a>    <span class="c1"># Initialize workflow_state if it&#39;s None or not a dictionary</span>
</span><span id="plan_and_execute_prompt_library_workflow-2057"><a href="#plan_and_execute_prompt_library_workflow-2057"><span class="linenos">2057</span></a>    <span class="n">actual_workflow_state</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">workflow_state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">workflow_state</span>
</span><span id="plan_and_execute_prompt_library_workflow-2058"><a href="#plan_and_execute_prompt_library_workflow-2058"><span class="linenos">2058</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2059"><a href="#plan_and_execute_prompt_library_workflow-2059"><span class="linenos">2059</span></a>    <span class="c1"># If no workflow_state is provided, initialize it with the input parameters</span>
</span><span id="plan_and_execute_prompt_library_workflow-2060"><a href="#plan_and_execute_prompt_library_workflow-2060"><span class="linenos">2060</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">actual_workflow_state</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2061"><a href="#plan_and_execute_prompt_library_workflow-2061"><span class="linenos">2061</span></a>        <span class="c1"># Initialize repository information</span>
</span><span id="plan_and_execute_prompt_library_workflow-2062"><a href="#plan_and_execute_prompt_library_workflow-2062"><span class="linenos">2062</span></a>        <span class="n">actual_workflow_state</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="plan_and_execute_prompt_library_workflow-2063"><a href="#plan_and_execute_prompt_library_workflow-2063"><span class="linenos">2063</span></a>            <span class="s2">&quot;repository_info&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="plan_and_execute_prompt_library_workflow-2064"><a href="#plan_and_execute_prompt_library_workflow-2064"><span class="linenos">2064</span></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">repo_description</span><span class="p">,</span>
</span><span id="plan_and_execute_prompt_library_workflow-2065"><a href="#plan_and_execute_prompt_library_workflow-2065"><span class="linenos">2065</span></a>                <span class="s2">&quot;main_languages&quot;</span><span class="p">:</span> <span class="n">main_languages</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2066"><a href="#plan_and_execute_prompt_library_workflow-2066"><span class="linenos">2066</span></a>                <span class="s2">&quot;file_patterns&quot;</span><span class="p">:</span> <span class="n">file_patterns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2067"><a href="#plan_and_execute_prompt_library_workflow-2067"><span class="linenos">2067</span></a>                <span class="s2">&quot;key_features&quot;</span><span class="p">:</span> <span class="n">key_features</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span>
</span><span id="plan_and_execute_prompt_library_workflow-2068"><a href="#plan_and_execute_prompt_library_workflow-2068"><span class="linenos">2068</span></a>                <span class="s2">&quot;repo_root&quot;</span><span class="p">:</span> <span class="n">client_repo_root</span><span class="p">,</span>
</span><span id="plan_and_execute_prompt_library_workflow-2069"><a href="#plan_and_execute_prompt_library_workflow-2069"><span class="linenos">2069</span></a>            <span class="p">},</span>
</span><span id="plan_and_execute_prompt_library_workflow-2070"><a href="#plan_and_execute_prompt_library_workflow-2070"><span class="linenos">2070</span></a>            <span class="s2">&quot;recommended_rules&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="plan_and_execute_prompt_library_workflow-2071"><a href="#plan_and_execute_prompt_library_workflow-2071"><span class="linenos">2071</span></a>            <span class="s2">&quot;created_rules&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="plan_and_execute_prompt_library_workflow-2072"><a href="#plan_and_execute_prompt_library_workflow-2072"><span class="linenos">2072</span></a>            <span class="s2">&quot;deployed_rules&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="plan_and_execute_prompt_library_workflow-2073"><a href="#plan_and_execute_prompt_library_workflow-2073"><span class="linenos">2073</span></a>            <span class="s2">&quot;workspace_prepared&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Mark workspace as prepared</span>
</span><span id="plan_and_execute_prompt_library_workflow-2074"><a href="#plan_and_execute_prompt_library_workflow-2074"><span class="linenos">2074</span></a>            <span class="s2">&quot;workspace_result&quot;</span><span class="p">:</span> <span class="n">prep_workspace</span><span class="p">(),</span>  <span class="c1"># Store workspace preparation result</span>
</span><span id="plan_and_execute_prompt_library_workflow-2075"><a href="#plan_and_execute_prompt_library_workflow-2075"><span class="linenos">2075</span></a>        <span class="p">}</span>
</span><span id="plan_and_execute_prompt_library_workflow-2076"><a href="#plan_and_execute_prompt_library_workflow-2076"><span class="linenos">2076</span></a>
</span><span id="plan_and_execute_prompt_library_workflow-2077"><a href="#plan_and_execute_prompt_library_workflow-2077"><span class="linenos">2077</span></a>    <span class="c1"># Execute the current phase</span>
</span><span id="plan_and_execute_prompt_library_workflow-2078"><a href="#plan_and_execute_prompt_library_workflow-2078"><span class="linenos">2078</span></a>    <span class="k">if</span> <span class="n">phase</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2079"><a href="#plan_and_execute_prompt_library_workflow-2079"><span class="linenos">2079</span></a>        <span class="c1"># Phase 1: Repository Analysis</span>
</span><span id="plan_and_execute_prompt_library_workflow-2080"><a href="#plan_and_execute_prompt_library_workflow-2080"><span class="linenos">2080</span></a>        <span class="k">return</span> <span class="n">execute_phase_1</span><span class="p">(</span><span class="n">actual_workflow_state</span><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2081"><a href="#plan_and_execute_prompt_library_workflow-2081"><span class="linenos">2081</span></a>    <span class="k">elif</span> <span class="n">phase</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2082"><a href="#plan_and_execute_prompt_library_workflow-2082"><span class="linenos">2082</span></a>        <span class="c1"># Phase 2: Rule Identification</span>
</span><span id="plan_and_execute_prompt_library_workflow-2083"><a href="#plan_and_execute_prompt_library_workflow-2083"><span class="linenos">2083</span></a>        <span class="k">return</span> <span class="n">execute_phase_2</span><span class="p">(</span><span class="n">actual_workflow_state</span><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2084"><a href="#plan_and_execute_prompt_library_workflow-2084"><span class="linenos">2084</span></a>    <span class="k">elif</span> <span class="n">phase</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2085"><a href="#plan_and_execute_prompt_library_workflow-2085"><span class="linenos">2085</span></a>        <span class="c1"># Phase 3: Workspace Preparation</span>
</span><span id="plan_and_execute_prompt_library_workflow-2086"><a href="#plan_and_execute_prompt_library_workflow-2086"><span class="linenos">2086</span></a>        <span class="k">return</span> <span class="n">execute_phase_3</span><span class="p">(</span><span class="n">actual_workflow_state</span><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2087"><a href="#plan_and_execute_prompt_library_workflow-2087"><span class="linenos">2087</span></a>    <span class="k">elif</span> <span class="n">phase</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2088"><a href="#plan_and_execute_prompt_library_workflow-2088"><span class="linenos">2088</span></a>        <span class="c1"># Phase 4: Rule Creation</span>
</span><span id="plan_and_execute_prompt_library_workflow-2089"><a href="#plan_and_execute_prompt_library_workflow-2089"><span class="linenos">2089</span></a>        <span class="k">return</span> <span class="n">execute_phase_4</span><span class="p">(</span><span class="n">actual_workflow_state</span><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2090"><a href="#plan_and_execute_prompt_library_workflow-2090"><span class="linenos">2090</span></a>    <span class="k">elif</span> <span class="n">phase</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2091"><a href="#plan_and_execute_prompt_library_workflow-2091"><span class="linenos">2091</span></a>        <span class="c1"># Phase 5: Deployment and Testing</span>
</span><span id="plan_and_execute_prompt_library_workflow-2092"><a href="#plan_and_execute_prompt_library_workflow-2092"><span class="linenos">2092</span></a>        <span class="k">return</span> <span class="n">execute_phase_5</span><span class="p">(</span><span class="n">actual_workflow_state</span><span class="p">)</span>
</span><span id="plan_and_execute_prompt_library_workflow-2093"><a href="#plan_and_execute_prompt_library_workflow-2093"><span class="linenos">2093</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="plan_and_execute_prompt_library_workflow-2094"><a href="#plan_and_execute_prompt_library_workflow-2094"><span class="linenos">2094</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Invalid phase: </span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">. Valid phases are 1-5.&quot;</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute a structured workflow for generating custom cursor rules based on repository analysis.</p>

<p>This tool facilitates a structured, phase-based workflow for analyzing a repository and
generating custom cursor rules tailored to its specific technologies and patterns.</p>

<p>The workflow consists of five phases:</p>

<ol>
<li>Repository Analysis: Analyze the repository to identify technologies, patterns, and features</li>
<li>Rule Identification: Recommend cursor rules based on the analysis</li>
<li>Workspace Preparation: Set up the necessary directory structure</li>
<li>Rule Creation: Generate the content for each cursor rule</li>
<li>Deployment and Testing: Deploy the cursor rules and verify functionality</li>
</ol>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>repo_description:</strong>  Brief description of the repository's purpose and functionality</li>
<li><strong>main_languages:</strong>  Main programming languages used in the repository (comma-separated)</li>
<li><strong>file_patterns:</strong>  Common file patterns/extensions in the repository (comma-separated)</li>
<li><strong>key_features:</strong>  Key features or functionality of the repository (comma-separated)</li>
<li><strong>client_repo_root:</strong>  Absolute path to the client's repository root directory</li>
<li><strong>phase:</strong>  Current phase of the workflow (1-5)</li>
<li><strong>workflow_state:</strong>  Current state of the workflow for continuing execution</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Status of the workflow, next steps, and any generated content</p>
</blockquote>
</div>


                </section>
                <section id="execute_phase_1">
                            <input id="execute_phase_1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_phase_1</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="execute_phase_1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#execute_phase_1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="execute_phase_1-2097"><a href="#execute_phase_1-2097"><span class="linenos">2097</span></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_phase_1</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="execute_phase_1-2098"><a href="#execute_phase_1-2098"><span class="linenos">2098</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute Phase 1: Repository Analysis.</span>
</span><span id="execute_phase_1-2099"><a href="#execute_phase_1-2099"><span class="linenos">2099</span></a>
</span><span id="execute_phase_1-2100"><a href="#execute_phase_1-2100"><span class="linenos">2100</span></a><span class="sd">    Args:</span>
</span><span id="execute_phase_1-2101"><a href="#execute_phase_1-2101"><span class="linenos">2101</span></a><span class="sd">        workflow_state: Current state of the workflow for continuing execution</span>
</span><span id="execute_phase_1-2102"><a href="#execute_phase_1-2102"><span class="linenos">2102</span></a>
</span><span id="execute_phase_1-2103"><a href="#execute_phase_1-2103"><span class="linenos">2103</span></a><span class="sd">    Returns:</span>
</span><span id="execute_phase_1-2104"><a href="#execute_phase_1-2104"><span class="linenos">2104</span></a><span class="sd">        dict[str, Any]: Updated workflow state and next steps</span>
</span><span id="execute_phase_1-2105"><a href="#execute_phase_1-2105"><span class="linenos">2105</span></a>
</span><span id="execute_phase_1-2106"><a href="#execute_phase_1-2106"><span class="linenos">2106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="execute_phase_1-2107"><a href="#execute_phase_1-2107"><span class="linenos">2107</span></a>    <span class="c1"># Initialize workflow_state as an empty dict if it&#39;s None or not a dictionary</span>
</span><span id="execute_phase_1-2108"><a href="#execute_phase_1-2108"><span class="linenos">2108</span></a>    <span class="k">if</span> <span class="n">workflow_state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="execute_phase_1-2109"><a href="#execute_phase_1-2109"><span class="linenos">2109</span></a>        <span class="n">workflow_state</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="execute_phase_1-2110"><a href="#execute_phase_1-2110"><span class="linenos">2110</span></a>
</span><span id="execute_phase_1-2111"><a href="#execute_phase_1-2111"><span class="linenos">2111</span></a>    <span class="c1"># First, ensure workspace is prepared before any analysis</span>
</span><span id="execute_phase_1-2112"><a href="#execute_phase_1-2112"><span class="linenos">2112</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;workspace_prepared&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_1-2113"><a href="#execute_phase_1-2113"><span class="linenos">2113</span></a>        <span class="c1"># Prepare the workspace</span>
</span><span id="execute_phase_1-2114"><a href="#execute_phase_1-2114"><span class="linenos">2114</span></a>        <span class="n">workspace_result</span> <span class="o">=</span> <span class="n">prep_workspace</span><span class="p">()</span>
</span><span id="execute_phase_1-2115"><a href="#execute_phase_1-2115"><span class="linenos">2115</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;workspace_prepared&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_1-2116"><a href="#execute_phase_1-2116"><span class="linenos">2116</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;workspace_result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">workspace_result</span>
</span><span id="execute_phase_1-2117"><a href="#execute_phase_1-2117"><span class="linenos">2117</span></a>
</span><span id="execute_phase_1-2118"><a href="#execute_phase_1-2118"><span class="linenos">2118</span></a>        <span class="c1"># If workspace preparation failed, return error</span>
</span><span id="execute_phase_1-2119"><a href="#execute_phase_1-2119"><span class="linenos">2119</span></a>        <span class="k">if</span> <span class="n">workspace_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="execute_phase_1-2120"><a href="#execute_phase_1-2120"><span class="linenos">2120</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_1-2121"><a href="#execute_phase_1-2121"><span class="linenos">2121</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2122"><a href="#execute_phase_1-2122"><span class="linenos">2122</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error preparing workspace: </span><span class="si">{</span><span class="n">workspace_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2123"><a href="#execute_phase_1-2123"><span class="linenos">2123</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_1-2124"><a href="#execute_phase_1-2124"><span class="linenos">2124</span></a>            <span class="p">}</span>
</span><span id="execute_phase_1-2125"><a href="#execute_phase_1-2125"><span class="linenos">2125</span></a>
</span><span id="execute_phase_1-2126"><a href="#execute_phase_1-2126"><span class="linenos">2126</span></a>    <span class="c1"># If Phase 1 is already complete, return the state and suggest moving to Phase 2</span>
</span><span id="execute_phase_1-2127"><a href="#execute_phase_1-2127"><span class="linenos">2127</span></a>    <span class="k">if</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_1_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_1-2128"><a href="#execute_phase_1-2128"><span class="linenos">2128</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_1-2129"><a href="#execute_phase_1-2129"><span class="linenos">2129</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;already_complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2130"><a href="#execute_phase_1-2130"><span class="linenos">2130</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 1 (Repository Analysis) is already complete. Proceed to Phase 2.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2131"><a href="#execute_phase_1-2131"><span class="linenos">2131</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_1-2132"><a href="#execute_phase_1-2132"><span class="linenos">2132</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="execute_phase_1-2133"><a href="#execute_phase_1-2133"><span class="linenos">2133</span></a>        <span class="p">}</span>
</span><span id="execute_phase_1-2134"><a href="#execute_phase_1-2134"><span class="linenos">2134</span></a>
</span><span id="execute_phase_1-2135"><a href="#execute_phase_1-2135"><span class="linenos">2135</span></a>    <span class="c1"># Extract repository information</span>
</span><span id="execute_phase_1-2136"><a href="#execute_phase_1-2136"><span class="linenos">2136</span></a>    <span class="n">repo_info</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;repository_info&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_1-2137"><a href="#execute_phase_1-2137"><span class="linenos">2137</span></a>
</span><span id="execute_phase_1-2138"><a href="#execute_phase_1-2138"><span class="linenos">2138</span></a>    <span class="c1"># Perform repository analysis using repo_analysis_prompt</span>
</span><span id="execute_phase_1-2139"><a href="#execute_phase_1-2139"><span class="linenos">2139</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_1-2140"><a href="#execute_phase_1-2140"><span class="linenos">2140</span></a>        <span class="c1"># Call the repo_analysis_prompt function to get recommendations</span>
</span><span id="execute_phase_1-2141"><a href="#execute_phase_1-2141"><span class="linenos">2141</span></a>        <span class="n">analysis_results</span> <span class="o">=</span> <span class="n">repo_analysis_prompt</span><span class="p">(</span>
</span><span id="execute_phase_1-2142"><a href="#execute_phase_1-2142"><span class="linenos">2142</span></a>            <span class="n">repo_description</span><span class="o">=</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="execute_phase_1-2143"><a href="#execute_phase_1-2143"><span class="linenos">2143</span></a>            <span class="n">main_languages</span><span class="o">=</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;main_languages&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="execute_phase_1-2144"><a href="#execute_phase_1-2144"><span class="linenos">2144</span></a>            <span class="n">file_patterns</span><span class="o">=</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_patterns&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="execute_phase_1-2145"><a href="#execute_phase_1-2145"><span class="linenos">2145</span></a>            <span class="n">key_features</span><span class="o">=</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key_features&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="execute_phase_1-2146"><a href="#execute_phase_1-2146"><span class="linenos">2146</span></a>        <span class="p">)</span>
</span><span id="execute_phase_1-2147"><a href="#execute_phase_1-2147"><span class="linenos">2147</span></a>
</span><span id="execute_phase_1-2148"><a href="#execute_phase_1-2148"><span class="linenos">2148</span></a>        <span class="c1"># Process and structure the analysis results</span>
</span><span id="execute_phase_1-2149"><a href="#execute_phase_1-2149"><span class="linenos">2149</span></a>        <span class="n">structured_analysis</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="execute_phase_1-2150"><a href="#execute_phase_1-2150"><span class="linenos">2150</span></a>            <span class="s2">&quot;repository_type&quot;</span><span class="p">:</span> <span class="n">analysis_results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">],</span>
</span><span id="execute_phase_1-2151"><a href="#execute_phase_1-2151"><span class="linenos">2151</span></a>            <span class="s2">&quot;common_patterns&quot;</span><span class="p">:</span> <span class="n">analysis_results</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">],</span>
</span><span id="execute_phase_1-2152"><a href="#execute_phase_1-2152"><span class="linenos">2152</span></a>            <span class="s2">&quot;recommended_rules&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="execute_phase_1-2153"><a href="#execute_phase_1-2153"><span class="linenos">2153</span></a>            <span class="s2">&quot;analysis_summary&quot;</span><span class="p">:</span> <span class="n">analysis_results</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2154"><a href="#execute_phase_1-2154"><span class="linenos">2154</span></a>        <span class="p">}</span>
</span><span id="execute_phase_1-2155"><a href="#execute_phase_1-2155"><span class="linenos">2155</span></a>
</span><span id="execute_phase_1-2156"><a href="#execute_phase_1-2156"><span class="linenos">2156</span></a>        <span class="c1"># Extract recommended rules from the analysis</span>
</span><span id="execute_phase_1-2157"><a href="#execute_phase_1-2157"><span class="linenos">2157</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="execute_phase_1-2158"><a href="#execute_phase_1-2158"><span class="linenos">2158</span></a>            <span class="n">rule_suggestions</span> <span class="o">=</span> <span class="n">analysis_results</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="execute_phase_1-2159"><a href="#execute_phase_1-2159"><span class="linenos">2159</span></a>            <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rule_suggestions</span><span class="p">:</span>
</span><span id="execute_phase_1-2160"><a href="#execute_phase_1-2160"><span class="linenos">2160</span></a>                <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
</span><span id="execute_phase_1-2161"><a href="#execute_phase_1-2161"><span class="linenos">2161</span></a>                    <span class="n">structured_analysis</span><span class="p">[</span><span class="s2">&quot;recommended_rules&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="execute_phase_1-2162"><a href="#execute_phase_1-2162"><span class="linenos">2162</span></a>
</span><span id="execute_phase_1-2163"><a href="#execute_phase_1-2163"><span class="linenos">2163</span></a>        <span class="c1"># Update the workflow state</span>
</span><span id="execute_phase_1-2164"><a href="#execute_phase_1-2164"><span class="linenos">2164</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;analysis_results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">structured_analysis</span>
</span><span id="execute_phase_1-2165"><a href="#execute_phase_1-2165"><span class="linenos">2165</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;phase_1_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_1-2166"><a href="#execute_phase_1-2166"><span class="linenos">2166</span></a>
</span><span id="execute_phase_1-2167"><a href="#execute_phase_1-2167"><span class="linenos">2167</span></a>        <span class="c1"># Create a checklist for phase 1 completion</span>
</span><span id="execute_phase_1-2168"><a href="#execute_phase_1-2168"><span class="linenos">2168</span></a>        <span class="n">checklist</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="execute_phase_1-2169"><a href="#execute_phase_1-2169"><span class="linenos">2169</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Workspace prepared&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_1-2170"><a href="#execute_phase_1-2170"><span class="linenos">2170</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Repository information gathered&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_1-2171"><a href="#execute_phase_1-2171"><span class="linenos">2171</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Repository structure analyzed&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_1-2172"><a href="#execute_phase_1-2172"><span class="linenos">2172</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Common patterns identified&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">structured_analysis</span><span class="p">[</span><span class="s2">&quot;common_patterns&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_1-2173"><a href="#execute_phase_1-2173"><span class="linenos">2173</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Primary purpose determined&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">structured_analysis</span><span class="p">[</span><span class="s2">&quot;repository_type&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_1-2174"><a href="#execute_phase_1-2174"><span class="linenos">2174</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Recommended rules identified&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">structured_analysis</span><span class="p">[</span><span class="s2">&quot;recommended_rules&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_1-2175"><a href="#execute_phase_1-2175"><span class="linenos">2175</span></a>        <span class="p">]</span>
</span><span id="execute_phase_1-2176"><a href="#execute_phase_1-2176"><span class="linenos">2176</span></a>
</span><span id="execute_phase_1-2177"><a href="#execute_phase_1-2177"><span class="linenos">2177</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_1-2178"><a href="#execute_phase_1-2178"><span class="linenos">2178</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2179"><a href="#execute_phase_1-2179"><span class="linenos">2179</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 1 (Repository Analysis) completed successfully.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2180"><a href="#execute_phase_1-2180"><span class="linenos">2180</span></a>            <span class="s2">&quot;checklist&quot;</span><span class="p">:</span> <span class="n">checklist</span><span class="p">,</span>
</span><span id="execute_phase_1-2181"><a href="#execute_phase_1-2181"><span class="linenos">2181</span></a>            <span class="s2">&quot;analysis_results&quot;</span><span class="p">:</span> <span class="n">structured_analysis</span><span class="p">,</span>
</span><span id="execute_phase_1-2182"><a href="#execute_phase_1-2182"><span class="linenos">2182</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_1-2183"><a href="#execute_phase_1-2183"><span class="linenos">2183</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="execute_phase_1-2184"><a href="#execute_phase_1-2184"><span class="linenos">2184</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Proceed to Phase 2: Rule Identification to select and prioritize cursor rules.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2185"><a href="#execute_phase_1-2185"><span class="linenos">2185</span></a>        <span class="p">}</span>
</span><span id="execute_phase_1-2186"><a href="#execute_phase_1-2186"><span class="linenos">2186</span></a>
</span><span id="execute_phase_1-2187"><a href="#execute_phase_1-2187"><span class="linenos">2187</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_1-2188"><a href="#execute_phase_1-2188"><span class="linenos">2188</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_1-2189"><a href="#execute_phase_1-2189"><span class="linenos">2189</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2190"><a href="#execute_phase_1-2190"><span class="linenos">2190</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error during repository analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_1-2191"><a href="#execute_phase_1-2191"><span class="linenos">2191</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_1-2192"><a href="#execute_phase_1-2192"><span class="linenos">2192</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute Phase 1: Repository Analysis.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>workflow_state:</strong>  Current state of the workflow for continuing execution</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Updated workflow state and next steps</p>
</blockquote>
</div>


                </section>
                <section id="execute_phase_2">
                            <input id="execute_phase_2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_phase_2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="execute_phase_2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#execute_phase_2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="execute_phase_2-2195"><a href="#execute_phase_2-2195"><span class="linenos">2195</span></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_phase_2</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="execute_phase_2-2196"><a href="#execute_phase_2-2196"><span class="linenos">2196</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute Phase 2: Rule Identification.</span>
</span><span id="execute_phase_2-2197"><a href="#execute_phase_2-2197"><span class="linenos">2197</span></a>
</span><span id="execute_phase_2-2198"><a href="#execute_phase_2-2198"><span class="linenos">2198</span></a><span class="sd">    Args:</span>
</span><span id="execute_phase_2-2199"><a href="#execute_phase_2-2199"><span class="linenos">2199</span></a><span class="sd">        workflow_state: Current state of the workflow</span>
</span><span id="execute_phase_2-2200"><a href="#execute_phase_2-2200"><span class="linenos">2200</span></a>
</span><span id="execute_phase_2-2201"><a href="#execute_phase_2-2201"><span class="linenos">2201</span></a><span class="sd">    Returns:</span>
</span><span id="execute_phase_2-2202"><a href="#execute_phase_2-2202"><span class="linenos">2202</span></a><span class="sd">        dict[str, Any]: Updated workflow state and next steps</span>
</span><span id="execute_phase_2-2203"><a href="#execute_phase_2-2203"><span class="linenos">2203</span></a>
</span><span id="execute_phase_2-2204"><a href="#execute_phase_2-2204"><span class="linenos">2204</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="execute_phase_2-2205"><a href="#execute_phase_2-2205"><span class="linenos">2205</span></a>    <span class="c1"># If Phase 2 is already complete, return the state and suggest moving to Phase 3</span>
</span><span id="execute_phase_2-2206"><a href="#execute_phase_2-2206"><span class="linenos">2206</span></a>    <span class="k">if</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_2_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_2-2207"><a href="#execute_phase_2-2207"><span class="linenos">2207</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_2-2208"><a href="#execute_phase_2-2208"><span class="linenos">2208</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;already_complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2209"><a href="#execute_phase_2-2209"><span class="linenos">2209</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 2 (Rule Identification) is already complete. Proceed to Phase 3.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2210"><a href="#execute_phase_2-2210"><span class="linenos">2210</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_2-2211"><a href="#execute_phase_2-2211"><span class="linenos">2211</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="execute_phase_2-2212"><a href="#execute_phase_2-2212"><span class="linenos">2212</span></a>        <span class="p">}</span>
</span><span id="execute_phase_2-2213"><a href="#execute_phase_2-2213"><span class="linenos">2213</span></a>
</span><span id="execute_phase_2-2214"><a href="#execute_phase_2-2214"><span class="linenos">2214</span></a>    <span class="c1"># Check if Phase 1 is complete</span>
</span><span id="execute_phase_2-2215"><a href="#execute_phase_2-2215"><span class="linenos">2215</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_1_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_2-2216"><a href="#execute_phase_2-2216"><span class="linenos">2216</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_2-2217"><a href="#execute_phase_2-2217"><span class="linenos">2217</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;prerequisite_not_met&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2218"><a href="#execute_phase_2-2218"><span class="linenos">2218</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 1 (Repository Analysis) must be completed before proceeding to Phase 2.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2219"><a href="#execute_phase_2-2219"><span class="linenos">2219</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_2-2220"><a href="#execute_phase_2-2220"><span class="linenos">2220</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="execute_phase_2-2221"><a href="#execute_phase_2-2221"><span class="linenos">2221</span></a>        <span class="p">}</span>
</span><span id="execute_phase_2-2222"><a href="#execute_phase_2-2222"><span class="linenos">2222</span></a>
</span><span id="execute_phase_2-2223"><a href="#execute_phase_2-2223"><span class="linenos">2223</span></a>    <span class="c1"># Extract analysis results from Phase 1</span>
</span><span id="execute_phase_2-2224"><a href="#execute_phase_2-2224"><span class="linenos">2224</span></a>    <span class="n">analysis_results</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;analysis_results&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_2-2225"><a href="#execute_phase_2-2225"><span class="linenos">2225</span></a>    <span class="n">repo_info</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;repository_info&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_2-2226"><a href="#execute_phase_2-2226"><span class="linenos">2226</span></a>
</span><span id="execute_phase_2-2227"><a href="#execute_phase_2-2227"><span class="linenos">2227</span></a>    <span class="c1"># Create a repository summary for recommendation</span>
</span><span id="execute_phase_2-2228"><a href="#execute_phase_2-2228"><span class="linenos">2228</span></a>    <span class="n">repo_summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="execute_phase_2-2229"><a href="#execute_phase_2-2229"><span class="linenos">2229</span></a><span class="s2">Repository Description: </span><span class="si">{</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2230"><a href="#execute_phase_2-2230"><span class="linenos">2230</span></a><span class="s2">Main Languages: </span><span class="si">{</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;main_languages&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2231"><a href="#execute_phase_2-2231"><span class="linenos">2231</span></a><span class="s2">File Patterns: </span><span class="si">{</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_patterns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2232"><a href="#execute_phase_2-2232"><span class="linenos">2232</span></a><span class="s2">Key Features: </span><span class="si">{</span><span class="n">repo_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key_features&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2233"><a href="#execute_phase_2-2233"><span class="linenos">2233</span></a><span class="s2">Repository Type: </span><span class="si">{</span><span class="n">analysis_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;repository_type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2234"><a href="#execute_phase_2-2234"><span class="linenos">2234</span></a><span class="s2">Common Patterns: </span><span class="si">{</span><span class="n">analysis_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;common_patterns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
</span><span id="execute_phase_2-2235"><a href="#execute_phase_2-2235"><span class="linenos">2235</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="execute_phase_2-2236"><a href="#execute_phase_2-2236"><span class="linenos">2236</span></a>
</span><span id="execute_phase_2-2237"><a href="#execute_phase_2-2237"><span class="linenos">2237</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_2-2238"><a href="#execute_phase_2-2238"><span class="linenos">2238</span></a>        <span class="c1"># Call the recommend_cursor_rules function to get rule recommendations</span>
</span><span id="execute_phase_2-2239"><a href="#execute_phase_2-2239"><span class="linenos">2239</span></a>        <span class="n">recommended_rules</span> <span class="o">=</span> <span class="n">recommend_cursor_rules</span><span class="p">(</span><span class="n">repo_summary</span><span class="p">)</span>
</span><span id="execute_phase_2-2240"><a href="#execute_phase_2-2240"><span class="linenos">2240</span></a>
</span><span id="execute_phase_2-2241"><a href="#execute_phase_2-2241"><span class="linenos">2241</span></a>        <span class="c1"># Group and categorize rules</span>
</span><span id="execute_phase_2-2242"><a href="#execute_phase_2-2242"><span class="linenos">2242</span></a>        <span class="n">categorized_rules</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="execute_phase_2-2243"><a href="#execute_phase_2-2243"><span class="linenos">2243</span></a>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">recommended_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2244"><a href="#execute_phase_2-2244"><span class="linenos">2244</span></a>            <span class="n">category</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;General&quot;</span><span class="p">)</span>
</span><span id="execute_phase_2-2245"><a href="#execute_phase_2-2245"><span class="linenos">2245</span></a>            <span class="k">if</span> <span class="n">category</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorized_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2246"><a href="#execute_phase_2-2246"><span class="linenos">2246</span></a>                <span class="n">categorized_rules</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_2-2247"><a href="#execute_phase_2-2247"><span class="linenos">2247</span></a>            <span class="n">categorized_rules</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
</span><span id="execute_phase_2-2248"><a href="#execute_phase_2-2248"><span class="linenos">2248</span></a>
</span><span id="execute_phase_2-2249"><a href="#execute_phase_2-2249"><span class="linenos">2249</span></a>        <span class="c1"># Prioritize rules based on value and relevance</span>
</span><span id="execute_phase_2-2250"><a href="#execute_phase_2-2250"><span class="linenos">2250</span></a>        <span class="n">prioritized_rules</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_2-2251"><a href="#execute_phase_2-2251"><span class="linenos">2251</span></a>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">recommended_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2252"><a href="#execute_phase_2-2252"><span class="linenos">2252</span></a>            <span class="c1"># Add priority field if not present</span>
</span><span id="execute_phase_2-2253"><a href="#execute_phase_2-2253"><span class="linenos">2253</span></a>            <span class="k">if</span> <span class="s2">&quot;priority&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">:</span>
</span><span id="execute_phase_2-2254"><a href="#execute_phase_2-2254"><span class="linenos">2254</span></a>                <span class="c1"># Set default priority based on category</span>
</span><span id="execute_phase_2-2255"><a href="#execute_phase_2-2255"><span class="linenos">2255</span></a>                <span class="n">category</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;General&quot;</span><span class="p">)</span>
</span><span id="execute_phase_2-2256"><a href="#execute_phase_2-2256"><span class="linenos">2256</span></a>                <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Formatting&quot;</span><span class="p">,</span> <span class="s2">&quot;Style&quot;</span><span class="p">]:</span>
</span><span id="execute_phase_2-2257"><a href="#execute_phase_2-2257"><span class="linenos">2257</span></a>                    <span class="n">priority</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>
</span><span id="execute_phase_2-2258"><a href="#execute_phase_2-2258"><span class="linenos">2258</span></a>                <span class="k">elif</span> <span class="n">category</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Testing&quot;</span><span class="p">,</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">]:</span>
</span><span id="execute_phase_2-2259"><a href="#execute_phase_2-2259"><span class="linenos">2259</span></a>                    <span class="n">priority</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
</span><span id="execute_phase_2-2260"><a href="#execute_phase_2-2260"><span class="linenos">2260</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_2-2261"><a href="#execute_phase_2-2261"><span class="linenos">2261</span></a>                    <span class="n">priority</span> <span class="o">=</span> <span class="s2">&quot;medium&quot;</span>
</span><span id="execute_phase_2-2262"><a href="#execute_phase_2-2262"><span class="linenos">2262</span></a>                <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">priority</span>
</span><span id="execute_phase_2-2263"><a href="#execute_phase_2-2263"><span class="linenos">2263</span></a>
</span><span id="execute_phase_2-2264"><a href="#execute_phase_2-2264"><span class="linenos">2264</span></a>            <span class="c1"># Add to prioritized list</span>
</span><span id="execute_phase_2-2265"><a href="#execute_phase_2-2265"><span class="linenos">2265</span></a>            <span class="n">prioritized_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
</span><span id="execute_phase_2-2266"><a href="#execute_phase_2-2266"><span class="linenos">2266</span></a>
</span><span id="execute_phase_2-2267"><a href="#execute_phase_2-2267"><span class="linenos">2267</span></a>        <span class="c1"># Sort rules by priority</span>
</span><span id="execute_phase_2-2268"><a href="#execute_phase_2-2268"><span class="linenos">2268</span></a>        <span class="n">prioritized_rules</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="execute_phase_2-2269"><a href="#execute_phase_2-2269"><span class="linenos">2269</span></a>
</span><span id="execute_phase_2-2270"><a href="#execute_phase_2-2270"><span class="linenos">2270</span></a>        <span class="c1"># Filter out redundant or low-value rules</span>
</span><span id="execute_phase_2-2271"><a href="#execute_phase_2-2271"><span class="linenos">2271</span></a>        <span class="n">filtered_rules</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_2-2272"><a href="#execute_phase_2-2272"><span class="linenos">2272</span></a>        <span class="n">rule_names_seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="execute_phase_2-2273"><a href="#execute_phase_2-2273"><span class="linenos">2273</span></a>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">prioritized_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2274"><a href="#execute_phase_2-2274"><span class="linenos">2274</span></a>            <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_2-2275"><a href="#execute_phase_2-2275"><span class="linenos">2275</span></a>            <span class="c1"># Skip rules we&#39;ve already seen or with empty names</span>
</span><span id="execute_phase_2-2276"><a href="#execute_phase_2-2276"><span class="linenos">2276</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_name</span> <span class="ow">or</span> <span class="n">rule_name</span> <span class="ow">in</span> <span class="n">rule_names_seen</span><span class="p">:</span>
</span><span id="execute_phase_2-2277"><a href="#execute_phase_2-2277"><span class="linenos">2277</span></a>                <span class="k">continue</span>
</span><span id="execute_phase_2-2278"><a href="#execute_phase_2-2278"><span class="linenos">2278</span></a>            <span class="n">rule_names_seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rule_name</span><span class="p">)</span>
</span><span id="execute_phase_2-2279"><a href="#execute_phase_2-2279"><span class="linenos">2279</span></a>            <span class="n">filtered_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
</span><span id="execute_phase_2-2280"><a href="#execute_phase_2-2280"><span class="linenos">2280</span></a>
</span><span id="execute_phase_2-2281"><a href="#execute_phase_2-2281"><span class="linenos">2281</span></a>        <span class="c1"># Identify dependencies between rules</span>
</span><span id="execute_phase_2-2282"><a href="#execute_phase_2-2282"><span class="linenos">2282</span></a>        <span class="c1"># Simple dependency identification based on categories</span>
</span><span id="execute_phase_2-2283"><a href="#execute_phase_2-2283"><span class="linenos">2283</span></a>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">filtered_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2284"><a href="#execute_phase_2-2284"><span class="linenos">2284</span></a>            <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_2-2285"><a href="#execute_phase_2-2285"><span class="linenos">2285</span></a>            <span class="n">rule_category</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_2-2286"><a href="#execute_phase_2-2286"><span class="linenos">2286</span></a>            <span class="n">rule_name</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_2-2287"><a href="#execute_phase_2-2287"><span class="linenos">2287</span></a>
</span><span id="execute_phase_2-2288"><a href="#execute_phase_2-2288"><span class="linenos">2288</span></a>            <span class="c1"># Documentation rules might depend on style rules</span>
</span><span id="execute_phase_2-2289"><a href="#execute_phase_2-2289"><span class="linenos">2289</span></a>            <span class="k">if</span> <span class="n">rule_category</span> <span class="o">==</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">:</span>
</span><span id="execute_phase_2-2290"><a href="#execute_phase_2-2290"><span class="linenos">2290</span></a>                <span class="k">for</span> <span class="n">other_rule</span> <span class="ow">in</span> <span class="n">filtered_rules</span><span class="p">:</span>
</span><span id="execute_phase_2-2291"><a href="#execute_phase_2-2291"><span class="linenos">2291</span></a>                    <span class="k">if</span> <span class="n">other_rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Style&quot;</span> <span class="ow">and</span> <span class="n">other_rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">rule_name</span><span class="p">:</span>
</span><span id="execute_phase_2-2292"><a href="#execute_phase_2-2292"><span class="linenos">2292</span></a>                        <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="execute_phase_2-2293"><a href="#execute_phase_2-2293"><span class="linenos">2293</span></a>
</span><span id="execute_phase_2-2294"><a href="#execute_phase_2-2294"><span class="linenos">2294</span></a>            <span class="c1"># Add the dependencies to the rule</span>
</span><span id="execute_phase_2-2295"><a href="#execute_phase_2-2295"><span class="linenos">2295</span></a>            <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;dependencies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dependencies</span>  <span class="c1"># type: ignore</span>
</span><span id="execute_phase_2-2296"><a href="#execute_phase_2-2296"><span class="linenos">2296</span></a>
</span><span id="execute_phase_2-2297"><a href="#execute_phase_2-2297"><span class="linenos">2297</span></a>        <span class="c1"># Update the workflow state</span>
</span><span id="execute_phase_2-2298"><a href="#execute_phase_2-2298"><span class="linenos">2298</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;recommended_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_rules</span>
</span><span id="execute_phase_2-2299"><a href="#execute_phase_2-2299"><span class="linenos">2299</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;categorized_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categorized_rules</span>
</span><span id="execute_phase_2-2300"><a href="#execute_phase_2-2300"><span class="linenos">2300</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;selected_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_rules</span>  <span class="c1"># Default to selecting all filtered rules</span>
</span><span id="execute_phase_2-2301"><a href="#execute_phase_2-2301"><span class="linenos">2301</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;phase_2_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_2-2302"><a href="#execute_phase_2-2302"><span class="linenos">2302</span></a>
</span><span id="execute_phase_2-2303"><a href="#execute_phase_2-2303"><span class="linenos">2303</span></a>        <span class="c1"># Create a checklist for phase 2 completion</span>
</span><span id="execute_phase_2-2304"><a href="#execute_phase_2-2304"><span class="linenos">2304</span></a>        <span class="n">checklist</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="execute_phase_2-2305"><a href="#execute_phase_2-2305"><span class="linenos">2305</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Generated potential cursor rules&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">recommended_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_2-2306"><a href="#execute_phase_2-2306"><span class="linenos">2306</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Prioritized rules by impact and relevance&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">prioritized_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_2-2307"><a href="#execute_phase_2-2307"><span class="linenos">2307</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Filtered out redundant rules&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_rules</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">recommended_rules</span><span class="p">)},</span>
</span><span id="execute_phase_2-2308"><a href="#execute_phase_2-2308"><span class="linenos">2308</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Grouped rules into categories&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorized_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_2-2309"><a href="#execute_phase_2-2309"><span class="linenos">2309</span></a>            <span class="p">{</span>
</span><span id="execute_phase_2-2310"><a href="#execute_phase_2-2310"><span class="linenos">2310</span></a>                <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Identified dependencies between rules&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2311"><a href="#execute_phase_2-2311"><span class="linenos">2311</span></a>                <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">any</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dependencies&quot;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">filtered_rules</span><span class="p">),</span>
</span><span id="execute_phase_2-2312"><a href="#execute_phase_2-2312"><span class="linenos">2312</span></a>            <span class="p">},</span>
</span><span id="execute_phase_2-2313"><a href="#execute_phase_2-2313"><span class="linenos">2313</span></a>        <span class="p">]</span>
</span><span id="execute_phase_2-2314"><a href="#execute_phase_2-2314"><span class="linenos">2314</span></a>
</span><span id="execute_phase_2-2315"><a href="#execute_phase_2-2315"><span class="linenos">2315</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_2-2316"><a href="#execute_phase_2-2316"><span class="linenos">2316</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2317"><a href="#execute_phase_2-2317"><span class="linenos">2317</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 2 (Rule Identification) completed successfully.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2318"><a href="#execute_phase_2-2318"><span class="linenos">2318</span></a>            <span class="s2">&quot;checklist&quot;</span><span class="p">:</span> <span class="n">checklist</span><span class="p">,</span>
</span><span id="execute_phase_2-2319"><a href="#execute_phase_2-2319"><span class="linenos">2319</span></a>            <span class="s2">&quot;recommended_rules&quot;</span><span class="p">:</span> <span class="n">filtered_rules</span><span class="p">,</span>
</span><span id="execute_phase_2-2320"><a href="#execute_phase_2-2320"><span class="linenos">2320</span></a>            <span class="s2">&quot;categorized_rules&quot;</span><span class="p">:</span> <span class="n">categorized_rules</span><span class="p">,</span>
</span><span id="execute_phase_2-2321"><a href="#execute_phase_2-2321"><span class="linenos">2321</span></a>            <span class="s2">&quot;total_rules&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_rules</span><span class="p">),</span>
</span><span id="execute_phase_2-2322"><a href="#execute_phase_2-2322"><span class="linenos">2322</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_2-2323"><a href="#execute_phase_2-2323"><span class="linenos">2323</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="execute_phase_2-2324"><a href="#execute_phase_2-2324"><span class="linenos">2324</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Proceed to Phase 3: Workspace Preparation to set up your environment for cursor rule creation.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2325"><a href="#execute_phase_2-2325"><span class="linenos">2325</span></a>        <span class="p">}</span>
</span><span id="execute_phase_2-2326"><a href="#execute_phase_2-2326"><span class="linenos">2326</span></a>
</span><span id="execute_phase_2-2327"><a href="#execute_phase_2-2327"><span class="linenos">2327</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_2-2328"><a href="#execute_phase_2-2328"><span class="linenos">2328</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_2-2329"><a href="#execute_phase_2-2329"><span class="linenos">2329</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2330"><a href="#execute_phase_2-2330"><span class="linenos">2330</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error during rule identification: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_2-2331"><a href="#execute_phase_2-2331"><span class="linenos">2331</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_2-2332"><a href="#execute_phase_2-2332"><span class="linenos">2332</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute Phase 2: Rule Identification.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>workflow_state:</strong>  Current state of the workflow</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Updated workflow state and next steps</p>
</blockquote>
</div>


                </section>
                <section id="execute_phase_3">
                            <input id="execute_phase_3-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_phase_3</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="execute_phase_3-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#execute_phase_3"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="execute_phase_3-2335"><a href="#execute_phase_3-2335"><span class="linenos">2335</span></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_phase_3</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="execute_phase_3-2336"><a href="#execute_phase_3-2336"><span class="linenos">2336</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute Phase 3: Workspace Preparation.</span>
</span><span id="execute_phase_3-2337"><a href="#execute_phase_3-2337"><span class="linenos">2337</span></a>
</span><span id="execute_phase_3-2338"><a href="#execute_phase_3-2338"><span class="linenos">2338</span></a><span class="sd">    Args:</span>
</span><span id="execute_phase_3-2339"><a href="#execute_phase_3-2339"><span class="linenos">2339</span></a><span class="sd">        workflow_state: Current state of the workflow</span>
</span><span id="execute_phase_3-2340"><a href="#execute_phase_3-2340"><span class="linenos">2340</span></a>
</span><span id="execute_phase_3-2341"><a href="#execute_phase_3-2341"><span class="linenos">2341</span></a><span class="sd">    Returns:</span>
</span><span id="execute_phase_3-2342"><a href="#execute_phase_3-2342"><span class="linenos">2342</span></a><span class="sd">        dict[str, Any]: Updated workflow state and next steps</span>
</span><span id="execute_phase_3-2343"><a href="#execute_phase_3-2343"><span class="linenos">2343</span></a>
</span><span id="execute_phase_3-2344"><a href="#execute_phase_3-2344"><span class="linenos">2344</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="execute_phase_3-2345"><a href="#execute_phase_3-2345"><span class="linenos">2345</span></a>    <span class="c1"># If Phase 3 is already complete, return the state and suggest moving to Phase 4</span>
</span><span id="execute_phase_3-2346"><a href="#execute_phase_3-2346"><span class="linenos">2346</span></a>    <span class="k">if</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_3_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_3-2347"><a href="#execute_phase_3-2347"><span class="linenos">2347</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2348"><a href="#execute_phase_3-2348"><span class="linenos">2348</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;already_complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2349"><a href="#execute_phase_3-2349"><span class="linenos">2349</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 3 (Workspace Preparation) is already complete. Proceed to Phase 4.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2350"><a href="#execute_phase_3-2350"><span class="linenos">2350</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2351"><a href="#execute_phase_3-2351"><span class="linenos">2351</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="execute_phase_3-2352"><a href="#execute_phase_3-2352"><span class="linenos">2352</span></a>        <span class="p">}</span>
</span><span id="execute_phase_3-2353"><a href="#execute_phase_3-2353"><span class="linenos">2353</span></a>
</span><span id="execute_phase_3-2354"><a href="#execute_phase_3-2354"><span class="linenos">2354</span></a>    <span class="c1"># Check if Phase 2 is complete</span>
</span><span id="execute_phase_3-2355"><a href="#execute_phase_3-2355"><span class="linenos">2355</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_2_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_3-2356"><a href="#execute_phase_3-2356"><span class="linenos">2356</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2357"><a href="#execute_phase_3-2357"><span class="linenos">2357</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;prerequisite_not_met&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2358"><a href="#execute_phase_3-2358"><span class="linenos">2358</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 2 (Rule Identification) must be completed before proceeding to Phase 3.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2359"><a href="#execute_phase_3-2359"><span class="linenos">2359</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2360"><a href="#execute_phase_3-2360"><span class="linenos">2360</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="execute_phase_3-2361"><a href="#execute_phase_3-2361"><span class="linenos">2361</span></a>        <span class="p">}</span>
</span><span id="execute_phase_3-2362"><a href="#execute_phase_3-2362"><span class="linenos">2362</span></a>
</span><span id="execute_phase_3-2363"><a href="#execute_phase_3-2363"><span class="linenos">2363</span></a>    <span class="c1"># Extract rule information from Phase 2</span>
</span><span id="execute_phase_3-2364"><a href="#execute_phase_3-2364"><span class="linenos">2364</span></a>    <span class="n">selected_rules</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_rules&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_3-2365"><a href="#execute_phase_3-2365"><span class="linenos">2365</span></a>
</span><span id="execute_phase_3-2366"><a href="#execute_phase_3-2366"><span class="linenos">2366</span></a>    <span class="c1"># Get rule names from the selected rules</span>
</span><span id="execute_phase_3-2367"><a href="#execute_phase_3-2367"><span class="linenos">2367</span></a>    <span class="n">rule_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;rule_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected_rules</span><span class="p">)]</span>
</span><span id="execute_phase_3-2368"><a href="#execute_phase_3-2368"><span class="linenos">2368</span></a>
</span><span id="execute_phase_3-2369"><a href="#execute_phase_3-2369"><span class="linenos">2369</span></a>    <span class="c1"># Ensure rule names are valid and unique</span>
</span><span id="execute_phase_3-2370"><a href="#execute_phase_3-2370"><span class="linenos">2370</span></a>    <span class="n">valid_rule_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_3-2371"><a href="#execute_phase_3-2371"><span class="linenos">2371</span></a>    <span class="n">seen_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="execute_phase_3-2372"><a href="#execute_phase_3-2372"><span class="linenos">2372</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">rule_names</span><span class="p">:</span>
</span><span id="execute_phase_3-2373"><a href="#execute_phase_3-2373"><span class="linenos">2373</span></a>        <span class="c1"># Create a valid filename from the rule name</span>
</span><span id="execute_phase_3-2374"><a href="#execute_phase_3-2374"><span class="linenos">2374</span></a>        <span class="n">valid_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
</span><span id="execute_phase_3-2375"><a href="#execute_phase_3-2375"><span class="linenos">2375</span></a>
</span><span id="execute_phase_3-2376"><a href="#execute_phase_3-2376"><span class="linenos">2376</span></a>        <span class="c1"># Ensure uniqueness by adding a suffix if needed</span>
</span><span id="execute_phase_3-2377"><a href="#execute_phase_3-2377"><span class="linenos">2377</span></a>        <span class="k">if</span> <span class="n">valid_name</span> <span class="ow">in</span> <span class="n">seen_names</span><span class="p">:</span>
</span><span id="execute_phase_3-2378"><a href="#execute_phase_3-2378"><span class="linenos">2378</span></a>            <span class="n">suffix</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="execute_phase_3-2379"><a href="#execute_phase_3-2379"><span class="linenos">2379</span></a>            <span class="k">while</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">valid_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">seen_names</span><span class="p">:</span>
</span><span id="execute_phase_3-2380"><a href="#execute_phase_3-2380"><span class="linenos">2380</span></a>                <span class="n">suffix</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="execute_phase_3-2381"><a href="#execute_phase_3-2381"><span class="linenos">2381</span></a>            <span class="n">valid_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">valid_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="execute_phase_3-2382"><a href="#execute_phase_3-2382"><span class="linenos">2382</span></a>
</span><span id="execute_phase_3-2383"><a href="#execute_phase_3-2383"><span class="linenos">2383</span></a>        <span class="n">seen_names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">valid_name</span><span class="p">)</span>
</span><span id="execute_phase_3-2384"><a href="#execute_phase_3-2384"><span class="linenos">2384</span></a>        <span class="n">valid_rule_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valid_name</span><span class="p">)</span>
</span><span id="execute_phase_3-2385"><a href="#execute_phase_3-2385"><span class="linenos">2385</span></a>
</span><span id="execute_phase_3-2386"><a href="#execute_phase_3-2386"><span class="linenos">2386</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_3-2387"><a href="#execute_phase_3-2387"><span class="linenos">2387</span></a>        <span class="c1"># Get the workspace result from the initial preparation</span>
</span><span id="execute_phase_3-2388"><a href="#execute_phase_3-2388"><span class="linenos">2388</span></a>        <span class="n">workspace_result</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;workspace_result&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_3-2389"><a href="#execute_phase_3-2389"><span class="linenos">2389</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">workspace_result</span><span class="p">:</span>
</span><span id="execute_phase_3-2390"><a href="#execute_phase_3-2390"><span class="linenos">2390</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2391"><a href="#execute_phase_3-2391"><span class="linenos">2391</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2392"><a href="#execute_phase_3-2392"><span class="linenos">2392</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Workspace preparation result not found in workflow state.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2393"><a href="#execute_phase_3-2393"><span class="linenos">2393</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2394"><a href="#execute_phase_3-2394"><span class="linenos">2394</span></a>            <span class="p">}</span>
</span><span id="execute_phase_3-2395"><a href="#execute_phase_3-2395"><span class="linenos">2395</span></a>
</span><span id="execute_phase_3-2396"><a href="#execute_phase_3-2396"><span class="linenos">2396</span></a>        <span class="c1"># Step 2: Ensure the Makefile has the update-cursor-rules task</span>
</span><span id="execute_phase_3-2397"><a href="#execute_phase_3-2397"><span class="linenos">2397</span></a>        <span class="n">makefile_result</span> <span class="o">=</span> <span class="n">ensure_makefile_task</span><span class="p">()</span>
</span><span id="execute_phase_3-2398"><a href="#execute_phase_3-2398"><span class="linenos">2398</span></a>
</span><span id="execute_phase_3-2399"><a href="#execute_phase_3-2399"><span class="linenos">2399</span></a>        <span class="c1"># Step 3: Update .dockerignore to exclude drafts directory</span>
</span><span id="execute_phase_3-2400"><a href="#execute_phase_3-2400"><span class="linenos">2400</span></a>        <span class="n">dockerignore_result</span> <span class="o">=</span> <span class="n">update_dockerignore</span><span class="p">()</span>
</span><span id="execute_phase_3-2401"><a href="#execute_phase_3-2401"><span class="linenos">2401</span></a>
</span><span id="execute_phase_3-2402"><a href="#execute_phase_3-2402"><span class="linenos">2402</span></a>        <span class="c1"># Step 4: Create empty files for each planned cursor rule</span>
</span><span id="execute_phase_3-2403"><a href="#execute_phase_3-2403"><span class="linenos">2403</span></a>        <span class="n">files_result</span> <span class="o">=</span> <span class="n">create_cursor_rule_files</span><span class="p">(</span><span class="n">valid_rule_names</span><span class="p">)</span>
</span><span id="execute_phase_3-2404"><a href="#execute_phase_3-2404"><span class="linenos">2404</span></a>
</span><span id="execute_phase_3-2405"><a href="#execute_phase_3-2405"><span class="linenos">2405</span></a>        <span class="c1"># Check if any of the operations failed</span>
</span><span id="execute_phase_3-2406"><a href="#execute_phase_3-2406"><span class="linenos">2406</span></a>        <span class="k">if</span> <span class="n">makefile_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="execute_phase_3-2407"><a href="#execute_phase_3-2407"><span class="linenos">2407</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2408"><a href="#execute_phase_3-2408"><span class="linenos">2408</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2409"><a href="#execute_phase_3-2409"><span class="linenos">2409</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error ensuring Makefile task: </span><span class="si">{</span><span class="n">makefile_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2410"><a href="#execute_phase_3-2410"><span class="linenos">2410</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2411"><a href="#execute_phase_3-2411"><span class="linenos">2411</span></a>            <span class="p">}</span>
</span><span id="execute_phase_3-2412"><a href="#execute_phase_3-2412"><span class="linenos">2412</span></a>
</span><span id="execute_phase_3-2413"><a href="#execute_phase_3-2413"><span class="linenos">2413</span></a>        <span class="k">if</span> <span class="n">dockerignore_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="execute_phase_3-2414"><a href="#execute_phase_3-2414"><span class="linenos">2414</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2415"><a href="#execute_phase_3-2415"><span class="linenos">2415</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2416"><a href="#execute_phase_3-2416"><span class="linenos">2416</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error updating .dockerignore: </span><span class="si">{</span><span class="n">dockerignore_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2417"><a href="#execute_phase_3-2417"><span class="linenos">2417</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2418"><a href="#execute_phase_3-2418"><span class="linenos">2418</span></a>            <span class="p">}</span>
</span><span id="execute_phase_3-2419"><a href="#execute_phase_3-2419"><span class="linenos">2419</span></a>
</span><span id="execute_phase_3-2420"><a href="#execute_phase_3-2420"><span class="linenos">2420</span></a>        <span class="k">if</span> <span class="n">files_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="execute_phase_3-2421"><a href="#execute_phase_3-2421"><span class="linenos">2421</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2422"><a href="#execute_phase_3-2422"><span class="linenos">2422</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2423"><a href="#execute_phase_3-2423"><span class="linenos">2423</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error creating cursor rule files: </span><span class="si">{</span><span class="n">files_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2424"><a href="#execute_phase_3-2424"><span class="linenos">2424</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2425"><a href="#execute_phase_3-2425"><span class="linenos">2425</span></a>            <span class="p">}</span>
</span><span id="execute_phase_3-2426"><a href="#execute_phase_3-2426"><span class="linenos">2426</span></a>
</span><span id="execute_phase_3-2427"><a href="#execute_phase_3-2427"><span class="linenos">2427</span></a>        <span class="c1"># Update the workflow state</span>
</span><span id="execute_phase_3-2428"><a href="#execute_phase_3-2428"><span class="linenos">2428</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;phase_3_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_3-2429"><a href="#execute_phase_3-2429"><span class="linenos">2429</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;rule_file_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_rule_names</span>
</span><span id="execute_phase_3-2430"><a href="#execute_phase_3-2430"><span class="linenos">2430</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;workspace_prepared&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_3-2431"><a href="#execute_phase_3-2431"><span class="linenos">2431</span></a>
</span><span id="execute_phase_3-2432"><a href="#execute_phase_3-2432"><span class="linenos">2432</span></a>        <span class="c1"># Map rule metadata to file names</span>
</span><span id="execute_phase_3-2433"><a href="#execute_phase_3-2433"><span class="linenos">2433</span></a>        <span class="n">rule_file_mapping</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="execute_phase_3-2434"><a href="#execute_phase_3-2434"><span class="linenos">2434</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rule_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valid_rule_names</span><span class="p">):</span>
</span><span id="execute_phase_3-2435"><a href="#execute_phase_3-2435"><span class="linenos">2435</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_rules</span><span class="p">):</span>
</span><span id="execute_phase_3-2436"><a href="#execute_phase_3-2436"><span class="linenos">2436</span></a>                <span class="n">rule_file_mapping</span><span class="p">[</span><span class="n">rule_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_rules</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="execute_phase_3-2437"><a href="#execute_phase_3-2437"><span class="linenos">2437</span></a>
</span><span id="execute_phase_3-2438"><a href="#execute_phase_3-2438"><span class="linenos">2438</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;rule_file_mapping&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule_file_mapping</span>
</span><span id="execute_phase_3-2439"><a href="#execute_phase_3-2439"><span class="linenos">2439</span></a>
</span><span id="execute_phase_3-2440"><a href="#execute_phase_3-2440"><span class="linenos">2440</span></a>        <span class="c1"># Create a checklist for phase 3 completion</span>
</span><span id="execute_phase_3-2441"><a href="#execute_phase_3-2441"><span class="linenos">2441</span></a>        <span class="n">checklist</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="execute_phase_3-2442"><a href="#execute_phase_3-2442"><span class="linenos">2442</span></a>            <span class="p">{</span>
</span><span id="execute_phase_3-2443"><a href="#execute_phase_3-2443"><span class="linenos">2443</span></a>                <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Created cursor rules directory structure&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2444"><a href="#execute_phase_3-2444"><span class="linenos">2444</span></a>                <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Already completed in initial preparation</span>
</span><span id="execute_phase_3-2445"><a href="#execute_phase_3-2445"><span class="linenos">2445</span></a>            <span class="p">},</span>
</span><span id="execute_phase_3-2446"><a href="#execute_phase_3-2446"><span class="linenos">2446</span></a>            <span class="p">{</span>
</span><span id="execute_phase_3-2447"><a href="#execute_phase_3-2447"><span class="linenos">2447</span></a>                <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensured Makefile has update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2448"><a href="#execute_phase_3-2448"><span class="linenos">2448</span></a>                <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="n">makefile_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2449"><a href="#execute_phase_3-2449"><span class="linenos">2449</span></a>            <span class="p">},</span>
</span><span id="execute_phase_3-2450"><a href="#execute_phase_3-2450"><span class="linenos">2450</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Updated .dockerignore&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="n">dockerignore_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">},</span>
</span><span id="execute_phase_3-2451"><a href="#execute_phase_3-2451"><span class="linenos">2451</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Prepared empty files for cursor rules&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="n">files_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">},</span>
</span><span id="execute_phase_3-2452"><a href="#execute_phase_3-2452"><span class="linenos">2452</span></a>        <span class="p">]</span>
</span><span id="execute_phase_3-2453"><a href="#execute_phase_3-2453"><span class="linenos">2453</span></a>
</span><span id="execute_phase_3-2454"><a href="#execute_phase_3-2454"><span class="linenos">2454</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2455"><a href="#execute_phase_3-2455"><span class="linenos">2455</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2456"><a href="#execute_phase_3-2456"><span class="linenos">2456</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 3 (Workspace Preparation) completed successfully.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2457"><a href="#execute_phase_3-2457"><span class="linenos">2457</span></a>            <span class="s2">&quot;checklist&quot;</span><span class="p">:</span> <span class="n">checklist</span><span class="p">,</span>
</span><span id="execute_phase_3-2458"><a href="#execute_phase_3-2458"><span class="linenos">2458</span></a>            <span class="s2">&quot;rule_files&quot;</span><span class="p">:</span> <span class="n">valid_rule_names</span><span class="p">,</span>
</span><span id="execute_phase_3-2459"><a href="#execute_phase_3-2459"><span class="linenos">2459</span></a>            <span class="s2">&quot;directory_structure&quot;</span><span class="p">:</span> <span class="n">workspace_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory_structure&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="execute_phase_3-2460"><a href="#execute_phase_3-2460"><span class="linenos">2460</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2461"><a href="#execute_phase_3-2461"><span class="linenos">2461</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="execute_phase_3-2462"><a href="#execute_phase_3-2462"><span class="linenos">2462</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Proceed to Phase 4: Rule Creation to implement each cursor rule.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2463"><a href="#execute_phase_3-2463"><span class="linenos">2463</span></a>        <span class="p">}</span>
</span><span id="execute_phase_3-2464"><a href="#execute_phase_3-2464"><span class="linenos">2464</span></a>
</span><span id="execute_phase_3-2465"><a href="#execute_phase_3-2465"><span class="linenos">2465</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_3-2466"><a href="#execute_phase_3-2466"><span class="linenos">2466</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_3-2467"><a href="#execute_phase_3-2467"><span class="linenos">2467</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2468"><a href="#execute_phase_3-2468"><span class="linenos">2468</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error during workspace preparation: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_3-2469"><a href="#execute_phase_3-2469"><span class="linenos">2469</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_3-2470"><a href="#execute_phase_3-2470"><span class="linenos">2470</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute Phase 3: Workspace Preparation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>workflow_state:</strong>  Current state of the workflow</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Updated workflow state and next steps</p>
</blockquote>
</div>


                </section>
                <section id="execute_phase_4">
                            <input id="execute_phase_4-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_phase_4</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="execute_phase_4-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#execute_phase_4"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="execute_phase_4-2473"><a href="#execute_phase_4-2473"><span class="linenos">2473</span></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_phase_4</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="execute_phase_4-2474"><a href="#execute_phase_4-2474"><span class="linenos">2474</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute Phase 4: Rule Creation.</span>
</span><span id="execute_phase_4-2475"><a href="#execute_phase_4-2475"><span class="linenos">2475</span></a>
</span><span id="execute_phase_4-2476"><a href="#execute_phase_4-2476"><span class="linenos">2476</span></a><span class="sd">    Args:</span>
</span><span id="execute_phase_4-2477"><a href="#execute_phase_4-2477"><span class="linenos">2477</span></a><span class="sd">        workflow_state: Current state of the workflow</span>
</span><span id="execute_phase_4-2478"><a href="#execute_phase_4-2478"><span class="linenos">2478</span></a>
</span><span id="execute_phase_4-2479"><a href="#execute_phase_4-2479"><span class="linenos">2479</span></a><span class="sd">    Returns:</span>
</span><span id="execute_phase_4-2480"><a href="#execute_phase_4-2480"><span class="linenos">2480</span></a><span class="sd">        dict[str, Any]: Updated workflow state and next steps</span>
</span><span id="execute_phase_4-2481"><a href="#execute_phase_4-2481"><span class="linenos">2481</span></a>
</span><span id="execute_phase_4-2482"><a href="#execute_phase_4-2482"><span class="linenos">2482</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="execute_phase_4-2483"><a href="#execute_phase_4-2483"><span class="linenos">2483</span></a>    <span class="c1"># If Phase 4 is already complete, return the state and suggest moving to Phase 5</span>
</span><span id="execute_phase_4-2484"><a href="#execute_phase_4-2484"><span class="linenos">2484</span></a>    <span class="k">if</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_4_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_4-2485"><a href="#execute_phase_4-2485"><span class="linenos">2485</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_4-2486"><a href="#execute_phase_4-2486"><span class="linenos">2486</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;already_complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2487"><a href="#execute_phase_4-2487"><span class="linenos">2487</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 4 (Rule Creation) is already complete. Proceed to Phase 5.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2488"><a href="#execute_phase_4-2488"><span class="linenos">2488</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_4-2489"><a href="#execute_phase_4-2489"><span class="linenos">2489</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="execute_phase_4-2490"><a href="#execute_phase_4-2490"><span class="linenos">2490</span></a>        <span class="p">}</span>
</span><span id="execute_phase_4-2491"><a href="#execute_phase_4-2491"><span class="linenos">2491</span></a>
</span><span id="execute_phase_4-2492"><a href="#execute_phase_4-2492"><span class="linenos">2492</span></a>    <span class="c1"># Check if Phase 3 is complete</span>
</span><span id="execute_phase_4-2493"><a href="#execute_phase_4-2493"><span class="linenos">2493</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_3_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_4-2494"><a href="#execute_phase_4-2494"><span class="linenos">2494</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_4-2495"><a href="#execute_phase_4-2495"><span class="linenos">2495</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;prerequisite_not_met&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2496"><a href="#execute_phase_4-2496"><span class="linenos">2496</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 3 (Workspace Preparation) must be completed before proceeding to Phase 4.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2497"><a href="#execute_phase_4-2497"><span class="linenos">2497</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_4-2498"><a href="#execute_phase_4-2498"><span class="linenos">2498</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="execute_phase_4-2499"><a href="#execute_phase_4-2499"><span class="linenos">2499</span></a>        <span class="p">}</span>
</span><span id="execute_phase_4-2500"><a href="#execute_phase_4-2500"><span class="linenos">2500</span></a>
</span><span id="execute_phase_4-2501"><a href="#execute_phase_4-2501"><span class="linenos">2501</span></a>    <span class="c1"># Extract rule information from previous phases</span>
</span><span id="execute_phase_4-2502"><a href="#execute_phase_4-2502"><span class="linenos">2502</span></a>    <span class="n">rule_file_names</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rule_file_names&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_4-2503"><a href="#execute_phase_4-2503"><span class="linenos">2503</span></a>    <span class="n">rule_file_mapping</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rule_file_mapping&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_4-2504"><a href="#execute_phase_4-2504"><span class="linenos">2504</span></a>
</span><span id="execute_phase_4-2505"><a href="#execute_phase_4-2505"><span class="linenos">2505</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">rule_file_names</span><span class="p">:</span>
</span><span id="execute_phase_4-2506"><a href="#execute_phase_4-2506"><span class="linenos">2506</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_4-2507"><a href="#execute_phase_4-2507"><span class="linenos">2507</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2508"><a href="#execute_phase_4-2508"><span class="linenos">2508</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;No rule files found. Please complete Phase 3 properly.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2509"><a href="#execute_phase_4-2509"><span class="linenos">2509</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_4-2510"><a href="#execute_phase_4-2510"><span class="linenos">2510</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="execute_phase_4-2511"><a href="#execute_phase_4-2511"><span class="linenos">2511</span></a>        <span class="p">}</span>
</span><span id="execute_phase_4-2512"><a href="#execute_phase_4-2512"><span class="linenos">2512</span></a>
</span><span id="execute_phase_4-2513"><a href="#execute_phase_4-2513"><span class="linenos">2513</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_4-2514"><a href="#execute_phase_4-2514"><span class="linenos">2514</span></a>        <span class="c1"># Track created rules and any errors</span>
</span><span id="execute_phase_4-2515"><a href="#execute_phase_4-2515"><span class="linenos">2515</span></a>        <span class="n">created_rules</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_4-2516"><a href="#execute_phase_4-2516"><span class="linenos">2516</span></a>        <span class="n">creation_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_4-2517"><a href="#execute_phase_4-2517"><span class="linenos">2517</span></a>
</span><span id="execute_phase_4-2518"><a href="#execute_phase_4-2518"><span class="linenos">2518</span></a>        <span class="c1"># Process each rule file</span>
</span><span id="execute_phase_4-2519"><a href="#execute_phase_4-2519"><span class="linenos">2519</span></a>        <span class="k">for</span> <span class="n">rule_name</span> <span class="ow">in</span> <span class="n">rule_file_names</span><span class="p">:</span>
</span><span id="execute_phase_4-2520"><a href="#execute_phase_4-2520"><span class="linenos">2520</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_4-2521"><a href="#execute_phase_4-2521"><span class="linenos">2521</span></a>                <span class="c1"># Get rule metadata from mapping</span>
</span><span id="execute_phase_4-2522"><a href="#execute_phase_4-2522"><span class="linenos">2522</span></a>                <span class="n">rule_metadata</span> <span class="o">=</span> <span class="n">rule_file_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rule_name</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="execute_phase_4-2523"><a href="#execute_phase_4-2523"><span class="linenos">2523</span></a>
</span><span id="execute_phase_4-2524"><a href="#execute_phase_4-2524"><span class="linenos">2524</span></a>                <span class="c1"># Extract or generate rule components</span>
</span><span id="execute_phase_4-2525"><a href="#execute_phase_4-2525"><span class="linenos">2525</span></a>                <span class="n">rule_description</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Rule for </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2526"><a href="#execute_phase_4-2526"><span class="linenos">2526</span></a>
</span><span id="execute_phase_4-2527"><a href="#execute_phase_4-2527"><span class="linenos">2527</span></a>                <span class="c1"># Determine file patterns to match</span>
</span><span id="execute_phase_4-2528"><a href="#execute_phase_4-2528"><span class="linenos">2528</span></a>                <span class="n">file_patterns</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_patterns&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_4-2529"><a href="#execute_phase_4-2529"><span class="linenos">2529</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">file_patterns</span> <span class="ow">and</span> <span class="s2">&quot;category&quot;</span> <span class="ow">in</span> <span class="n">rule_metadata</span><span class="p">:</span>
</span><span id="execute_phase_4-2530"><a href="#execute_phase_4-2530"><span class="linenos">2530</span></a>                    <span class="c1"># Generate default patterns based on category</span>
</span><span id="execute_phase_4-2531"><a href="#execute_phase_4-2531"><span class="linenos">2531</span></a>                    <span class="n">category</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2532"><a href="#execute_phase_4-2532"><span class="linenos">2532</span></a>                    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Python&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2533"><a href="#execute_phase_4-2533"><span class="linenos">2533</span></a>                        <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2534"><a href="#execute_phase_4-2534"><span class="linenos">2534</span></a>                    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;JavaScript&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2535"><a href="#execute_phase_4-2535"><span class="linenos">2535</span></a>                        <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.js&quot;</span><span class="p">,</span> <span class="s2">&quot;*.jsx&quot;</span><span class="p">,</span> <span class="s2">&quot;*.ts&quot;</span><span class="p">,</span> <span class="s2">&quot;*.tsx&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2536"><a href="#execute_phase_4-2536"><span class="linenos">2536</span></a>                    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2537"><a href="#execute_phase_4-2537"><span class="linenos">2537</span></a>                        <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.md&quot;</span><span class="p">,</span> <span class="s2">&quot;README*&quot;</span><span class="p">,</span> <span class="s2">&quot;CONTRIBUTING*&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2538"><a href="#execute_phase_4-2538"><span class="linenos">2538</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2539"><a href="#execute_phase_4-2539"><span class="linenos">2539</span></a>                        <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2540"><a href="#execute_phase_4-2540"><span class="linenos">2540</span></a>
</span><span id="execute_phase_4-2541"><a href="#execute_phase_4-2541"><span class="linenos">2541</span></a>                <span class="c1"># Convert file patterns to string if needed</span>
</span><span id="execute_phase_4-2542"><a href="#execute_phase_4-2542"><span class="linenos">2542</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="execute_phase_4-2543"><a href="#execute_phase_4-2543"><span class="linenos">2543</span></a>                    <span class="n">file_patterns_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">)</span>
</span><span id="execute_phase_4-2544"><a href="#execute_phase_4-2544"><span class="linenos">2544</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2545"><a href="#execute_phase_4-2545"><span class="linenos">2545</span></a>                    <span class="n">file_patterns_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">)</span>
</span><span id="execute_phase_4-2546"><a href="#execute_phase_4-2546"><span class="linenos">2546</span></a>
</span><span id="execute_phase_4-2547"><a href="#execute_phase_4-2547"><span class="linenos">2547</span></a>                <span class="c1"># Determine content patterns to match</span>
</span><span id="execute_phase_4-2548"><a href="#execute_phase_4-2548"><span class="linenos">2548</span></a>                <span class="n">content_patterns</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content_patterns&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_4-2549"><a href="#execute_phase_4-2549"><span class="linenos">2549</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">content_patterns</span> <span class="ow">and</span> <span class="s2">&quot;category&quot;</span> <span class="ow">in</span> <span class="n">rule_metadata</span><span class="p">:</span>
</span><span id="execute_phase_4-2550"><a href="#execute_phase_4-2550"><span class="linenos">2550</span></a>                    <span class="c1"># Generate default patterns based on category</span>
</span><span id="execute_phase_4-2551"><a href="#execute_phase_4-2551"><span class="linenos">2551</span></a>                    <span class="n">category</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2552"><a href="#execute_phase_4-2552"><span class="linenos">2552</span></a>                    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Python&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2553"><a href="#execute_phase_4-2553"><span class="linenos">2553</span></a>                        <span class="n">content_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;def &quot;</span><span class="p">,</span> <span class="s2">&quot;class &quot;</span><span class="p">,</span> <span class="s2">&quot;import &quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2554"><a href="#execute_phase_4-2554"><span class="linenos">2554</span></a>                    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;JavaScript&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2555"><a href="#execute_phase_4-2555"><span class="linenos">2555</span></a>                        <span class="n">content_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="s2">&quot;const&quot;</span><span class="p">,</span> <span class="s2">&quot;import&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2556"><a href="#execute_phase_4-2556"><span class="linenos">2556</span></a>                    <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">:</span>
</span><span id="execute_phase_4-2557"><a href="#execute_phase_4-2557"><span class="linenos">2557</span></a>                        <span class="n">content_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;##&quot;</span><span class="p">,</span> <span class="s2">&quot;```&quot;</span><span class="p">]</span>
</span><span id="execute_phase_4-2558"><a href="#execute_phase_4-2558"><span class="linenos">2558</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2559"><a href="#execute_phase_4-2559"><span class="linenos">2559</span></a>                        <span class="n">content_patterns</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_4-2560"><a href="#execute_phase_4-2560"><span class="linenos">2560</span></a>
</span><span id="execute_phase_4-2561"><a href="#execute_phase_4-2561"><span class="linenos">2561</span></a>                <span class="c1"># Convert content patterns to string if needed</span>
</span><span id="execute_phase_4-2562"><a href="#execute_phase_4-2562"><span class="linenos">2562</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content_patterns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="execute_phase_4-2563"><a href="#execute_phase_4-2563"><span class="linenos">2563</span></a>                    <span class="n">content_patterns_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content_patterns</span><span class="p">)</span>
</span><span id="execute_phase_4-2564"><a href="#execute_phase_4-2564"><span class="linenos">2564</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2565"><a href="#execute_phase_4-2565"><span class="linenos">2565</span></a>                    <span class="n">content_patterns_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content_patterns</span><span class="p">)</span>
</span><span id="execute_phase_4-2566"><a href="#execute_phase_4-2566"><span class="linenos">2566</span></a>
</span><span id="execute_phase_4-2567"><a href="#execute_phase_4-2567"><span class="linenos">2567</span></a>                <span class="c1"># Create action message</span>
</span><span id="execute_phase_4-2568"><a href="#execute_phase_4-2568"><span class="linenos">2568</span></a>                <span class="n">action_message</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;action_message&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Guidance for </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2569"><a href="#execute_phase_4-2569"><span class="linenos">2569</span></a>
</span><span id="execute_phase_4-2570"><a href="#execute_phase_4-2570"><span class="linenos">2570</span></a>                <span class="c1"># Create examples</span>
</span><span id="execute_phase_4-2571"><a href="#execute_phase_4-2571"><span class="linenos">2571</span></a>                <span class="n">examples_str</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;examples&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2572"><a href="#execute_phase_4-2572"><span class="linenos">2572</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">examples_str</span><span class="p">:</span>
</span><span id="execute_phase_4-2573"><a href="#execute_phase_4-2573"><span class="linenos">2573</span></a>                    <span class="c1"># Generate a simple example</span>
</span><span id="execute_phase_4-2574"><a href="#execute_phase_4-2574"><span class="linenos">2574</span></a>                    <span class="n">examples_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="execute_phase_4-2575"><a href="#execute_phase_4-2575"><span class="linenos">2575</span></a><span class="s2">                    # Example input</span>
</span><span id="execute_phase_4-2576"><a href="#execute_phase_4-2576"><span class="linenos">2576</span></a><span class="s2">                    Sample input for the rule</span>
</span><span id="execute_phase_4-2577"><a href="#execute_phase_4-2577"><span class="linenos">2577</span></a>
</span><span id="execute_phase_4-2578"><a href="#execute_phase_4-2578"><span class="linenos">2578</span></a><span class="s2">                    # Example output</span>
</span><span id="execute_phase_4-2579"><a href="#execute_phase_4-2579"><span class="linenos">2579</span></a><span class="s2">                    Expected output or behavior</span>
</span><span id="execute_phase_4-2580"><a href="#execute_phase_4-2580"><span class="linenos">2580</span></a><span class="s2">                    &quot;&quot;&quot;</span>
</span><span id="execute_phase_4-2581"><a href="#execute_phase_4-2581"><span class="linenos">2581</span></a>
</span><span id="execute_phase_4-2582"><a href="#execute_phase_4-2582"><span class="linenos">2582</span></a>                <span class="c1"># Determine tags</span>
</span><span id="execute_phase_4-2583"><a href="#execute_phase_4-2583"><span class="linenos">2583</span></a>                <span class="n">tags</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_4-2584"><a href="#execute_phase_4-2584"><span class="linenos">2584</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">tags</span> <span class="ow">and</span> <span class="s2">&quot;category&quot;</span> <span class="ow">in</span> <span class="n">rule_metadata</span><span class="p">:</span>
</span><span id="execute_phase_4-2585"><a href="#execute_phase_4-2585"><span class="linenos">2585</span></a>                    <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
</span><span id="execute_phase_4-2586"><a href="#execute_phase_4-2586"><span class="linenos">2586</span></a>
</span><span id="execute_phase_4-2587"><a href="#execute_phase_4-2587"><span class="linenos">2587</span></a>                <span class="c1"># Convert tags to string if needed</span>
</span><span id="execute_phase_4-2588"><a href="#execute_phase_4-2588"><span class="linenos">2588</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="execute_phase_4-2589"><a href="#execute_phase_4-2589"><span class="linenos">2589</span></a>                    <span class="n">tags_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span><span id="execute_phase_4-2590"><a href="#execute_phase_4-2590"><span class="linenos">2590</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2591"><a href="#execute_phase_4-2591"><span class="linenos">2591</span></a>                    <span class="n">tags_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span><span id="execute_phase_4-2592"><a href="#execute_phase_4-2592"><span class="linenos">2592</span></a>
</span><span id="execute_phase_4-2593"><a href="#execute_phase_4-2593"><span class="linenos">2593</span></a>                <span class="c1"># Determine priority</span>
</span><span id="execute_phase_4-2594"><a href="#execute_phase_4-2594"><span class="linenos">2594</span></a>                <span class="n">priority</span> <span class="o">=</span> <span class="n">rule_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">)</span>
</span><span id="execute_phase_4-2595"><a href="#execute_phase_4-2595"><span class="linenos">2595</span></a>
</span><span id="execute_phase_4-2596"><a href="#execute_phase_4-2596"><span class="linenos">2596</span></a>                <span class="c1"># Generate the cursor rule content</span>
</span><span id="execute_phase_4-2597"><a href="#execute_phase_4-2597"><span class="linenos">2597</span></a>                <span class="n">rule_content</span> <span class="o">=</span> <span class="n">generate_cursor_rule</span><span class="p">(</span>
</span><span id="execute_phase_4-2598"><a href="#execute_phase_4-2598"><span class="linenos">2598</span></a>                    <span class="n">rule_name</span><span class="o">=</span><span class="n">rule_name</span><span class="p">,</span>
</span><span id="execute_phase_4-2599"><a href="#execute_phase_4-2599"><span class="linenos">2599</span></a>                    <span class="n">description</span><span class="o">=</span><span class="n">rule_description</span><span class="p">,</span>
</span><span id="execute_phase_4-2600"><a href="#execute_phase_4-2600"><span class="linenos">2600</span></a>                    <span class="n">file_patterns</span><span class="o">=</span><span class="n">file_patterns_str</span><span class="p">,</span>
</span><span id="execute_phase_4-2601"><a href="#execute_phase_4-2601"><span class="linenos">2601</span></a>                    <span class="n">content_patterns</span><span class="o">=</span><span class="n">content_patterns_str</span><span class="p">,</span>
</span><span id="execute_phase_4-2602"><a href="#execute_phase_4-2602"><span class="linenos">2602</span></a>                    <span class="n">action_message</span><span class="o">=</span><span class="n">action_message</span><span class="p">,</span>
</span><span id="execute_phase_4-2603"><a href="#execute_phase_4-2603"><span class="linenos">2603</span></a>                    <span class="n">examples</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="s2">&quot;Example input&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="s2">&quot;Example output&quot;</span><span class="p">}],</span>
</span><span id="execute_phase_4-2604"><a href="#execute_phase_4-2604"><span class="linenos">2604</span></a>                    <span class="n">tags</span><span class="o">=</span><span class="n">tags</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">tags_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">),</span>
</span><span id="execute_phase_4-2605"><a href="#execute_phase_4-2605"><span class="linenos">2605</span></a>                    <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span>
</span><span id="execute_phase_4-2606"><a href="#execute_phase_4-2606"><span class="linenos">2606</span></a>                <span class="p">)</span>
</span><span id="execute_phase_4-2607"><a href="#execute_phase_4-2607"><span class="linenos">2607</span></a>
</span><span id="execute_phase_4-2608"><a href="#execute_phase_4-2608"><span class="linenos">2608</span></a>                <span class="c1"># Save the rule to the cursor rules directory</span>
</span><span id="execute_phase_4-2609"><a href="#execute_phase_4-2609"><span class="linenos">2609</span></a>                <span class="n">save_result</span> <span class="o">=</span> <span class="n">save_cursor_rule</span><span class="p">(</span><span class="n">rule_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">.mdc&quot;</span><span class="p">,</span> <span class="n">rule_content</span><span class="o">=</span><span class="n">rule_content</span><span class="p">)</span>
</span><span id="execute_phase_4-2610"><a href="#execute_phase_4-2610"><span class="linenos">2610</span></a>
</span><span id="execute_phase_4-2611"><a href="#execute_phase_4-2611"><span class="linenos">2611</span></a>                <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">save_result</span><span class="p">:</span>
</span><span id="execute_phase_4-2612"><a href="#execute_phase_4-2612"><span class="linenos">2612</span></a>                    <span class="n">creation_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="execute_phase_4-2613"><a href="#execute_phase_4-2613"><span class="linenos">2613</span></a>                        <span class="p">{</span><span class="s2">&quot;rule_name&quot;</span><span class="p">:</span> <span class="n">rule_name</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">save_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown error saving rule&quot;</span><span class="p">)}</span>
</span><span id="execute_phase_4-2614"><a href="#execute_phase_4-2614"><span class="linenos">2614</span></a>                    <span class="p">)</span>
</span><span id="execute_phase_4-2615"><a href="#execute_phase_4-2615"><span class="linenos">2615</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2616"><a href="#execute_phase_4-2616"><span class="linenos">2616</span></a>                    <span class="n">created_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="execute_phase_4-2617"><a href="#execute_phase_4-2617"><span class="linenos">2617</span></a>                        <span class="p">{</span><span class="s2">&quot;rule_name&quot;</span><span class="p">:</span> <span class="n">rule_name</span><span class="p">,</span> <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="n">save_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;created&quot;</span><span class="p">}</span>
</span><span id="execute_phase_4-2618"><a href="#execute_phase_4-2618"><span class="linenos">2618</span></a>                    <span class="p">)</span>
</span><span id="execute_phase_4-2619"><a href="#execute_phase_4-2619"><span class="linenos">2619</span></a>
</span><span id="execute_phase_4-2620"><a href="#execute_phase_4-2620"><span class="linenos">2620</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_4-2621"><a href="#execute_phase_4-2621"><span class="linenos">2621</span></a>                <span class="n">creation_errors</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;rule_name&quot;</span><span class="p">:</span> <span class="n">rule_name</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)})</span>
</span><span id="execute_phase_4-2622"><a href="#execute_phase_4-2622"><span class="linenos">2622</span></a>
</span><span id="execute_phase_4-2623"><a href="#execute_phase_4-2623"><span class="linenos">2623</span></a>        <span class="c1"># Update the workflow state</span>
</span><span id="execute_phase_4-2624"><a href="#execute_phase_4-2624"><span class="linenos">2624</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;created_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">created_rules</span>
</span><span id="execute_phase_4-2625"><a href="#execute_phase_4-2625"><span class="linenos">2625</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;creation_errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">creation_errors</span>
</span><span id="execute_phase_4-2626"><a href="#execute_phase_4-2626"><span class="linenos">2626</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;phase_4_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="execute_phase_4-2627"><a href="#execute_phase_4-2627"><span class="linenos">2627</span></a>
</span><span id="execute_phase_4-2628"><a href="#execute_phase_4-2628"><span class="linenos">2628</span></a>        <span class="c1"># Create a checklist for phase 4 completion</span>
</span><span id="execute_phase_4-2629"><a href="#execute_phase_4-2629"><span class="linenos">2629</span></a>        <span class="n">checklist</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="execute_phase_4-2630"><a href="#execute_phase_4-2630"><span class="linenos">2630</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Defined rule names and descriptions&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2631"><a href="#execute_phase_4-2631"><span class="linenos">2631</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Specified file patterns to match&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2632"><a href="#execute_phase_4-2632"><span class="linenos">2632</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Defined content patterns to match&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2633"><a href="#execute_phase_4-2633"><span class="linenos">2633</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Crafted action messages with guidance&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2634"><a href="#execute_phase_4-2634"><span class="linenos">2634</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Created example input/output pairs&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2635"><a href="#execute_phase_4-2635"><span class="linenos">2635</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Added appropriate tags and metadata&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_4-2636"><a href="#execute_phase_4-2636"><span class="linenos">2636</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Saved rules to cursor rules directory&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_4-2637"><a href="#execute_phase_4-2637"><span class="linenos">2637</span></a>        <span class="p">]</span>
</span><span id="execute_phase_4-2638"><a href="#execute_phase_4-2638"><span class="linenos">2638</span></a>
</span><span id="execute_phase_4-2639"><a href="#execute_phase_4-2639"><span class="linenos">2639</span></a>        <span class="c1"># Determine status based on results</span>
</span><span id="execute_phase_4-2640"><a href="#execute_phase_4-2640"><span class="linenos">2640</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="execute_phase_4-2641"><a href="#execute_phase_4-2641"><span class="linenos">2641</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
</span><span id="execute_phase_4-2642"><a href="#execute_phase_4-2642"><span class="linenos">2642</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Failed to create any cursor rules.&quot;</span>
</span><span id="execute_phase_4-2643"><a href="#execute_phase_4-2643"><span class="linenos">2643</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">creation_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="execute_phase_4-2644"><a href="#execute_phase_4-2644"><span class="linenos">2644</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;partial&quot;</span>
</span><span id="execute_phase_4-2645"><a href="#execute_phase_4-2645"><span class="linenos">2645</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span><span class="si">}</span><span class="s2"> cursor rules with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">creation_errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> errors.&quot;</span>
</span><span id="execute_phase_4-2646"><a href="#execute_phase_4-2646"><span class="linenos">2646</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="execute_phase_4-2647"><a href="#execute_phase_4-2647"><span class="linenos">2647</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;complete&quot;</span>
</span><span id="execute_phase_4-2648"><a href="#execute_phase_4-2648"><span class="linenos">2648</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Phase 4 (Rule Creation) completed successfully. Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span><span class="si">}</span><span class="s2"> cursor rules.&quot;</span>
</span><span id="execute_phase_4-2649"><a href="#execute_phase_4-2649"><span class="linenos">2649</span></a>
</span><span id="execute_phase_4-2650"><a href="#execute_phase_4-2650"><span class="linenos">2650</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_4-2651"><a href="#execute_phase_4-2651"><span class="linenos">2651</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
</span><span id="execute_phase_4-2652"><a href="#execute_phase_4-2652"><span class="linenos">2652</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
</span><span id="execute_phase_4-2653"><a href="#execute_phase_4-2653"><span class="linenos">2653</span></a>            <span class="s2">&quot;checklist&quot;</span><span class="p">:</span> <span class="n">checklist</span><span class="p">,</span>
</span><span id="execute_phase_4-2654"><a href="#execute_phase_4-2654"><span class="linenos">2654</span></a>            <span class="s2">&quot;created_rules&quot;</span><span class="p">:</span> <span class="n">created_rules</span><span class="p">,</span>
</span><span id="execute_phase_4-2655"><a href="#execute_phase_4-2655"><span class="linenos">2655</span></a>            <span class="s2">&quot;creation_errors&quot;</span><span class="p">:</span> <span class="n">creation_errors</span><span class="p">,</span>
</span><span id="execute_phase_4-2656"><a href="#execute_phase_4-2656"><span class="linenos">2656</span></a>            <span class="s2">&quot;total_created&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">),</span>
</span><span id="execute_phase_4-2657"><a href="#execute_phase_4-2657"><span class="linenos">2657</span></a>            <span class="s2">&quot;total_errors&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">creation_errors</span><span class="p">),</span>
</span><span id="execute_phase_4-2658"><a href="#execute_phase_4-2658"><span class="linenos">2658</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_4-2659"><a href="#execute_phase_4-2659"><span class="linenos">2659</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="execute_phase_4-2660"><a href="#execute_phase_4-2660"><span class="linenos">2660</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;Proceed to Phase 5: Deployment and Testing to deploy and test your cursor rules.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2661"><a href="#execute_phase_4-2661"><span class="linenos">2661</span></a>        <span class="p">}</span>
</span><span id="execute_phase_4-2662"><a href="#execute_phase_4-2662"><span class="linenos">2662</span></a>
</span><span id="execute_phase_4-2663"><a href="#execute_phase_4-2663"><span class="linenos">2663</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_4-2664"><a href="#execute_phase_4-2664"><span class="linenos">2664</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_4-2665"><a href="#execute_phase_4-2665"><span class="linenos">2665</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2666"><a href="#execute_phase_4-2666"><span class="linenos">2666</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error during rule creation: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_4-2667"><a href="#execute_phase_4-2667"><span class="linenos">2667</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_4-2668"><a href="#execute_phase_4-2668"><span class="linenos">2668</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute Phase 4: Rule Creation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>workflow_state:</strong>  Current state of the workflow</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Updated workflow state and next steps</p>
</blockquote>
</div>


                </section>
                <section id="execute_phase_5">
                            <input id="execute_phase_5-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_phase_5</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="execute_phase_5-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#execute_phase_5"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="execute_phase_5-2671"><a href="#execute_phase_5-2671"><span class="linenos">2671</span></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_phase_5</span><span class="p">(</span><span class="n">workflow_state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="execute_phase_5-2672"><a href="#execute_phase_5-2672"><span class="linenos">2672</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute Phase 5: Deployment and Testing.</span>
</span><span id="execute_phase_5-2673"><a href="#execute_phase_5-2673"><span class="linenos">2673</span></a>
</span><span id="execute_phase_5-2674"><a href="#execute_phase_5-2674"><span class="linenos">2674</span></a><span class="sd">    Args:</span>
</span><span id="execute_phase_5-2675"><a href="#execute_phase_5-2675"><span class="linenos">2675</span></a><span class="sd">        workflow_state: Current state of the workflow</span>
</span><span id="execute_phase_5-2676"><a href="#execute_phase_5-2676"><span class="linenos">2676</span></a>
</span><span id="execute_phase_5-2677"><a href="#execute_phase_5-2677"><span class="linenos">2677</span></a><span class="sd">    Returns:</span>
</span><span id="execute_phase_5-2678"><a href="#execute_phase_5-2678"><span class="linenos">2678</span></a><span class="sd">        dict[str, Any]: Updated workflow state and next steps</span>
</span><span id="execute_phase_5-2679"><a href="#execute_phase_5-2679"><span class="linenos">2679</span></a>
</span><span id="execute_phase_5-2680"><a href="#execute_phase_5-2680"><span class="linenos">2680</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="execute_phase_5-2681"><a href="#execute_phase_5-2681"><span class="linenos">2681</span></a>    <span class="c1"># If Phase 5 is already complete, return the state</span>
</span><span id="execute_phase_5-2682"><a href="#execute_phase_5-2682"><span class="linenos">2682</span></a>    <span class="k">if</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_5_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_5-2683"><a href="#execute_phase_5-2683"><span class="linenos">2683</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2684"><a href="#execute_phase_5-2684"><span class="linenos">2684</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;already_complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2685"><a href="#execute_phase_5-2685"><span class="linenos">2685</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 5 (Deployment and Testing) is already complete. The workflow is finished.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2686"><a href="#execute_phase_5-2686"><span class="linenos">2686</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2687"><a href="#execute_phase_5-2687"><span class="linenos">2687</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="execute_phase_5-2688"><a href="#execute_phase_5-2688"><span class="linenos">2688</span></a>        <span class="p">}</span>
</span><span id="execute_phase_5-2689"><a href="#execute_phase_5-2689"><span class="linenos">2689</span></a>
</span><span id="execute_phase_5-2690"><a href="#execute_phase_5-2690"><span class="linenos">2690</span></a>    <span class="c1"># Check if Phase 4 is complete</span>
</span><span id="execute_phase_5-2691"><a href="#execute_phase_5-2691"><span class="linenos">2691</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phase_4_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="execute_phase_5-2692"><a href="#execute_phase_5-2692"><span class="linenos">2692</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2693"><a href="#execute_phase_5-2693"><span class="linenos">2693</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;prerequisite_not_met&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2694"><a href="#execute_phase_5-2694"><span class="linenos">2694</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 4 (Rule Creation) must be completed before proceeding to Phase 5.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2695"><a href="#execute_phase_5-2695"><span class="linenos">2695</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2696"><a href="#execute_phase_5-2696"><span class="linenos">2696</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="execute_phase_5-2697"><a href="#execute_phase_5-2697"><span class="linenos">2697</span></a>        <span class="p">}</span>
</span><span id="execute_phase_5-2698"><a href="#execute_phase_5-2698"><span class="linenos">2698</span></a>
</span><span id="execute_phase_5-2699"><a href="#execute_phase_5-2699"><span class="linenos">2699</span></a>    <span class="c1"># Extract rule information from previous phases</span>
</span><span id="execute_phase_5-2700"><a href="#execute_phase_5-2700"><span class="linenos">2700</span></a>    <span class="n">created_rules</span> <span class="o">=</span> <span class="n">workflow_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_rules&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="execute_phase_5-2701"><a href="#execute_phase_5-2701"><span class="linenos">2701</span></a>
</span><span id="execute_phase_5-2702"><a href="#execute_phase_5-2702"><span class="linenos">2702</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">created_rules</span><span class="p">:</span>
</span><span id="execute_phase_5-2703"><a href="#execute_phase_5-2703"><span class="linenos">2703</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2704"><a href="#execute_phase_5-2704"><span class="linenos">2704</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2705"><a href="#execute_phase_5-2705"><span class="linenos">2705</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;No rules have been created. Please complete Phase 4 properly.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2706"><a href="#execute_phase_5-2706"><span class="linenos">2706</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2707"><a href="#execute_phase_5-2707"><span class="linenos">2707</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="execute_phase_5-2708"><a href="#execute_phase_5-2708"><span class="linenos">2708</span></a>        <span class="p">}</span>
</span><span id="execute_phase_5-2709"><a href="#execute_phase_5-2709"><span class="linenos">2709</span></a>
</span><span id="execute_phase_5-2710"><a href="#execute_phase_5-2710"><span class="linenos">2710</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="execute_phase_5-2711"><a href="#execute_phase_5-2711"><span class="linenos">2711</span></a>        <span class="c1"># Step 1: Deploy rules using the update-cursor-rules task</span>
</span><span id="execute_phase_5-2712"><a href="#execute_phase_5-2712"><span class="linenos">2712</span></a>        <span class="n">deployment_result</span> <span class="o">=</span> <span class="n">run_update_cursor_rules</span><span class="p">()</span>
</span><span id="execute_phase_5-2713"><a href="#execute_phase_5-2713"><span class="linenos">2713</span></a>
</span><span id="execute_phase_5-2714"><a href="#execute_phase_5-2714"><span class="linenos">2714</span></a>        <span class="c1"># Check if deployment was successful</span>
</span><span id="execute_phase_5-2715"><a href="#execute_phase_5-2715"><span class="linenos">2715</span></a>        <span class="k">if</span> <span class="n">deployment_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
</span><span id="execute_phase_5-2716"><a href="#execute_phase_5-2716"><span class="linenos">2716</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2717"><a href="#execute_phase_5-2717"><span class="linenos">2717</span></a>                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2718"><a href="#execute_phase_5-2718"><span class="linenos">2718</span></a>                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error deploying cursor rules: </span><span class="si">{</span><span class="n">deployment_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2719"><a href="#execute_phase_5-2719"><span class="linenos">2719</span></a>                <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2720"><a href="#execute_phase_5-2720"><span class="linenos">2720</span></a>            <span class="p">}</span>
</span><span id="execute_phase_5-2721"><a href="#execute_phase_5-2721"><span class="linenos">2721</span></a>
</span><span id="execute_phase_5-2722"><a href="#execute_phase_5-2722"><span class="linenos">2722</span></a>        <span class="c1"># Track deployed rules</span>
</span><span id="execute_phase_5-2723"><a href="#execute_phase_5-2723"><span class="linenos">2723</span></a>        <span class="n">deployed_rules</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="execute_phase_5-2724"><a href="#execute_phase_5-2724"><span class="linenos">2724</span></a>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">created_rules</span><span class="p">:</span>
</span><span id="execute_phase_5-2725"><a href="#execute_phase_5-2725"><span class="linenos">2725</span></a>            <span class="n">deployed_rules</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;rule_name&quot;</span><span class="p">:</span> <span class="n">rule</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rule_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;deployed&quot;</span><span class="p">})</span>
</span><span id="execute_phase_5-2726"><a href="#execute_phase_5-2726"><span class="linenos">2726</span></a>
</span><span id="execute_phase_5-2727"><a href="#execute_phase_5-2727"><span class="linenos">2727</span></a>        <span class="c1"># Update the workflow state</span>
</span><span id="execute_phase_5-2728"><a href="#execute_phase_5-2728"><span class="linenos">2728</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;deployed_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deployed_rules</span>
</span><span id="execute_phase_5-2729"><a href="#execute_phase_5-2729"><span class="linenos">2729</span></a>        <span class="n">workflow_state</span><span class="p">[</span><span class="s2">&quot;phase_5_complete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="execute_phase_5-2730"><a href="#execute_phase_5-2730"><span class="linenos">2730</span></a>
</span><span id="execute_phase_5-2731"><a href="#execute_phase_5-2731"><span class="linenos">2731</span></a>        <span class="c1"># Create a checklist for phase 5 completion</span>
</span><span id="execute_phase_5-2732"><a href="#execute_phase_5-2732"><span class="linenos">2732</span></a>        <span class="n">checklist</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="execute_phase_5-2733"><a href="#execute_phase_5-2733"><span class="linenos">2733</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Saved rules to cursor rules directory&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">created_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span id="execute_phase_5-2734"><a href="#execute_phase_5-2734"><span class="linenos">2734</span></a>            <span class="p">{</span>
</span><span id="execute_phase_5-2735"><a href="#execute_phase_5-2735"><span class="linenos">2735</span></a>                <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Deployed rules using update-cursor-rules task&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2736"><a href="#execute_phase_5-2736"><span class="linenos">2736</span></a>                <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="n">deployment_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2737"><a href="#execute_phase_5-2737"><span class="linenos">2737</span></a>            <span class="p">},</span>
</span><span id="execute_phase_5-2738"><a href="#execute_phase_5-2738"><span class="linenos">2738</span></a>            <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;Rules ready for testing&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span id="execute_phase_5-2739"><a href="#execute_phase_5-2739"><span class="linenos">2739</span></a>        <span class="p">]</span>
</span><span id="execute_phase_5-2740"><a href="#execute_phase_5-2740"><span class="linenos">2740</span></a>
</span><span id="execute_phase_5-2741"><a href="#execute_phase_5-2741"><span class="linenos">2741</span></a>        <span class="c1"># Generate testing instructions</span>
</span><span id="execute_phase_5-2742"><a href="#execute_phase_5-2742"><span class="linenos">2742</span></a>        <span class="n">testing_instructions</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="execute_phase_5-2743"><a href="#execute_phase_5-2743"><span class="linenos">2743</span></a><span class="s2">## Testing Your Cursor Rules</span>
</span><span id="execute_phase_5-2744"><a href="#execute_phase_5-2744"><span class="linenos">2744</span></a>
</span><span id="execute_phase_5-2745"><a href="#execute_phase_5-2745"><span class="linenos">2745</span></a><span class="s2">To test your newly deployed cursor rules:</span>
</span><span id="execute_phase_5-2746"><a href="#execute_phase_5-2746"><span class="linenos">2746</span></a>
</span><span id="execute_phase_5-2747"><a href="#execute_phase_5-2747"><span class="linenos">2747</span></a><span class="s2">1. Open a file that should trigger one of your rules</span>
</span><span id="execute_phase_5-2748"><a href="#execute_phase_5-2748"><span class="linenos">2748</span></a><span class="s2">2. Check if the rule is applied correctly by:</span>
</span><span id="execute_phase_5-2749"><a href="#execute_phase_5-2749"><span class="linenos">2749</span></a><span class="s2">   - Looking for rule suggestions in the Cursor UI</span>
</span><span id="execute_phase_5-2750"><a href="#execute_phase_5-2750"><span class="linenos">2750</span></a><span class="s2">   - Verifying that the rule&#39;s action message appears</span>
</span><span id="execute_phase_5-2751"><a href="#execute_phase_5-2751"><span class="linenos">2751</span></a><span class="s2">   - Testing any interactive features of the rule</span>
</span><span id="execute_phase_5-2752"><a href="#execute_phase_5-2752"><span class="linenos">2752</span></a>
</span><span id="execute_phase_5-2753"><a href="#execute_phase_5-2753"><span class="linenos">2753</span></a><span class="s2">3. For each rule, verify:</span>
</span><span id="execute_phase_5-2754"><a href="#execute_phase_5-2754"><span class="linenos">2754</span></a><span class="s2">   - The rule triggers on the correct file types</span>
</span><span id="execute_phase_5-2755"><a href="#execute_phase_5-2755"><span class="linenos">2755</span></a><span class="s2">   - The content matching works as expected</span>
</span><span id="execute_phase_5-2756"><a href="#execute_phase_5-2756"><span class="linenos">2756</span></a><span class="s2">   - The guidance provided is helpful and accurate</span>
</span><span id="execute_phase_5-2757"><a href="#execute_phase_5-2757"><span class="linenos">2757</span></a>
</span><span id="execute_phase_5-2758"><a href="#execute_phase_5-2758"><span class="linenos">2758</span></a><span class="s2">4. If you need to make adjustments:</span>
</span><span id="execute_phase_5-2759"><a href="#execute_phase_5-2759"><span class="linenos">2759</span></a><span class="s2">   - Edit the rule files in the cursor rules drafts directory</span>
</span><span id="execute_phase_5-2760"><a href="#execute_phase_5-2760"><span class="linenos">2760</span></a><span class="s2">   - Run `make update-cursor-rules` to deploy the changes</span>
</span><span id="execute_phase_5-2761"><a href="#execute_phase_5-2761"><span class="linenos">2761</span></a><span class="s2">   - Test again to verify the changes</span>
</span><span id="execute_phase_5-2762"><a href="#execute_phase_5-2762"><span class="linenos">2762</span></a>
</span><span id="execute_phase_5-2763"><a href="#execute_phase_5-2763"><span class="linenos">2763</span></a><span class="s2">5. Common issues to check:</span>
</span><span id="execute_phase_5-2764"><a href="#execute_phase_5-2764"><span class="linenos">2764</span></a><span class="s2">   - File pattern matching not working as expected</span>
</span><span id="execute_phase_5-2765"><a href="#execute_phase_5-2765"><span class="linenos">2765</span></a><span class="s2">   - Content pattern too broad or too narrow</span>
</span><span id="execute_phase_5-2766"><a href="#execute_phase_5-2766"><span class="linenos">2766</span></a><span class="s2">   - Action message unclear or not helpful</span>
</span><span id="execute_phase_5-2767"><a href="#execute_phase_5-2767"><span class="linenos">2767</span></a><span class="s2">   - Examples not representative of real use cases</span>
</span><span id="execute_phase_5-2768"><a href="#execute_phase_5-2768"><span class="linenos">2768</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="execute_phase_5-2769"><a href="#execute_phase_5-2769"><span class="linenos">2769</span></a>
</span><span id="execute_phase_5-2770"><a href="#execute_phase_5-2770"><span class="linenos">2770</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2771"><a href="#execute_phase_5-2771"><span class="linenos">2771</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;complete&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2772"><a href="#execute_phase_5-2772"><span class="linenos">2772</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Phase 5 (Deployment and Testing) completed successfully. All cursor rules have been deployed.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2773"><a href="#execute_phase_5-2773"><span class="linenos">2773</span></a>            <span class="s2">&quot;checklist&quot;</span><span class="p">:</span> <span class="n">checklist</span><span class="p">,</span>
</span><span id="execute_phase_5-2774"><a href="#execute_phase_5-2774"><span class="linenos">2774</span></a>            <span class="s2">&quot;deployed_rules&quot;</span><span class="p">:</span> <span class="n">deployed_rules</span><span class="p">,</span>
</span><span id="execute_phase_5-2775"><a href="#execute_phase_5-2775"><span class="linenos">2775</span></a>            <span class="s2">&quot;total_deployed&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">deployed_rules</span><span class="p">),</span>
</span><span id="execute_phase_5-2776"><a href="#execute_phase_5-2776"><span class="linenos">2776</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2777"><a href="#execute_phase_5-2777"><span class="linenos">2777</span></a>            <span class="s2">&quot;next_phase&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="execute_phase_5-2778"><a href="#execute_phase_5-2778"><span class="linenos">2778</span></a>            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="s2">&quot;The workflow is complete. Your cursor rules have been deployed and are ready for testing.&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2779"><a href="#execute_phase_5-2779"><span class="linenos">2779</span></a>            <span class="s2">&quot;testing_instructions&quot;</span><span class="p">:</span> <span class="n">testing_instructions</span><span class="p">,</span>
</span><span id="execute_phase_5-2780"><a href="#execute_phase_5-2780"><span class="linenos">2780</span></a>        <span class="p">}</span>
</span><span id="execute_phase_5-2781"><a href="#execute_phase_5-2781"><span class="linenos">2781</span></a>
</span><span id="execute_phase_5-2782"><a href="#execute_phase_5-2782"><span class="linenos">2782</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="execute_phase_5-2783"><a href="#execute_phase_5-2783"><span class="linenos">2783</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="execute_phase_5-2784"><a href="#execute_phase_5-2784"><span class="linenos">2784</span></a>            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2785"><a href="#execute_phase_5-2785"><span class="linenos">2785</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error during deployment and testing: </span><span class="si">{</span><span class="n">e</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="execute_phase_5-2786"><a href="#execute_phase_5-2786"><span class="linenos">2786</span></a>            <span class="s2">&quot;workflow_state&quot;</span><span class="p">:</span> <span class="n">workflow_state</span><span class="p">,</span>
</span><span id="execute_phase_5-2787"><a href="#execute_phase_5-2787"><span class="linenos">2787</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Execute Phase 5: Deployment and Testing.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>workflow_state:</strong>  Current state of the workflow</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>dict[str, Any]: Updated workflow state and next steps</p>
</blockquote>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>